{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2025-06-07T03:02:34.327000Z", "invocation_id": "5732c4c4-d857-4f9e-a94f-562663b7e86b", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.014504Z", "completed_at": "2025-06-07T03:02:34.030130Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.030130Z", "completed_at": "2025-06-07T03:02:34.030130Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625715255737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__IntegrationPoint", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n        select * from \"KNSDataLake\".\"deposco\".\"integration_point\"\n\n),\n\ncleaned as (\n\n    select \n        cast(PROPERTIES as varchar(max)) as Properties,\n        cast(TRADING_PARTNER_ID as bigint) as TradingPartnerId,\n        cast(TYPE as varchar(200)) as Type,\n        cast(IS_ENABLED as bit) as IsEnabled\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__IntegrationPoint\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.030130Z", "completed_at": "2025-06-07T03:02:34.030130Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.030130Z", "completed_at": "2025-06-07T03:02:34.030130Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__InvoiceHeader", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"deposco\".\"invoice_header\"\n\n),\n\ncleaned as (\n\n    select \n        cast([INVOICE_HEADER_ID] as bigint) as InvoiceHeaderId,\n        cast([ORDER_HEADER_ID] as bigint) as OrderHeaderId,\n        cast(NUMBER as varchar(75)) as Number\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__InvoiceHeader\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.045754Z", "completed_at": "2025-06-07T03:02:34.045754Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.045754Z", "completed_at": "2025-06-07T03:02:34.045754Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624046325683594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__Item", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"deposco\".\"item\"\n\n),\n\ncleaned as (\n\n    select \n        cast([NUMBER] as nvarchar(200)) as Number,\n        cast([ITEM_ID] as bigint) as ItemId,\n        cast([INTANGIBLE_ITEM_FLAG] as bit) as IsIntangible,\n        cast([CLASS_TYPE] as varchar(30)) as IsSupplies,\n        cast([COMPANY_ID] as int) as CompanyId\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Item\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.045754Z", "completed_at": "2025-06-07T03:02:34.045754Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.045754Z", "completed_at": "2025-06-07T03:02:34.045754Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__OrderHeader", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n    select * from \"KNSDataLake\".\"deposco\".\"order_header\"\n\n),\n\ncleaned as (\n\n    select\n        cast(CUSTOMER_ORDER_NUMBER as varchar(50)) as CustomerOrderNumber,\n        cast(CONSIGNEE_PARTNER_ID as bigint) as TradingPartnerId,\n        cast(KNS_MT_PLACED_DATE as datetime) as PlacedAt,\n        cast(KNS_MT_PLANNED_RELEASE_DATE as\tdatetime) as ContractualShipAt,\n        cast(KNS_MT_PLANNED_SHIP_DATE as datetime) as PlannedShipAt,\n        cast(SHIPPING_STATUS as int) as ShippingStatus,\n        cast(ORDER_HEADER_ID as bigint) as OrderHeaderId,\n        cast(KNS_MT_ACTUAL_SHIP_DATE as\tdatetime) as ShippedAt,\n        cast(ORDER_DISCOUNT_SUBTOTAL as float) as DiscountAmount,\n        cast(CURRENT_STATUS as varchar(50)) as CurrentStatus\n    from source\n    where TYPE = 'Sales Order'\n    and COMPANY_ID = 73\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__OrderHeader\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.061381Z", "completed_at": "2025-06-07T03:02:34.061381Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.061381Z", "completed_at": "2025-06-07T03:02:34.061381Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__OrderLine", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n    select * from \"KNSDataLake\".\"deposco\".\"order_line\"\n\n),\n\ncleaned as (\n\n    select\n        cast(ORDER_LINE_ID as bigint) as OrderLineId,\n        cast(PACK_ID as bigint) as PackId,\n        cast(ORDER_HEADER_ID as bigint) as OrderHeaderId,\n        cast(ITEM_ID as bigint) as ItemId,\n        cast(ORDER_PACK_QUANTITY as float) as OrderPackQuantity,\n        cast(CANCELED_PACK_QUANTITY as float) as CanceledPackQuantity,\n        cast(ORDER_LINE_STATUS as varchar(50)) as OrderLineStatus,\n        -- cast(CO_LINE_ID as bigint) as CoLineId,\n        -- cast(SHIPPED_PACK_QUANTITY as float) as ShippedPackQuantity,\n        cast(UNIT_COST as float) as UnitCost\n        -- cast(UPDATED_DATE as datetime) as UpdatedDate\n    from source\n    where CREATED_DATE < dateadd(minute, -30, getdate())\n    and ORDER_PACK_QUANTITY >= 0\n\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__OrderLine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.061381Z", "completed_at": "2025-06-07T03:02:34.077007Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.077007Z", "completed_at": "2025-06-07T03:02:34.077007Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625953674316406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__Pack", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n        select * from \"KNSDataLake\".\"deposco\".\"pack\"\n\n),\n\ncleaned as (\n\n    select \n        cast(PACK_ID as bigint) as PackId,\n        cast(QUANTITY as int) as Quantity\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Pack\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.077007Z", "completed_at": "2025-06-07T03:02:34.077007Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.077007Z", "completed_at": "2025-06-07T03:02:34.077007Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__Shipment", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n        select * from \"KNSDataLake\".\"deposco\".\"shipment\"\n\n),\n\ncleaned as (\n\n    select \n        cast(SHIPMENT_ID as bigint) as ShipmentId,\n        cast(SHIP_VIA as varchar(50)) as ShippingVia,\n        cast(STATUS as varchar(50)) as Status,\n        cast(FREIGHT_TERMS_TYPE as varchar(50)) as FreightTermsType,\n        cast(SHIPPING_COST as float) as ShippingCost,\n        cast(FREIGHT_BILL_TO_ACCOUNT as varchar(50)) as FreightBillToAccount,\n        cast(TRACKING_NUMBER as varchar(100)) as TrackingNumber\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Shipment\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.077007Z", "completed_at": "2025-06-07T03:02:34.092630Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.092630Z", "completed_at": "2025-06-07T03:02:34.092630Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015623331069946289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__ShipmentOrderHeader", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n        select * from \"KNSDataLake\".\"deposco\".\"shipment_order_header\"\n\n),\n\ncleaned as (\n\n    select \n        cast(ORDER_HEADER_ID as bigint) as OrderHeaderId,\n        cast(SHIPMENT_ID as bigint) as ShipmentId\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__ShipmentOrderHeader\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.092630Z", "completed_at": "2025-06-07T03:02:34.092630Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.092630Z", "completed_at": "2025-06-07T03:02:34.092630Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__TradingPartner", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"deposco\".\"trading_partner\"\n\n),\n\ncolumns as (\n\n    select \n        cast([TRADING_PARTNER_ID] as bigint) as TradingPartnerId,\n        cast([NAME] as nvarchar(50)) as Name,\n        cast([BILL_TO_COUNTRY] as varchar(100)) as FulfillmentChannelType,\n        cast([BILL_TO_STATE_PROVINCE] as varchar(100)) as FinancialChannelType,\n        cast([DROPSHIP_FEE] as float) as HandlingFee,\n        cast([SIC] as varchar(20)) as HandlingFeeType,\n        cast([UPS_ACCOUNT_NUMBER] as varchar(100)) as UpsAccountNumber,\n        cast([FEDEX_ACCOUNT_NUMBER] as varchar(10)) as FedexAccountNumber,\n        cast([CONTACT_EMAIL] as varchar(50)) as IsReturnsPartner,\n        cast([CODE] as varchar(40)) as Code\n    from source\n\n),\n\ncleaned as (\n    select\n        TradingPartnerId,\n        Name,\n        FulfillmentChannelType,\n        FinancialChannelType,\n        HandlingFee,\n        case\n            when HandlingFeeType = 'order' then 'Order'\n            when HandlingFeeType is null and HandlingFee != 0 then 'Unit'\n            else null\n        end as HandlingFeeType,\n        UpsAccountNumber,\n        FedexAccountNumber,\n        Code,\n        IsReturnsPartner\n    from columns\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__TradingPartner\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.092630Z", "completed_at": "2025-06-07T03:02:34.108248Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.108248Z", "completed_at": "2025-06-07T03:02:34.108248Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01561737060546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_mdm_products__Catalog", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSUnifiedMDM\".\"Products\".\"Catalog\"\n\n),\n\ncleaned as (\n\n    select \n        cast(CatalogId as int) as CatalogId,\n        cast(Name as nvarchar(32)) as Name,\n        cast(BrandId as int) as BrandId\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_mdm_products__Catalog\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.108248Z", "completed_at": "2025-06-07T03:02:34.108248Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.108248Z", "completed_at": "2025-06-07T03:02:34.108248Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_netsuite__Entity", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"entity\"\n\n),\n\ncleaned as (\n\n    select \n        cast(id as bigint) as Id,\n        cast(entityid as nvarchar(128)) as EntityId\n    from source \n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_netsuite__Entity\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.123880Z", "completed_at": "2025-06-07T03:02:34.123880Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.123880Z", "completed_at": "2025-06-07T03:02:34.123880Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_netsuite__Item", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"item\"\n\n),\n\ncleaned as (\n\n    select \n        cast(id as bigint) as Id,\n        cast(externalid as nvarchar(255)) as ExternalId\n    from source \n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_netsuite__Item\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.123880Z", "completed_at": "2025-06-07T03:02:34.139508Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.139508Z", "completed_at": "2025-06-07T03:02:34.139508Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01562786102294922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_netsuite__Transaction", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"transaction\"\n\n),\n\ncleaned as (\n\n    select\n        cast(tranid as nvarchar(90)) as TranId,\n        cast(custbody_kns_po as nvarchar(4000)) as CustBodyKnsPo,\n        cast(otherrefnum as nvarchar(90)) as OtherRefNum,\n        cast(entity as bigint) as Entity,\n        cast(id as bigint) as Id,\n        cast(trandate as date) as TranDate\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_netsuite__Transaction\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.139508Z", "completed_at": "2025-06-07T03:02:34.139508Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.139508Z", "completed_at": "2025-06-07T03:02:34.139508Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_netsuite__TransactionLine", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"transactionLine\"\n\n),\n\ncleaned as (\n\n    select\n        cast(uniquekey as bigint) as UniqueKey,\n        cast([transaction] as bigint) as TransactionId,\n        cast(rate as float) as Rate,\n        cast(expenseaccount as bigint) as ExpenseAccount,\n        cast(debitforeignamount as float) as DebitForeignAmount,\n        cast(creditforeignamount as float) as CreditForeignAmount,\n        cast(memo as nvarchar(4000)) as Memo,\n        cast(item as bigint) as Item\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_netsuite__TransactionLine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.139508Z", "completed_at": "2025-06-07T03:02:34.155132Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.155132Z", "completed_at": "2025-06-07T03:02:34.155132Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624046325683594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_salsify__Product", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"salsify\".\"Product\"\n\n),\n\ncleaned as (\n\n    select \n        cast([Main SKU] as nvarchar(128)) as MainSku,\n        cast([Sub Category] as nvarchar(128)) as SubCategory,\n        cast([Merchandise Subclass] as nvarchar(128)) as MerchandiseSubclass,\n        cast([Color Class] as nvarchar(128)) as ColorClass,\n        cast(Color as nvarchar(128)) as Color,\n        cast(Brand as nvarchar(128)) as Brand,\n        cast(Gender as nvarchar(128)) as Gender,\n        cast(Size as nvarchar(128)) as Size,\n        cast(Seasonality as nvarchar(128)) as Seasonality,\n        cast([Size Run] as nvarchar(128)) as SizeRun,\n        cast(Vendor as nvarchar(128)) as Vendor,\n        cast([Vendor SKU] as nvarchar(128)) as VendorSku,\n        cast(case lower([Sell Out Target Date Month])\n            when 'january' then 1\n            when 'february' then 2\n            when 'march' then 3\n            when 'april' then 4\n            when 'may' then 5\n            when 'june' then 6\n            when 'july' then 7\n            when 'august' then 8\n            when 'september' then 9\n            when 'october' then 10\n            when 'november' then 11\n            when 'december' then 12\n            else null\n        end as int) as SellOutTargetDateMonth,\n        nullif(cast([Sell Out Target Date Year] as int), 0) as SellOutTargetDateYear,\n        cast([Planned Arrival Date Month] as nvarchar(128)) as PlannedArrivalDateMonth,\n        nullif(cast([First Sales Date] as date), '1900-01-01') as FirstSalesDateAt,\n        cast(Status as nvarchar(128)) as Status,\n        cast([Closure Type] as nvarchar(128)) as ClosureType,\n        cast([Heel Height] as nvarchar(128)) as HeelHeight,\n        cast([Style Type] as nvarchar(128)) as StyleType,\n        cast(Style as nvarchar(128)) as Style,\n        cast([Parent SKU] as nvarchar(128)) as ParentSku,\n        cast([Calf Width] as nvarchar(128)) as CalfWidth,\n        cast([Shoe Width] as nvarchar(128)) as ShoeWidth,\n        cast([Anaplan Active] as bit) as AnaplanActive,\n        cast([Case Quantity] as int) as CaseQuantity,\n        cast(MSRP as decimal(19, 4)) as Msrp,\n        cast([Season Budget] as nvarchar(16)) as SeasonBudget,\n        cast([Selling Status] as nvarchar(32)) as SellingStatus,\n        cast([Direct Sourcing Model] as nvarchar(64)) as DirectSourcingModel,\n        cast([DTC Website Color] as nvarchar(64)) as DtcWebsiteColor\n    from source\n    where nullif(trim([Parent SKU]), '') is not null\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_salsify__Product\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.155132Z", "completed_at": "2025-06-07T03:02:34.170757Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.170757Z", "completed_at": "2025-06-07T03:02:34.170757Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624523162841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.orders__TradingPartner", "compiled": true, "compiled_code": "\n\nselect \n  Name,\n  FulfillmentChannelType,\n  FinancialChannelType,\n  Code,\n  case\n    when IsReturnsPartner = 'TRUE' then 1\n    else 0\n  end as IsReturnsPartner\nfrom \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__TradingPartner\"", "relation_name": "\"KNSUnifiedMDM\".\"Orders\".\"TradingPartner\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.170757Z", "completed_at": "2025-06-07T03:02:34.170757Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.170757Z", "completed_at": "2025-06-07T03:02:34.170757Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.int_products__Style", "compiled": true, "compiled_code": "with products as (\n\n    select distinct\n        Style as Name,\n        Vendor,\n        Seasonality as Season,\n        CaseQuantity,\n        Gender,\n        Brand,\n        SeasonBudget,\n        case\n            when SubCategory is null or SubCategory in ('', '*No Category*', 'SHIPPING PROTECTION')\n            then 'OTHER'\n            else SubCategory\n        end as Class\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_salsify__Product\"\n\n),\n\nranked as (\n\n    select \n        *,\n        row_number() over (\n            partition by Name \n            order by (select null)\n        ) as rank\n    from products\n\n)\n\nselect\n    Name,\n    Class,\n    Vendor,\n    Season,\n    CaseQuantity,\n    SeasonBudget,\n    Gender,\n    Brand\nfrom ranked\nwhere rank = 1\n    and Name is not null\n    and Name != ''", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"int_products__Style\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.186398Z", "completed_at": "2025-06-07T03:02:34.186398Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.186398Z", "completed_at": "2025-06-07T03:02:34.186398Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01564168930053711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.orders__SalesOrder", "compiled": true, "compiled_code": "\n\n\n\nwith order_header as (\n    select\n        CustomerOrderNumber,\n        TradingPartnerId,\n        PlacedAt,\n        ContractualShipAt,\n        PlannedShipAt,\n        ShippingStatus,\n        OrderHeaderId,\n        ShippedAt,\n        DiscountAmount\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__OrderHeader\"\n    where CurrentStatus not in ('Void', 'Voided')\n),\n\nkns_accounts as (\n    select\n        cast(FedexAccountNumber as nvarchar(32)) as FedexAccountNumber,\n        cast(UpsAccountNumber as nvarchar(32)) as UpsAccountNumber\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__TradingPartner\"\n    where Code = 'KNS'\n),\n\nfedex_json as (\n    select\n        ip.TradingPartnerId,\n        j.value as FedexAccountFromJson\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__IntegrationPoint\" ip\n    cross apply openjson(ip.Properties, '$.attributes') j\n    where ip.Type = 'fedex'\n      and ip.IsEnabled = 1\n      and j.[key] = 'accountNumber'\n),\n\nfinal as (\n\n    select\n        oh.CustomerOrderNumber as PONumber,\n        tp.TradingPartnerId,\n        oh.PlacedAt,\n        oh.ContractualShipAt,\n        oh.PlannedShipAt,\n        case\n            when oh.ShippingStatus = 20 then 'Closed'\n            else 'Open'\n        end as Status,\n        cast(oh.OrderHeaderId as nvarchar(50)) as SourceId,\n        'Deposco' as SourceSystem,\n        min(iif(s.Status='Shipped', s.ShippingVia, null)) as ShippingVia,\n        min(case\n            when s.ShippingVia like '%easypost%' then 'USPS'\n            when s.ShippingVia like '%stamps%' then 'USPS'\n            when s.ShippingVia like '%fedex%' then 'FedEx'\n            when s.ShippingVia like '%UPS%' or s.ShippingVia = 'USG' then 'UPS'\n            when s.ShippingVia like '%landmark%' then 'Landmark'\n        end) as ShippingCarrier,\n        oh.ShippedAt,\n        sum(case\n            when s.FreightTermsType = 'Third Party' \n                then iif(s.FreightBillToAccount = ka.FedexAccountNumber or s.FreightBillToAccount = ka.UpsAccountNumber, s.ShippingCost, 0)\n            when s.ShippingVia like '%ups%' or s.ShippingVia like '%usg%' \n                then iif(right(left(iif(s.TrackingNumber like '1Z%', s.TrackingNumber, null), 8), 6) = ka.UpsAccountNumber, s.ShippingCost, 0)\n            when s.ShippingVia like '%fedex%' \n                then iif(coalesce(fj.FedexAccountFromJson, dtp.FedexAccountNumber, ka.FedexAccountNumber) = ka.FedexAccountNumber, s.ShippingCost, 0)\n            else 0\n        end) as FreightOutCOGSAmount,\n        oh.DiscountAmount\n    from order_header oh\n    cross join kns_accounts ka\n    left join \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__ShipmentOrderHeader\" soh \n    on oh.OrderHeaderId = soh.OrderHeaderId\n    left join \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Shipment\" s\n    on soh.ShipmentId = s.ShipmentId\n    left join \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__TradingPartner\" dtp \n    on oh.TradingPartnerId = dtp.TradingPartnerId\n    left join \"KNSUnifiedMDM\".\"Orders\".\"TradingPartner\" tp\n    on dtp.Name = tp.Name\n    left join fedex_json fj\n    on fj.TradingPartnerId = dtp.TradingPartnerId\n    group by \n        oh.CustomerOrderNumber,\n        tp.TradingPartnerId,\n        oh.PlacedAt,\n        oh.ContractualShipAt,\n        oh.PlannedShipAt,\n        oh.ShippingStatus,\n        oh.OrderHeaderId,\n        oh.ShippedAt,\n        oh.DiscountAmount\n    \n)\n\nselect * from final", "relation_name": "\"KNSUnifiedMDM\".\"Orders\".\"SalesOrder\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.186398Z", "completed_at": "2025-06-07T03:02:34.202004Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.202004Z", "completed_at": "2025-06-07T03:02:34.202004Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015606164932250977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.orders__TradingPartnerHandlingFee", "compiled": true, "compiled_code": "\n\n\n\n\nwith ids as (\n    select\n        Name,\n        TradingPartnerId\n    from \"KNSUnifiedMDM\".\"Orders\".\"TradingPartner\"\n),\n\ninfo as (\n    select\n        Name,\n        HandlingFee,\n        HandlingFeeType\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__TradingPartner\"\n),\n\njoined as (\n    select\n        ids.TradingPartnerId,\n        info.HandlingFeeType,\n        info.HandlingFee\n    from ids \n    left join info\n    on ids.Name = info.Name\n),\n\nlatest as (\n    select * from \"KNSUnifiedMDM\".\"Orders\".\"TradingPartnerHandlingFee\"\n    where EndDate is null\n),\n\nnew as (\n    select\n        j.TradingPartnerId,\n        cast(getdate() as date) as StartDate,\n        null as EndDate,\n        j.HandlingFeeType,\n        j.HandlingFee\n    from joined j\n    left join latest l\n    on j.TradingPartnerId = l.TradingPartnerId\n    where l.TradingPartnerId is null \n        or j.HandlingFee != l.HandlingFee\n        or l.HandlingFeeType != j.HandlingFeeType\n),\n\nexpired as (\n    select\n        l.TradingPartnerId,\n        l.StartDate,\n        cast(getdate() as date) as EndDate,\n        l.HandlingFeeType,\n        l.HandlingFee\n    from latest l\n    left join joined j\n    on l.TradingPartnerId = j.TradingPartnerId\n    where j.TradingPartnerId is null \n        or j.HandlingFee != l.HandlingFee\n        or j.HandlingFeeType != l.HandlingFeeType\n),\n\nfinal as (\n    select * from new\n    union all\n    select * from expired\n)\n\nselect * from final", "relation_name": "\"KNSUnifiedMDM\".\"Orders\".\"TradingPartnerHandlingFee\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.202004Z", "completed_at": "2025-06-07T03:02:34.233264Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.233264Z", "completed_at": "2025-06-07T03:02:34.233264Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03125929832458496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.MDM.not_null_orders__TradingPartner_FulfillmentChannelType.88ae6a8cc1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect FulfillmentChannelType\nfrom \"KNSUnifiedMDM\".\"Orders\".\"TradingPartner\"\nwhere FulfillmentChannelType is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.233264Z", "completed_at": "2025-06-07T03:02:34.248885Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.248885Z", "completed_at": "2025-06-07T03:02:34.248885Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015621185302734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.products__Style", "compiled": true, "compiled_code": "\n\nwith styles as ( \n    select * from \"KNSUnifiedMDM\".\"prod\".\"int_products__Style\"\n),\n\ncatalog as (\n    select * from \"KNSUnifiedMDM\".\"prod\".\"stg_mdm_products__Catalog\"\n),\n\nfinal as (\n    select \n        null as Code,\n        c.CatalogId,\\\n        s.Class,\n        s.Vendor,\n        s.Season,\n        s.CaseQuantity,\n        s.Name,\n        case \n            when s.Gender = '' then null \n            else s.Gender \n        end as Gender,\n        s.SeasonBudget\n    from styles s\n    left join catalog c\n    on s.Brand = c.Name\n    where s.Name is not null\n        and s.Name != ''\n)\n\nselect * from final", "relation_name": "\"KNSUnifiedMDM\".\"Products\".\"Style\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.248885Z", "completed_at": "2025-06-07T03:02:34.264489Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.264489Z", "completed_at": "2025-06-07T03:02:34.264489Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015604019165039062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.products__Variant", "compiled": true, "compiled_code": "\n\n\n\nwith styles as ( \n    select * from \"KNSUnifiedMDM\".\"Products\".\"Style\"\n),\n\nsupplies as (\n    select \n        Number, \n        null as Code, \n        2590 as StyleId, \n        null as SizeId, \n        null as Status, \n        null as SellingStatus,\n        null as ShoeWidth, \n        null as CalfWidth, \n        null as Parent, \n        null as ClosureType, \n        null as HeelType, \n        null as StyleType,\n        null as SizeRun, \n        null as ColorName, \n        null as ColorClass, \n        null as Subclass, \n        null as VendorSku, \n        null as IsAnaplanActive,\n        null as SellOutTargetAt, \n        null as PlannedArrivalAt, \n        null as FirstSalesDateAt, \n        null as MSRP, \n        1 as IsSupplies, \n        0 as IsIntangible, \n        null as DirectSourcingModel,\n        null as DtcWebsiteColor\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Item\" i\n    where IsSupplies like '%suppl%'\n        and CompanyId = 73\n),\n\nvariants as (\n    select \n        MainSku as Number,\n        null as Code,\n        Status,\n        SellingStatus,\n        ShoeWidth,\n        CalfWidth,\n        ParentSku as Parent,\n        ClosureType,\n        HeelHeight as HeelType,\n        StyleType,\n        SizeRun,\n        Color as ColorName,\n        ColorClass,\n        MerchandiseSubclass as Subclass,\n        VendorSku,\n        AnaplanActive as IsAnaplanActive,\n        case \n            when SellOutTargetDateYear is not null and SellOutTargetDateMonth is not null\n            then datefromparts(SellOutTargetDateYear, SellOutTargetDateMonth, 1)\n            else null\n        end as SellOutTargetAt,\n        PlannedArrivalDateMonth as PlannedArrivalAt,\n        FirstSalesDateAt,\n        MSRP,\n        0 as IsSupplies,\n        i.IsIntangible as IsIntangible,\n        DirectSourcingModel,\n        Style,\n        DtcWebsiteColor as DtcWebsiteColor,\n        row_number() over (partition by MainSku order by (select null)) as rn\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_salsify__Product\" p\n    left join \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Item\" i\n    on p.MainSku = i.Number\n    where MainSku is not null\n        and MainSku != ''\n),\n\nvariant_deduped as (\n    select \n        Number,\n        null as Code,\n        s.StyleId,\n        null as SizeId,\n        v.Status,\n        v.SellingStatus,\n        v.ShoeWidth,\n        v.CalfWidth,\n        v.Parent,\n        v.ClosureType,\n        v.HeelType,\n        v.StyleType,\n        v.SizeRun,\n        v.ColorName,\n        v.ColorClass,\n        v.Subclass,\n        v.VendorSku,\n        v.IsAnaplanActive,\n        v.SellOutTargetAt,\n        v.PlannedArrivalAt,\n        v.FirstSalesDateAt,\n        v.MSRP,\n        v.IsSupplies,\n        v.IsIntangible,\n        v.DirectSourcingModel,\n        v.DtcWebsiteColor\n    from variants v\n    left join styles s\n    on v.Style = s.Name\n    where rn = 1\n),\n\nunioned as (\n    select * from supplies\n    union all\n    select * from variant_deduped\n),\n\nfinal as (\n    select \n        Number,\n        Code,\n        StyleId,\n        SizeId,\n        Status,\n        SellingStatus,\n        ShoeWidth,\n        CalfWidth,\n        Parent,\n        ClosureType,\n        HeelType,\n        StyleType,\n        SizeRun,\n        ColorName,\n        ColorClass,\n        Subclass,\n        VendorSku,\n        IsAnaplanActive,\n        SellOutTargetAt,\n        PlannedArrivalAt,\n        FirstSalesDateAt,\n        MSRP,\n        IsSupplies,\n        IsIntangible,\n        DirectSourcingModel,\n        DtcWebsiteColor\n    from unioned\n)\n\nselect * from final", "relation_name": "\"KNSUnifiedMDM\".\"Products\".\"Variant\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.264489Z", "completed_at": "2025-06-07T03:02:34.280122Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.280122Z", "completed_at": "2025-06-07T03:02:34.280122Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01563262939453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.orders__SalesOrderLine", "compiled": true, "compiled_code": "\n\n\n\n\nwith order_line as (\n    select\n        cast(ol.OrderLineId as nvarchar(200)) as SourceId,\n        ol.PackId,\n        cast(ol.OrderHeaderId as nvarchar(200)) as OrderSourceId,\n        ol.ItemId,\n        ol.OrderPackQuantity,\n        ol.CanceledPackQuantity,\n        ol.UnitCost,\n        ol.OrderLineStatus,\n        'Deposco' as SourceSystem\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__OrderLine\" ol\n    left join \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Item\" i\n    on ol.ItemId = i.ItemId\n    where ol.OrderLineStatus not in ('Void', 'Voided')\n        and i.CompanyId = 73\n        and i.ItemId != 102648 -- Exclude 'Invalid Item' item\n\n),\n\ninvoice_header as (\n    select \n        OrderHeaderId,\n        Number,\n        concat('DEP_INV', InvoiceHeaderId) as InvoiceHeaderId,\n        row_number() over (\n            partition by OrderHeaderId\n            order by InvoiceHeaderId\n        ) as rn\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__InvoiceHeader\"\n),\n\ninvoice_header_deduped as (\n  select \n    OrderHeaderId,\n    InvoiceHeaderId,\n    Number\n  from invoice_header\n  where rn = 1\n),\n\nnet_invoices as (\n    select \n        t.TranId as InvoiceId,\n        t.CustBodyKnsPo as PO1,\n        t.OtherRefNum as PO2,\n        t.Entity,\n        t.TranDate,\n        convert(decimal(19,4), coalesce(max(tl.Rate), 0)) as UnitItemCOGSAmount,\n        i.externalid as ItemNumber\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_netsuite__Transaction\" t\n    join \"KNSUnifiedMDM\".\"prod\".\"stg_netsuite__Entity\" e\n    on t.entity = e.id\n    join \"KNSUnifiedMDM\".\"prod\".\"stg_netsuite__TransactionLine\" tl\n    on t.id = tl.TransactionId\n    join \"KNSUnifiedMDM\".\"prod\".\"stg_netsuite__Item\" i\n    on tl.item = i.id\n    where tl.ExpenseAccount = 214\n    group by \n        t.TranId,\n        t.CustBodyKnsPo,\n        t.OtherRefNum,\n        t.Entity,\n        t.TranDate,\n        i.externalid\n),\n\nfinal as (\n\n    select\n        cast(ol.SourceId as nvarchar(200)) as SourceId,\n        so.SalesOrderId,\n        v.VariantId as ProductVariantId,\n        ol.ItemId,\n        ol.OrderPackQuantity * p.Quantity as QuantityOrdered,\n        iif(\n            oh.ShippingStatus = 20,\n            (ol.OrderPackQuantity * p.Quantity) - iif(\n                    ol.OrderLineStatus in ('Canceled', 'Cancelled'),\n                    ol.OrderPackQuantity * p.Quantity,\n                    ol.CanceledPackQuantity * p.Quantity\n                ),\n            0\n        ) as QuantityShipped,\n        iif(\n            ol.OrderLineStatus in ('Canceled', 'Cancelled')\n                or oh.CurrentStatus in ('Canceled', 'Cancelled'),\n            ol.OrderPackQuantity * p.Quantity,\n            ol.CanceledPackQuantity * p.Quantity\n        ) as QuantityCanceled,\n        ol.UnitCost as UnitCostAmount,\n        n.UnitItemCOGSAmount\n    from order_line ol\n    join \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__OrderHeader\" oh\n    on ol.OrderSourceId = oh.OrderHeaderId\n    join \"KNSUnifiedMDM\".\"Orders\".\"SalesOrder\" so\n    on ol.OrderSourceId = so.SourceId\n        and ol.SourceSystem = so.SourceSystem\n    left join \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Item\" i\n    on ol.ItemId = i.ItemId\n    left join \"KNSUnifiedMDM\".\"Products\".\"Variant\" v\n    on i.Number = v.Number\n    left join \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Pack\" p\n    on ol.PackId = p.PackId\n    left join invoice_header_deduped ih\n    on ol.OrderSourceId = ih.OrderHeaderId\n    left join net_invoices n\n    on ih.InvoiceHeaderId = n.InvoiceId and v.Number = n.ItemNumber\n    where oh.CurrentStatus not in ('Void', 'Voided')\n    \n)\n\nselect * from final", "relation_name": "\"KNSUnifiedMDM\".\"Orders\".\"SalesOrderLine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.280122Z", "completed_at": "2025-06-07T03:02:34.295749Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.295749Z", "completed_at": "2025-06-07T03:02:34.295749Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015627622604370117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.MDM.not_null_products__Variant_StyleId.841d0c322a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect StyleId\nfrom \"KNSUnifiedMDM\".\"Products\".\"Variant\"\nwhere StyleId is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-07T03:02:34.311380Z", "completed_at": "2025-06-07T03:02:34.327000Z"}, {"name": "execute", "started_at": "2025-06-07T03:02:34.327000Z", "completed_at": "2025-06-07T03:02:34.327000Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031250715255737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.MDM.not_null_orders__SalesOrderLine_ProductVariantId.bf9a6cb1a2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ProductVariantId\nfrom \"KNSUnifiedMDM\".\"Orders\".\"SalesOrderLine\"\nwhere ProductVariantId is null\n\n\n", "relation_name": null}], "elapsed_time": 0.6718630790710449, "args": {"use_colors": true, "invocation_command": "dbt docs generate --profiles-dir C:/dbt", "static_parser": true, "vars": {}, "version_check": true, "write_json": true, "compile": true, "defer": false, "favor_state": false, "log_format": "default", "exclude": [], "populate_cache": true, "profiles_dir": "C:/dbt", "warn_error_options": {"include": [], "exclude": []}, "empty_catalog": false, "require_explicit_package_overrides_for_builtin_materializations": true, "show_resource_report": false, "partial_parse_file_diff": true, "send_anonymous_usage_stats": true, "source_freshness_run_project_hooks": false, "introspect": true, "log_format_file": "debug", "which": "generate", "require_resource_names_without_spaces": false, "log_file_max_bytes": 10485760, "partial_parse": true, "log_path": "C:\\actions-runner\\_work\\DataTransform\\DataTransform\\MDM\\logs", "macro_debugging": false, "print": true, "log_level": "info", "quiet": false, "static": false, "indirect_selection": "eager", "use_colors_file": true, "enable_legacy_logger": false, "select": [], "strict_mode": false, "log_level_file": "debug", "cache_selected_only": false, "printer_width": 80, "project_dir": "C:\\actions-runner\\_work\\DataTransform\\DataTransform\\MDM"}}