{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2025-05-27T17:30:04.325629Z", "invocation_id": "35934aa9-7beb-4bb4-9090-df905cb0101d", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:03.872525Z", "completed_at": "2025-05-27T17:30:03.888146Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:03.888146Z", "completed_at": "2025-05-27T17:30:03.888146Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015620946884155273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__InvoiceHeader", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"deposco\".\"invoice_header\"\n\n),\n\ncleaned as (\n\n    select \n        cast([INVOICE_HEADER_ID] as bigint) as InvoiceHeaderId,\n        cast([ORDER_HEADER_ID] as bigint) as OrderHeaderId,\n        cast(NUMBER as varchar(75)) as Number\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__InvoiceHeader\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:03.903767Z", "completed_at": "2025-05-27T17:30:03.919405Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:03.919405Z", "completed_at": "2025-05-27T17:30:03.919405Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03125882148742676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__Item", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"deposco\".\"item\"\n\n),\n\ncleaned as (\n\n    select \n        cast([NUMBER] as nvarchar(200)) as Number,\n        cast([ITEM_ID] as bigint) as ItemId,\n        cast([INTANGIBLE_ITEM_FLAG] as bit) as IsIntangible,\n        cast([CLASS_TYPE] as varchar(30)) as IsSupplies\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Item\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:03.919405Z", "completed_at": "2025-05-27T17:30:03.919405Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:03.935052Z", "completed_at": "2025-05-27T17:30:03.935052Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01564788818359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__OrderHeader", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n    select * from \"KNSDataLake\".\"deposco\".\"order_header\"\n\n),\n\ncleaned as (\n\n    select\n        cast(CUSTOMER_ORDER_NUMBER as varchar(50)) as CustomerOrderNumber,\n        cast(CONSIGNEE_PARTNER_ID as bigint) as TradingPartnerId,\n        cast(KNS_MT_PLACED_DATE as datetime) as PlacedAt,\n        cast(KNS_MT_PLANNED_RELEASE_DATE as\tdatetime) as ContractualShipAt,\n        cast(KNS_MT_PLANNED_SHIP_DATE as datetime) as PlannedShipAt,\n        cast(SHIPPING_STATUS as int) as ShippingStatus,\n        cast(ORDER_HEADER_ID as bigint) as OrderHeaderId,\n        cast(KNS_MT_ACTUAL_SHIP_DATE as\tdatetime) as ShippedAt,\n        cast(ORDER_DISCOUNT_SUBTOTAL as float) as DiscountAmount,\n        cast(CURRENT_STATUS as varchar(50)) as CurrentStatus\n    from source\n    where TYPE = 'Sales Order'\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__OrderHeader\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:03.935052Z", "completed_at": "2025-05-27T17:30:03.950640Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:03.950640Z", "completed_at": "2025-05-27T17:30:03.950640Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015587329864501953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__OrderLine", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n    select * from \"KNSDataLake\".\"deposco\".\"order_line\"\n\n),\n\ncleaned as (\n\n    select\n        cast(ORDER_LINE_ID as bigint) as OrderLineId,\n        cast(PACK_ID as bigint) as PackId,\n        cast(ORDER_HEADER_ID as bigint) as OrderHeaderId,\n        cast(ITEM_ID as bigint) as ItemId,\n        cast(ORDER_PACK_QUANTITY as float) as OrderPackQuantity,\n        cast(CANCELED_PACK_QUANTITY as float) as CanceledPackQuantity,\n        cast(ORDER_LINE_STATUS as varchar(50)) as OrderLineStatus,\n        -- cast(CO_LINE_ID as bigint) as CoLineId,\n        -- cast(SHIPPED_PACK_QUANTITY as float) as ShippedPackQuantity,\n        cast(UNIT_COST as float) as UnitCost\n        -- cast(UPDATED_DATE as datetime) as UpdatedDate\n    from source\n    where CREATED_DATE < dateadd(minute, -30, getdate())\n\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__OrderLine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:03.966263Z", "completed_at": "2025-05-27T17:30:03.966263Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:03.981925Z", "completed_at": "2025-05-27T17:30:03.981925Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031285762786865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__Pack", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n        select * from \"KNSDataLake\".\"deposco\".\"pack\"\n\n),\n\ncleaned as (\n\n    select \n        cast(PACK_ID as bigint) as PackId,\n        cast(QUANTITY as int) as Quantity\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Pack\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:03.981925Z", "completed_at": "2025-05-27T17:30:03.997519Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:03.997519Z", "completed_at": "2025-05-27T17:30:03.997519Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015593290328979492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__Shipment", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n        select * from \"KNSDataLake\".\"deposco\".\"shipment\"\n\n),\n\ncleaned as (\n\n    select \n        cast(SHIPMENT_ID as bigint) as ShipmentId,\n        cast(SHIP_VIA as varchar(50)) as ShippingVia,\n        cast(STATUS as varchar(50)) as Status\n        -- cast(FREIGHT_TERMS_TYPE as varchar(50)) as FreightTermsType,\n        -- cast(SHIPPING_COST as float) as ShippingCost\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Shipment\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:03.997519Z", "completed_at": "2025-05-27T17:30:03.997519Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.013156Z", "completed_at": "2025-05-27T17:30:04.013156Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01563739776611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__ShipmentOrderHeader", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n        select * from \"KNSDataLake\".\"deposco\".\"shipment_order_header\"\n\n),\n\ncleaned as (\n\n    select \n        cast(ORDER_HEADER_ID as bigint) as OrderHeaderId,\n        cast(SHIPMENT_ID as bigint) as ShipmentId\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__ShipmentOrderHeader\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:04.013156Z", "completed_at": "2025-05-27T17:30:04.013156Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.028818Z", "completed_at": "2025-05-27T17:30:04.028818Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01566147804260254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__TradingPartner", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"deposco\".\"trading_partner\"\n\n),\n\ncolumns as (\n\n    select \n        cast([TRADING_PARTNER_ID] as bigint) as TradingPartnerId,\n        cast([NAME] as nvarchar(50)) as Name,\n        cast([BILL_TO_COUNTRY] as varchar(100)) as FulfillmentChannelType,\n        cast([BILL_TO_STATE_PROVINCE] as varchar(100)) as FinancialChannelType,\n        cast([DROPSHIP_FEE] as float) as HandlingFee,\n        cast([SIC] as varchar(20)) as HandlingFeeType\n    from source\n\n),\n\ncleaned as (\n    select\n        TradingPartnerId,\n        Name,\n        FulfillmentChannelType,\n        FinancialChannelType,\n        HandlingFee,\n        case\n            when HandlingFeeType = 'order' then 'Order'\n            when HandlingFeeType is null and HandlingFee != 0 then 'Unit'\n            else null\n        end as HandlingFeeType\n    from columns\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__TradingPartner\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:04.028818Z", "completed_at": "2025-05-27T17:30:04.028818Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.028818Z", "completed_at": "2025-05-27T17:30:04.028818Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_mdm_products__Catalog", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSUnifiedMDM\".\"Products\".\"Catalog\"\n\n),\n\ncleaned as (\n\n    select \n        cast(CatalogId as int) as CatalogId,\n        cast(Name as nvarchar(32)) as Name,\n        cast(BrandId as int) as BrandId\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_mdm_products__Catalog\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:04.028818Z", "completed_at": "2025-05-27T17:30:04.044391Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.044391Z", "completed_at": "2025-05-27T17:30:04.044391Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015573263168334961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_mdm_products__Subclass", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSUnifiedMDM\".\"Products\".\"Subclass\"\n\n),\n\ncleaned as (\n\n    select \n        cast(SubclassId as int) as SubclassId,\n        cast(Name as nvarchar(64)) as Name,\n        cast(Class as nvarchar(64)) as Class\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_mdm_products__Subclass\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:04.044391Z", "completed_at": "2025-05-27T17:30:04.060053Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.060053Z", "completed_at": "2025-05-27T17:30:04.060053Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015661954879760742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_netsuite__Entity", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"entity\"\n\n),\n\ncleaned as (\n\n    select \n        cast(id as bigint) as Id,\n        cast(entityid as nvarchar(128)) as EntityId\n    from source \n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_netsuite__Entity\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:04.060053Z", "completed_at": "2025-05-27T17:30:04.075636Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.075636Z", "completed_at": "2025-05-27T17:30:04.075636Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01558375358581543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_netsuite__Item", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"item\"\n\n),\n\ncleaned as (\n\n    select \n        cast(id as bigint) as Id,\n        cast(externalid as nvarchar(255)) as ExternalId\n    from source \n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_netsuite__Item\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:04.075636Z", "completed_at": "2025-05-27T17:30:04.091260Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.091260Z", "completed_at": "2025-05-27T17:30:04.091260Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015623807907104492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_netsuite__Transaction", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"transaction\"\n\n),\n\ncleaned as (\n\n    select\n        cast(tranid as nvarchar(90)) as TranId,\n        cast(custbody_kns_po as nvarchar(4000)) as CustBodyKnsPo,\n        cast(otherrefnum as nvarchar(90)) as OtherRefNum,\n        cast(entity as bigint) as Entity,\n        cast(id as bigint) as Id,\n        cast(trandate as date) as TranDate\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_netsuite__Transaction\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:04.091260Z", "completed_at": "2025-05-27T17:30:04.106886Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.106886Z", "completed_at": "2025-05-27T17:30:04.106886Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0156252384185791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_netsuite__TransactionLine", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"transactionLine\"\n\n),\n\ncleaned as (\n\n    select\n        cast(uniquekey as bigint) as UniqueKey,\n        cast([transaction] as bigint) as TransactionId,\n        cast(rate as float) as Rate,\n        cast(expenseaccount as bigint) as ExpenseAccount,\n        cast(debitforeignamount as float) as DebitForeignAmount,\n        cast(creditforeignamount as float) as CreditForeignAmount,\n        cast(memo as nvarchar(4000)) as Memo,\n        cast(item as bigint) as Item\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_netsuite__TransactionLine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:04.106886Z", "completed_at": "2025-05-27T17:30:04.122511Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.122511Z", "completed_at": "2025-05-27T17:30:04.122511Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0156252384185791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_salsify__Product", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"salsify\".\"Product\"\n\n),\n\ncleaned as (\n\n    select \n        cast([Main SKU] as nvarchar(128)) as MainSku,\n        cast([Sub Category] as nvarchar(128)) as SubCategory,\n        cast([Merchandise Subclass] as nvarchar(128)) as MerchandiseSubclass,\n        cast([Color Class] as nvarchar(128)) as ColorClass,\n        cast(Color as nvarchar(128)) as Color,\n        cast(Brand as nvarchar(128)) as Brand,\n        cast(Gender as nvarchar(128)) as Gender,\n        cast(Size as nvarchar(128)) as Size,\n        cast(Seasonality as nvarchar(128)) as Seasonality,\n        cast([Size Run] as nvarchar(128)) as SizeRun,\n        cast(Vendor as nvarchar(128)) as Vendor,\n        cast([Vendor SKU] as nvarchar(128)) as VendorSku,\n        cast(case lower([Sell Out Target Date Month])\n            when 'january' then 1\n            when 'february' then 2\n            when 'march' then 3\n            when 'april' then 4\n            when 'may' then 5\n            when 'june' then 6\n            when 'july' then 7\n            when 'august' then 8\n            when 'september' then 9\n            when 'october' then 10\n            when 'november' then 11\n            when 'december' then 12\n            else null\n        end as int) as SellOutTargetDateMonth,\n        nullif(cast([Sell Out Target Date Year] as int), 0) as SellOutTargetDateYear,\n        cast([Planned Arrival Date Month] as nvarchar(128)) as PlannedArrivalDateMonth,\n        nullif(cast([First Sales Date] as date), '1900-01-01') as FirstSalesDateAt,\n        cast(Status as nvarchar(128)) as Status,\n        cast([Closure Type] as nvarchar(128)) as ClosureType,\n        cast([Heel Height] as nvarchar(128)) as HeelHeight,\n        cast([Style Type] as nvarchar(128)) as StyleType,\n        cast(Style as nvarchar(128)) as Style,\n        cast([Parent SKU] as nvarchar(128)) as ParentSku,\n        cast([Calf Width] as nvarchar(128)) as CalfWidth,\n        cast([Shoe Width] as nvarchar(128)) as ShoeWidth,\n        cast([Anaplan Active] as bit) as AnaplanActive,\n        cast([Case Quantity] as int) as CaseQuantity,\n        cast(MSRP as decimal(19, 4)) as Msrp,\n        cast([Season Budget] as nvarchar(16)) as SeasonBudget,\n        cast([Selling Status] as nvarchar(32)) as SellingStatus,\n        cast([Direct Sourcing Model] as nvarchar(64)) as DirectSourcingModel\n    from source\n    where nullif(trim([Parent SKU]), '') is not null\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_salsify__Product\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:04.122511Z", "completed_at": "2025-05-27T17:30:04.138135Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.138135Z", "completed_at": "2025-05-27T17:30:04.138135Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015623807907104492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.orders__TradingPartner", "compiled": true, "compiled_code": "\n\nselect \n  Name,\n  FulfillmentChannelType,\n  FinancialChannelType\nfrom \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__TradingPartner\"", "relation_name": "\"KNSUnifiedMDM\".\"Orders\".\"TradingPartner\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:04.138135Z", "completed_at": "2025-05-27T17:30:04.138135Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.153757Z", "completed_at": "2025-05-27T17:30:04.153757Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015621662139892578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.int_products__Style", "compiled": true, "compiled_code": "with products as (\n\n    select distinct\n        Style as Name,\n        Vendor,\n        VendorSku,\n        Seasonality as Season,\n        CaseQuantity,\n        Gender,\n        Brand,\n        MerchandiseSubclass,\n        SeasonBudget\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_salsify__Product\"\n\n),\n\nranked as (\n\n    select \n        *,\n        row_number() over (\n            partition by Name \n            order by (select null)\n        ) as rank\n    from products\n\n)\n\nselect\n    Name,\n    Vendor,\n    VendorSku,\n    Season,\n    CaseQuantity,\n    SeasonBudget,\n    Gender,\n    Brand,\n    MerchandiseSubclass\nfrom ranked\nwhere rank = 1\n    and Name is not null\n    and Name != ''", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"int_products__Style\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:04.153757Z", "completed_at": "2025-05-27T17:30:04.153757Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.169381Z", "completed_at": "2025-05-27T17:30:04.169381Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624761581420898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.products__Subclass", "compiled": true, "compiled_code": "\n\nwith ranked as (\n  select \n    MerchandiseSubclass as Name,\n    case\n      when SubCategory is null or SubCategory in ('', '*No Category*', 'SHIPPING PROTECTION')\n      then 'OTHER'\n      else SubCategory\n    end as Class,\n    row_number() over (partition by MerchandiseSubclass order by (select null)) as rn\n  from \"KNSUnifiedMDM\".\"prod\".\"stg_salsify__Product\"\n  where \n    MerchandiseSubclass is not null\n    and MerchandiseSubclass != ''\n    and SubCategory is not null\n    and SubCategory != ''\n)\n\nselect \n  Name,\n  Class\nfrom ranked\nwhere rn = 1", "relation_name": "\"KNSUnifiedMDM\".\"Products\".\"Subclass\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:04.169381Z", "completed_at": "2025-05-27T17:30:04.185016Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.185016Z", "completed_at": "2025-05-27T17:30:04.185016Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015634536743164062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.products__Variant", "compiled": true, "compiled_code": "\n\nwith styles as ( \n    select * from Products.Style\n),\n\nvariants as (\n    select \n        MainSku as Number,\n        null as Code,\n        Status,\n        SellingStatus,\n        ShoeWidth,\n        CalfWidth,\n        ParentSku as Parent,\n        ClosureType,\n        HeelHeight as HeelType,\n        StyleType,\n        SizeRun,\n        Color as ColorName,\n        ColorClass,\n        AnaplanActive as IsAnaplanActive,\n        case \n            when SellOutTargetDateYear is not null and SellOutTargetDateMonth is not null\n            then datefromparts(SellOutTargetDateYear, SellOutTargetDateMonth, 1)\n            else null\n        end as SellOutTargetAt,\n        PlannedArrivalDateMonth as PlannedArrivalAt,\n        FirstSalesDateAt,\n        MSRP,\n        iif(i.IsSupplies like '%suppl%', 1, 0) as IsSupplies,\n        i.IsIntangible as IsIntangible,\n        DirectSourcingModel,\n        Style,\n        row_number() over (partition by MainSku order by (select null)) as rn\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_salsify__Product\" p\n    left join \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Item\" i\n    on p.MainSku = i.Number\n    where MainSku is not null\n        and MainSku != ''\n),\n\nfinal as (\n    select \n        Number,\n        null as Code,\n        s.StyleId,\n        null as SizeId,\n        v.Status,\n        v.SellingStatus,\n        v.ShoeWidth,\n        v.CalfWidth,\n        v.Parent,\n        v.ClosureType,\n        v.HeelType,\n        v.StyleType,\n        v.SizeRun,\n        v.ColorName,\n        v.ColorClass,\n        v.IsAnaplanActive,\n        v.SellOutTargetAt,\n        v.PlannedArrivalAt,\n        v.FirstSalesDateAt,\n        v.MSRP,\n        v.IsSupplies,\n        v.IsIntangible,\n        v.DirectSourcingModel\n    from variants v\n    left join styles s\n    on v.Style = s.Name\n    where rn = 1\n)\n\nselect * from final", "relation_name": "\"KNSUnifiedMDM\".\"Products\".\"Variant\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:04.200635Z", "completed_at": "2025-05-27T17:30:04.216288Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.216288Z", "completed_at": "2025-05-27T17:30:04.216288Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01565384864807129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.orders__SalesOrder", "compiled": true, "compiled_code": "\n\n\n\nwith order_header as (\n    select\n        CustomerOrderNumber,\n        TradingPartnerId,\n        PlacedAt,\n        ContractualShipAt,\n        PlannedShipAt,\n        ShippingStatus,\n        OrderHeaderId,\n        ShippedAt,\n        DiscountAmount\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__OrderHeader\"\n),\n\nfinal as (\n\n    select\n        oh.CustomerOrderNumber as PONumber,\n        tp.TradingPartnerId,\n        oh.PlacedAt,\n        oh.ContractualShipAt,\n        oh.PlannedShipAt,\n        case\n            when oh.ShippingStatus = 20 then 'Closed'\n            else 'Open'\n        end as Status,\n        oh.OrderHeaderId as SourceId,\n        'Deposco' as SourceSystem,\n        min(iif(s.Status='Shipped', s.ShippingVia, null)) as ShippingVia,\n        min(case\n            when s.ShippingVia like '%easypost%' then 'USPS'\n            when s.ShippingVia like '%stamps%' then 'USPS'\n            when s.ShippingVia like '%fedex%' then 'FedEx'\n            when s.ShippingVia like '%UPS%' or s.ShippingVia = 'USG' then 'UPS'\n            when s.ShippingVia like '%landmark%' then 'Landmark'\n        end) as ShippingCarrier,\n        oh.ShippedAt,\n        null as FreightOutCOGSAmount,\n        oh.DiscountAmount\n    from order_header oh\n    left join \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__ShipmentOrderHeader\" soh \n    on oh.OrderHeaderId = soh.OrderHeaderId\n    left join \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Shipment\" s\n    on soh.ShipmentId = s.ShipmentId\n    left join \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__TradingPartner\" dtp \n    on oh.TradingPartnerId = dtp.TradingPartnerId\n    left join \"KNSUnifiedMDM\".\"Orders\".\"TradingPartner\" tp\n    on dtp.Name = tp.Name\n    group by \n        oh.CustomerOrderNumber,\n        tp.TradingPartnerId,\n        oh.PlacedAt,\n        oh.ContractualShipAt,\n        oh.PlannedShipAt,\n        oh.ShippingStatus,\n        oh.OrderHeaderId,\n        oh.ShippedAt,\n        oh.DiscountAmount\n    \n)\n\nselect * from final", "relation_name": "\"KNSUnifiedMDM\".\"Orders\".\"SalesOrder\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:04.216288Z", "completed_at": "2025-05-27T17:30:04.232067Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.232067Z", "completed_at": "2025-05-27T17:30:04.232067Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015778541564941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.orders__TradingPartnerHandlingFee", "compiled": true, "compiled_code": "\n\n\n\n\nwith ids as (\n    select\n        Name,\n        TradingPartnerId\n    from \"KNSUnifiedMDM\".\"Orders\".\"TradingPartner\"\n),\n\ninfo as (\n    select\n        Name,\n        HandlingFee,\n        HandlingFeeType\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__TradingPartner\"\n),\n\njoined as (\n    select\n        ids.TradingPartnerId,\n        info.HandlingFeeType,\n        info.HandlingFee\n    from ids \n    left join info\n    on ids.Name = info.Name\n),\n\nlatest as (\n    select * from \"KNSUnifiedMDM\".\"Orders\".\"TradingPartnerHandlingFee\"\n    where EndDate is null\n),\n\nnew as (\n    select\n        j.TradingPartnerId,\n        cast(getdate() as date) as StartDate,\n        null as EndDate,\n        j.HandlingFeeType,\n        j.HandlingFee\n    from joined j\n    left join latest l\n    on j.TradingPartnerId = l.TradingPartnerId\n    where l.TradingPartnerId is null \n        or j.HandlingFee != l.HandlingFee\n        or l.HandlingFeeType != j.HandlingFeeType\n),\n\nexpired as (\n    select\n        l.TradingPartnerId,\n        l.StartDate,\n        cast(getdate() as date) as EndDate,\n        l.HandlingFeeType,\n        l.HandlingFee\n    from latest l\n    left join joined j\n    on l.TradingPartnerId = j.TradingPartnerId\n    where j.TradingPartnerId is null \n        or j.HandlingFee != l.HandlingFee\n        or j.HandlingFeeType != l.HandlingFeeType\n),\n\nfinal as (\n    select * from new\n    union all\n    select * from expired\n)\n\nselect * from final", "relation_name": "\"KNSUnifiedMDM\".\"Orders\".\"TradingPartnerHandlingFee\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:04.232067Z", "completed_at": "2025-05-27T17:30:04.247553Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.263140Z", "completed_at": "2025-05-27T17:30:04.263140Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03107309341430664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.MDM.not_null_orders__TradingPartner_FulfillmentChannelType.88ae6a8cc1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect FulfillmentChannelType\nfrom \"KNSUnifiedMDM\".\"Orders\".\"TradingPartner\"\nwhere FulfillmentChannelType is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:04.263140Z", "completed_at": "2025-05-27T17:30:04.278758Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.278758Z", "completed_at": "2025-05-27T17:30:04.278758Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015618085861206055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.products__Style", "compiled": true, "compiled_code": "\n\nwith styles as ( \n    select * from \"KNSUnifiedMDM\".\"prod\".\"int_products__Style\"\n),\n\ncatalog as (\n    select * from \"KNSUnifiedMDM\".\"prod\".\"stg_mdm_products__Catalog\"\n),\n\nsubclass as (\n    select * from \"KNSUnifiedMDM\".\"prod\".\"stg_mdm_products__Subclass\"\n),\n\nfinal as (\n    select \n        null as Code,\n        c.CatalogId,\n        sc.SubclassId,\n        s.Vendor,\n        s.VendorSku,\n        s.Season,\n        s.CaseQuantity,\n        s.Name,\n        case \n            when s.Gender = '' then null \n            else s.Gender \n        end as Gender,\n        s.SeasonBudget\n    from styles s\n    left join catalog c\n    on s.Brand = c.Name\n    left join subclass sc\n    on s.MerchandiseSubclass = sc.Name\n    where s.Name is not null\n        and s.Name != ''\n)\n\nselect * from final", "relation_name": "\"KNSUnifiedMDM\".\"Products\".\"Style\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-27T17:30:04.294385Z", "completed_at": "2025-05-27T17:30:04.310002Z"}, {"name": "execute", "started_at": "2025-05-27T17:30:04.310002Z", "completed_at": "2025-05-27T17:30:04.310002Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015616178512573242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.orders__SalesOrderLine", "compiled": true, "compiled_code": "\n\n\n\n\nwith order_line as (\n    select\n        OrderLineId as SourceId,\n        PackId,\n        OrderHeaderId as OrderSourceId,\n        ItemId,\n        OrderPackQuantity,\n        CanceledPackQuantity,\n        UnitCost,\n        OrderLineStatus\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__OrderLine\"\n),\n\ninvoice_header as (\n    select \n        OrderHeaderId,\n        Number,\n        concat('DEP_INV', InvoiceHeaderId) as InvoiceHeaderId,\n        row_number() over (\n            partition by OrderHeaderId\n            order by InvoiceHeaderId\n        ) as rn\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__InvoiceHeader\"\n),\n\ninvoice_header_deduped as (\n  select \n    OrderHeaderId,\n    InvoiceHeaderId,\n    Number\n  from invoice_header\n  where rn = 1\n),\n\nnet_invoices as (\n    select \n        t.TranId as InvoiceId,\n        t.CustBodyKnsPo as PO1,\n        t.OtherRefNum as PO2,\n        t.Entity,\n        t.TranDate,\n        convert(decimal(19,4), coalesce(max(tl.Rate), 0)) as UnitItemCOGSAmount,\n        i.externalid as ItemNumber\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_netsuite__Transaction\" t\n    join \"KNSUnifiedMDM\".\"prod\".\"stg_netsuite__Entity\" e\n    on t.entity = e.id\n    join \"KNSUnifiedMDM\".\"prod\".\"stg_netsuite__TransactionLine\" tl\n    on t.id = tl.TransactionId\n    join \"KNSUnifiedMDM\".\"prod\".\"stg_netsuite__Item\" i\n    on tl.item = i.id\n    where tl.ExpenseAccount = 214\n    group by \n        t.TranId,\n        t.CustBodyKnsPo,\n        t.OtherRefNum,\n        t.Entity,\n        t.TranDate,\n        i.externalid\n),\n\nfinal as (\n\n    select\n        ol.SourceId,\n        so.SalesOrderId,\n        v.VariantId as ProductVariantId,\n        ol.OrderPackQuantity * p.Quantity as QuantityOrdered,\n        iif(\n            oh.ShippingStatus = 20,\n            (ol.OrderPackQuantity * p.Quantity) - iif(\n                    ol.OrderLineStatus in ('Canceled', 'Cancelled'),\n                    ol.OrderPackQuantity * p.Quantity,\n                    ol.CanceledPackQuantity * p.Quantity\n                ),\n            0\n        ) as QuantityShipped,\n        iif(\n            ol.OrderLineStatus in ('Canceled', 'Cancelled')\n                or oh.CurrentStatus in ('Canceled', 'Cancelled'),\n            ol.OrderPackQuantity * p.Quantity,\n            ol.CanceledPackQuantity * p.Quantity\n        ) as QuantityCanceled,\n        ol.UnitCost as UnitCostAmount,\n        n.UnitItemCOGSAmount\n    from order_line ol\n    join \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__OrderHeader\" oh\n    on ol.OrderSourceId = oh.OrderHeaderId\n    left join \"KNSUnifiedMDM\".\"Orders\".\"SalesOrder\" so\n    on ol.OrderSourceId = so.SourceId\n    left join \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Item\" i\n    on ol.ItemId = i.ItemId\n    left join \"KNSUnifiedMDM\".\"Products\".\"Variant\" v\n    on i.Number = v.Number\n    left join \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Pack\" p\n    on ol.PackId = p.PackId\n    left join invoice_header_deduped ih\n    on ol.OrderSourceId = ih.OrderHeaderId\n    left join net_invoices n\n    on ih.InvoiceHeaderId = n.InvoiceId and v.Number = n.ItemNumber\n    \n)\n\nselect * from final", "relation_name": "\"KNSUnifiedMDM\".\"Orders\".\"SalesOrderLine\""}], "elapsed_time": 1.156205654144287, "args": {"defer": false, "log_format": "default", "select": [], "invocation_command": "dbt docs generate --profiles-dir C:/dbt", "log_level_file": "debug", "use_colors_file": true, "vars": {}, "warn_error_options": {"include": [], "exclude": []}, "strict_mode": false, "introspect": true, "printer_width": 80, "log_level": "info", "log_format_file": "debug", "write_json": true, "version_check": true, "exclude": [], "print": true, "cache_selected_only": false, "quiet": false, "require_resource_names_without_spaces": false, "favor_state": false, "require_explicit_package_overrides_for_builtin_materializations": true, "indirect_selection": "eager", "show_resource_report": false, "send_anonymous_usage_stats": true, "profiles_dir": "C:/dbt", "static": false, "enable_legacy_logger": false, "empty_catalog": false, "project_dir": "C:\\actions-runner\\_work\\DataTransform\\DataTransform\\MDM", "source_freshness_run_project_hooks": false, "populate_cache": true, "compile": true, "macro_debugging": false, "partial_parse_file_diff": true, "log_path": "C:\\actions-runner\\_work\\DataTransform\\DataTransform\\MDM\\logs", "static_parser": true, "use_colors": true, "log_file_max_bytes": 10485760, "which": "generate", "partial_parse": true}}