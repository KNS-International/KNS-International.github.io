{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2025-05-20T09:12:02.062555Z", "invocation_id": "2947afe7-f6d1-48dd-9f5d-8b219f9cac58", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T09:12:01.906319Z", "completed_at": "2025-05-20T09:12:01.921934Z"}, {"name": "execute", "started_at": "2025-05-20T09:12:01.921934Z", "completed_at": "2025-05-20T09:12:01.921934Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015615224838256836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.orders__CustomerOrder", "compiled": true, "compiled_code": "", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"orders__CustomerOrder\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T09:12:01.921934Z", "completed_at": "2025-05-20T09:12:01.921934Z"}, {"name": "execute", "started_at": "2025-05-20T09:12:01.921934Z", "completed_at": "2025-05-20T09:12:01.921934Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__Item", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"deposco\".\"item\"\n\n),\n\ncleaned as (\n\n    select \n        cast([NUMBER] as nvarchar(200)) as Number,\n        cast([INTANGIBLE_ITEM_FLAG] as bit) as IsIntangible,\n        cast([CLASS_TYPE] as varchar(30)) as IsSupplies\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Item\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T09:12:01.921934Z", "completed_at": "2025-05-20T09:12:01.937558Z"}, {"name": "execute", "started_at": "2025-05-20T09:12:01.937558Z", "completed_at": "2025-05-20T09:12:01.937558Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624284744262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_deposco__TradingPartner", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"deposco\".\"trading_partner\"\n\n),\n\ncolumns as (\n\n    select \n        cast([NAME] as nvarchar(50)) as Name,\n        cast([BILL_TO_COUNTRY] as varchar(100)) as FulfillmentChannelType,\n        cast([BILL_TO_STATE_PROVINCE] as varchar(100)) as FinancialChannelType,\n        cast([DROPSHIP_FEE] as float) as HandlingFee,\n        cast([SIC] as varchar(20)) as HandlingFeeType\n    from source\n\n),\n\ncleaned as (\n    select\n        Name,\n        FulfillmentChannelType,\n        FinancialChannelType,\n        HandlingFee,\n        case\n            when HandlingFeeType = 'order' then 'Order'\n            when HandlingFeeType is null and HandlingFee != 0 then 'Unit'\n            else null\n        end as HandlingFeeType\n    from columns\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_deposco__TradingPartner\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T09:12:01.937558Z", "completed_at": "2025-05-20T09:12:01.937558Z"}, {"name": "execute", "started_at": "2025-05-20T09:12:01.937558Z", "completed_at": "2025-05-20T09:12:01.937558Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_mdm_products__Catalog", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSUnifiedMDM\".\"Products\".\"Catalog\"\n\n),\n\ncleaned as (\n\n    select \n        cast(CatalogId as int) as CatalogId,\n        cast(Name as nvarchar(32)) as Name,\n        cast(BrandId as int) as BrandId\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_mdm_products__Catalog\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T09:12:01.953181Z", "completed_at": "2025-05-20T09:12:01.953181Z"}, {"name": "execute", "started_at": "2025-05-20T09:12:01.953181Z", "completed_at": "2025-05-20T09:12:01.953181Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_mdm_products__Subclass", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSUnifiedMDM\".\"Products\".\"Subclass\"\n\n),\n\ncleaned as (\n\n    select \n        cast(SubclassId as int) as SubclassId,\n        cast(Name as nvarchar(64)) as Name,\n        cast(Class as nvarchar(64)) as Class\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_mdm_products__Subclass\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T09:12:01.953181Z", "completed_at": "2025-05-20T09:12:01.968806Z"}, {"name": "execute", "started_at": "2025-05-20T09:12:01.968806Z", "completed_at": "2025-05-20T09:12:01.968806Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0156252384185791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.stg_salsify__Product", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"salsify\".\"Product\"\n\n),\n\ncleaned as (\n\n    select \n        cast([Main SKU] as nvarchar(128)) as MainSku,\n        cast([Sub Category] as nvarchar(128)) as SubCategory,\n        cast([Merchandise Subclass] as nvarchar(128)) as MerchandiseSubclass,\n        cast([Color Class] as nvarchar(128)) as ColorClass,\n        cast(Color as nvarchar(128)) as Color,\n        cast(Brand as nvarchar(128)) as Brand,\n        cast(Gender as nvarchar(128)) as Gender,\n        cast(Size as nvarchar(128)) as Size,\n        cast(Seasonality as nvarchar(128)) as Seasonality,\n        cast([Size Run] as nvarchar(128)) as SizeRun,\n        cast(Vendor as nvarchar(128)) as Vendor,\n        cast([Vendor SKU] as nvarchar(128)) as VendorSku,\n        cast(case lower([Sell Out Target Date Month])\n            when 'january' then 1\n            when 'february' then 2\n            when 'march' then 3\n            when 'april' then 4\n            when 'may' then 5\n            when 'june' then 6\n            when 'july' then 7\n            when 'august' then 8\n            when 'september' then 9\n            when 'october' then 10\n            when 'november' then 11\n            when 'december' then 12\n            else null\n        end as int) as SellOutTargetDateMonth,\n        nullif(cast([Sell Out Target Date Year] as int), 0) as SellOutTargetDateYear,\n        cast([Planned Arrival Date Month] as nvarchar(128)) as PlannedArrivalDateMonth,\n        nullif(cast([First Sales Date] as date), '1900-01-01') as FirstSalesDateAt,\n        cast(Status as nvarchar(128)) as Status,\n        cast([Closure Type] as nvarchar(128)) as ClosureType,\n        cast([Heel Height] as nvarchar(128)) as HeelHeight,\n        cast([Style Type] as nvarchar(128)) as StyleType,\n        cast(Style as nvarchar(128)) as Style,\n        cast([Parent SKU] as nvarchar(128)) as ParentSku,\n        cast([Calf Width] as nvarchar(128)) as CalfWidth,\n        cast([Shoe Width] as nvarchar(128)) as ShoeWidth,\n        cast([Anaplan Active] as bit) as AnaplanActive,\n        cast([Case Quantity] as int) as CaseQuantity,\n        cast(MSRP as decimal(19, 4)) as Msrp,\n        cast([Season Budget] as nvarchar(16)) as SeasonBudget,\n        cast([Selling Status] as nvarchar(32)) as SellingStatus,\n        cast([Direct Sourcing Model] as nvarchar(64)) as DirectSourcingModel\n    from source\n    where nullif(trim([Parent SKU]), '') is not null\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"stg_salsify__Product\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T09:12:01.968806Z", "completed_at": "2025-05-20T09:12:01.968806Z"}, {"name": "execute", "started_at": "2025-05-20T09:12:01.968806Z", "completed_at": "2025-05-20T09:12:01.968806Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.orders__TradingPartner", "compiled": true, "compiled_code": "\n\nselect \n  Name,\n  FulfillmentChannelType,\n  FinancialChannelType\nfrom \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__TradingPartner\"", "relation_name": "\"KNSUnifiedMDM\".\"Orders\".\"TradingPartner\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T09:12:01.968806Z", "completed_at": "2025-05-20T09:12:01.984430Z"}, {"name": "execute", "started_at": "2025-05-20T09:12:01.984430Z", "completed_at": "2025-05-20T09:12:01.984430Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01562356948852539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.int_products__Style", "compiled": true, "compiled_code": "with products as (\n\n    select distinct\n        Style as Name,\n        Vendor,\n        VendorSku,\n        Seasonality as Season,\n        CaseQuantity,\n        Gender,\n        Brand,\n        MerchandiseSubclass,\n        SeasonBudget\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_salsify__Product\"\n\n),\n\nranked as (\n\n    select \n        *,\n        row_number() over (\n            partition by Name \n            order by (select null)\n        ) as rank\n    from products\n\n)\n\nselect\n    Name,\n    Vendor,\n    VendorSku,\n    Season,\n    CaseQuantity,\n    SeasonBudget,\n    Gender,\n    Brand,\n    MerchandiseSubclass\nfrom ranked\nwhere rank = 1\n    and Name is not null\n    and Name != ''", "relation_name": "\"KNSUnifiedMDM\".\"prod\".\"int_products__Style\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T09:12:01.984430Z", "completed_at": "2025-05-20T09:12:02.000057Z"}, {"name": "execute", "started_at": "2025-05-20T09:12:02.000057Z", "completed_at": "2025-05-20T09:12:02.000057Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015627622604370117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.products__Subclass", "compiled": true, "compiled_code": "\n\nwith ranked as (\n  select \n    MerchandiseSubclass as Name,\n    case\n      when SubCategory is null or SubCategory in ('', '*No Category*', 'SHIPPING PROTECTION')\n      then 'OTHER'\n      else SubCategory\n    end as Class,\n    row_number() over (partition by MerchandiseSubclass order by (select null)) as rn\n  from \"KNSUnifiedMDM\".\"prod\".\"stg_salsify__Product\"\n  where \n    MerchandiseSubclass is not null\n    and MerchandiseSubclass != ''\n    and SubCategory is not null\n    and SubCategory != ''\n)\n\nselect \n  Name,\n  Class\nfrom ranked\nwhere rn = 1", "relation_name": "\"KNSUnifiedMDM\".\"Products\".\"Subclass\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T09:12:02.000057Z", "completed_at": "2025-05-20T09:12:02.000057Z"}, {"name": "execute", "started_at": "2025-05-20T09:12:02.000057Z", "completed_at": "2025-05-20T09:12:02.000057Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.products__Variant", "compiled": true, "compiled_code": "\n\nwith styles as ( \n    select * from Products.Style\n),\n\nvariants as (\n    select \n        MainSku as Number,\n        null as Code,\n        Status,\n        SellingStatus,\n        ShoeWidth,\n        CalfWidth,\n        ParentSku as Parent,\n        ClosureType,\n        HeelHeight as HeelType,\n        StyleType,\n        SizeRun,\n        Color as ColorName,\n        ColorClass,\n        AnaplanActive as IsAnaplanActive,\n        case \n            when SellOutTargetDateYear is not null and SellOutTargetDateMonth is not null\n            then datefromparts(SellOutTargetDateYear, SellOutTargetDateMonth, 1)\n            else null\n        end as SellOutTargetAt,\n        PlannedArrivalDateMonth as PlannedArrivalAt,\n        FirstSalesDateAt,\n        MSRP,\n        iif(i.IsSupplies like '%suppl%', 1, 0) as IsSupplies,\n        i.IsIntangible as IsIntangible,\n        DirectSourcingModel,\n        Style,\n        row_number() over (partition by MainSku order by (select null)) as rn\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_salsify__Product\" p\n    left join \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__Item\" i\n    on p.MainSku = i.Number\n    where MainSku is not null\n        and MainSku != ''\n),\n\nfinal as (\n    select \n        Number,\n        null as Code,\n        s.StyleId,\n        null as SizeId,\n        v.Status,\n        v.SellingStatus,\n        v.ShoeWidth,\n        v.CalfWidth,\n        v.Parent,\n        v.ClosureType,\n        v.HeelType,\n        v.StyleType,\n        v.SizeRun,\n        v.ColorName,\n        v.ColorClass,\n        v.IsAnaplanActive,\n        v.SellOutTargetAt,\n        v.PlannedArrivalAt,\n        v.FirstSalesDateAt,\n        v.MSRP,\n        v.IsSupplies,\n        v.IsIntangible,\n        v.DirectSourcingModel\n    from variants v\n    left join styles s\n    on v.Style = s.Name\n    where rn = 1\n)\n\nselect * from final", "relation_name": "\"KNSUnifiedMDM\".\"Products\".\"Variant\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T09:12:02.015681Z", "completed_at": "2025-05-20T09:12:02.015681Z"}, {"name": "execute", "started_at": "2025-05-20T09:12:02.015681Z", "completed_at": "2025-05-20T09:12:02.015681Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.orders__TradingPartnerHandlingFee", "compiled": true, "compiled_code": "\n\n\n\n\nwith ids as (\n    select\n        Name,\n        TradingPartnerId\n    from \"KNSUnifiedMDM\".\"Orders\".\"TradingPartner\"\n),\n\ninfo as (\n    select\n        Name,\n        HandlingFee,\n        HandlingFeeType\n    from \"KNSUnifiedMDM\".\"prod\".\"stg_deposco__TradingPartner\"\n),\n\njoined as (\n    select\n        ids.TradingPartnerId,\n        info.HandlingFeeType,\n        info.HandlingFee\n    from ids \n    left join info\n    on ids.Name = info.Name\n),\n\nlatest as (\n    select * from \"KNSUnifiedMDM\".\"Orders\".\"TradingPartnerHandlingFee\"\n    where EndDate is null\n),\n\nnew as (\n    select\n        j.TradingPartnerId,\n        cast(getdate() as date) as StartDate,\n        null as EndDate,\n        j.HandlingFeeType,\n        j.HandlingFee\n    from joined j\n    left join latest l\n    on j.TradingPartnerId = l.TradingPartnerId\n    where l.TradingPartnerId is null \n        or j.HandlingFee != l.HandlingFee\n        or l.HandlingFeeType != j.HandlingFeeType\n),\n\nexpired as (\n    select\n        l.TradingPartnerId,\n        l.StartDate,\n        cast(getdate() as date) as EndDate,\n        l.HandlingFeeType,\n        l.HandlingFee\n    from latest l\n    left join joined j\n    on l.TradingPartnerId = j.TradingPartnerId\n    where j.TradingPartnerId is null \n        or j.HandlingFee != l.HandlingFee\n        or j.HandlingFeeType != l.HandlingFeeType\n),\n\nfinal as (\n    select * from new\n    union all\n    select * from expired\n)\n\nselect * from final", "relation_name": "\"KNSUnifiedMDM\".\"Orders\".\"TradingPartnerHandlingFee\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T09:12:02.015681Z", "completed_at": "2025-05-20T09:12:02.046930Z"}, {"name": "execute", "started_at": "2025-05-20T09:12:02.046930Z", "completed_at": "2025-05-20T09:12:02.046930Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03124856948852539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.MDM.not_null_orders__TradingPartner_FulfillmentChannelType.88ae6a8cc1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect FulfillmentChannelType\nfrom \"KNSUnifiedMDM\".\"Orders\".\"TradingPartner\"\nwhere FulfillmentChannelType is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-20T09:12:02.046930Z", "completed_at": "2025-05-20T09:12:02.046930Z"}, {"name": "execute", "started_at": "2025-05-20T09:12:02.046930Z", "completed_at": "2025-05-20T09:12:02.046930Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.MDM.products__Style", "compiled": true, "compiled_code": "\n\nwith styles as ( \n    select * from \"KNSUnifiedMDM\".\"prod\".\"int_products__Style\"\n),\n\ncatalog as (\n    select * from \"KNSUnifiedMDM\".\"prod\".\"stg_mdm_products__Catalog\"\n),\n\nsubclass as (\n    select * from \"KNSUnifiedMDM\".\"prod\".\"stg_mdm_products__Subclass\"\n),\n\nfinal as (\n    select \n        null as Code,\n        c.CatalogId,\n        sc.SubclassId,\n        s.Vendor,\n        s.VendorSku,\n        s.Season,\n        s.CaseQuantity,\n        s.Name,\n        case \n            when s.Gender = '' then null \n            else s.Gender \n        end as Gender,\n        s.SeasonBudget\n    from styles s\n    left join catalog c\n    on s.Brand = c.Name\n    left join subclass sc\n    on s.MerchandiseSubclass = sc.Name\n    where s.Name is not null\n        and s.Name != ''\n)\n\nselect * from final", "relation_name": "\"KNSUnifiedMDM\".\"Products\".\"Style\""}], "elapsed_time": 0.46873950958251953, "args": {"empty_catalog": false, "log_level": "info", "partial_parse_file_diff": true, "defer": false, "vars": {}, "show_resource_report": false, "favor_state": false, "partial_parse": true, "introspect": true, "log_format_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "cache_selected_only": false, "strict_mode": false, "write_json": true, "compile": true, "log_level_file": "debug", "static": false, "use_colors_file": true, "invocation_command": "dbt docs generate --profiles-dir C:/dbt", "which": "generate", "send_anonymous_usage_stats": true, "exclude": [], "enable_legacy_logger": false, "require_explicit_package_overrides_for_builtin_materializations": true, "select": [], "log_file_max_bytes": 10485760, "version_check": true, "use_colors": true, "printer_width": 80, "log_path": "C:\\actions-runner\\_work\\DataTransform\\DataTransform\\MDM\\logs", "require_resource_names_without_spaces": false, "project_dir": "C:\\actions-runner\\_work\\DataTransform\\DataTransform\\MDM", "quiet": false, "profiles_dir": "C:/dbt", "static_parser": true, "indirect_selection": "eager", "print": true, "source_freshness_run_project_hooks": false, "log_format": "default", "populate_cache": true, "macro_debugging": false}}