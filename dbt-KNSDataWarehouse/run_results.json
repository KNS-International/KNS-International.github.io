{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2025-09-07T10:28:16.894540Z", "invocation_id": "5c9f3d99-8bd0-46a5-912e-35c4aa98406c", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:14.972664Z", "completed_at": "2025-09-07T10:28:14.988272Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:14.988272Z", "completed_at": "2025-09-07T10:28:14.988272Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015607833862304688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_dbo__Calendar", "compiled": true, "compiled_code": "with\n\ncalendar as (\n\n    select\n        *\n    from \"KNSDataLake\".\"dbo\".\"calendar\"\n)\n\nselect * from calendar;", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_dbo__Calendar\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.003894Z", "completed_at": "2025-09-07T10:28:15.003894Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.003894Z", "completed_at": "2025-09-07T10:28:15.003894Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01562190055847168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_deposco__CoHeader", "compiled": true, "compiled_code": "with \n\nsource as (\n    \n    select * from \"KNSDataLake\".\"deposco\".\"co_header\"\n\n),\n\ncleaned as (\n\n    select\n        cast(CO_HEADER_ID as bigint) as CoHeaderId,\n        cast(STATUS as varchar(50)) as Status\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__CoHeader\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.003894Z", "completed_at": "2025-09-07T10:28:15.019521Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.019521Z", "completed_at": "2025-09-07T10:28:15.019521Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015627145767211914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_deposco__CoLine", "compiled": true, "compiled_code": "with \n\nsource as (\n    \n    select * from \"KNSDataLake\".\"deposco\".\"co_line\"\n\n),\n\ncleaned as (\n\n    select\n        cast(CO_LINE_ID as bigint) as CoLineId,\n        cast(UPDATED_DATE as datetime) as UpdatedDate,\n        cast(STATUS as varchar(50)) as Status\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__CoLine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.019521Z", "completed_at": "2025-09-07T10:28:15.019521Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.019521Z", "completed_at": "2025-09-07T10:28:15.019521Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_deposco__Item", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n        select * from \"KNSDataLake\".\"deposco\".\"item\"\n\n),\n\ncleaned as (\n\n    select \n        cast(ITEM_ID as bigint) as ItemId,\n        cast(INTANGIBLE_ITEM_FLAG as bit) as IntangibleItemFlag,\n        cast(CLASS_TYPE as nvarchar(30)) as ClassType,\n        cast(STYLE_NUMBER as varchar(100)) as StyleNumber,\n        cast(COLOR_NAME as varchar(150)) as ColorName,\n        cast(NAME as varchar(250)) as Name,\n        cast([NUMBER] as varchar(200)) as [Number],\n        cast(UPDATED_DATE as datetime) as UpdatedDate\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__Item\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.019521Z", "completed_at": "2025-09-07T10:28:15.035144Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.035144Z", "completed_at": "2025-09-07T10:28:15.035144Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015623807907104492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_deposco__Location", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n        select * from \"KNSDataLake\".\"deposco\".\"location\"\n\n),\n\ncleaned as (\n\n    select \n        cast(LOCATION_ID as bigint) as LocationId\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__Location\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.035144Z", "completed_at": "2025-09-07T10:28:15.035144Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.035144Z", "completed_at": "2025-09-07T10:28:15.035144Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_deposco__LocationZones", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n        select * from \"KNSDataLake\".\"deposco\".\"location_zones\"\n\n),\n\ncleaned as (\n\n    select \n        cast(LOCATION_ID as bigint) as LocationId\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__LocationZones\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.050771Z", "completed_at": "2025-09-07T10:28:15.050771Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.050771Z", "completed_at": "2025-09-07T10:28:15.050771Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_deposco__OrderHeader", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n    select * from \"KNSDataLake\".\"deposco\".\"order_header\"\n\n),\n\ncleaned as (\n\n    select\n        cast(ORDER_HEADER_ID as bigint) as OrderHeaderId,\n        cast(CURRENT_STATUS as varchar(50)) as CurrentStatus,\n        cast(TYPE as varchar(50)) as Type,\n        cast(CREATED_DATE as date) as CreatedDate,\n        cast(SHIPPING_STATUS as int) as ShippingStatus,\n        cast(CONSIGNEE_PARTNER_ID as bigint) as ConsigneePartnerId,\n        cast(SELLER as varchar(50)) as Seller,\n        cast(PARENT_ORDER_ID as bigint) as ParentOrderId,\n        cast(ORDER_SOURCE as varchar(100)) as OrderSource,\n        cast(CUSTOMER_ORDER_NUMBER as varchar(50)) as CustomerOrderNumber,\n        cast(UPDATED_DATE as datetime) as UpdatedDate,\n        cast(KNS_MT_PLACED_DATE as datetime) as KnsMtPlacedDate,\n        cast(KNS_MT_CREATED_DATE as datetime) as KnsMtCreatedDate,\n        cast(KNS_MT_PLANNED_RELEASE_DATE as\tdatetime) as KnsMtPlannedReleaseDate,\n        cast(KNS_MT_PLANNED_SHIP_DATE as datetime) as KnsMtPlannedShipDate,\n        cast(KNS_MT_ACTUAL_SHIP_DATE as\tdatetime) as KnsMtActualShipDate,\n        cast(KNS_MT_ACTUAL_RELEASE_DATE as datetime) as KnsMtActualReleaseDate,\n        cast(SHIP_VENDOR as varchar(50)) as ShipVendor,\n        cast(CO_HEADER_ID as bigint) as CoHeaderId,\n        cast(\n        case \n            when CUSTOM_ATTRIBUTE1 = 'Express' then 1 \n            else 0\n        end \n        as bit) as IsExpress\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderHeader\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.066399Z", "completed_at": "2025-09-07T10:28:15.066399Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.066399Z", "completed_at": "2025-09-07T10:28:15.066399Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015628576278686523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_deposco__OrderLine", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n    select * from \"KNSDataLake\".\"deposco\".\"order_line\"\n\n),\n\ncleaned as (\n\n    select\n        cast(ORDER_LINE_ID as bigint) as OrderLineId,\n        cast(PACK_ID as bigint) as PackId,\n        cast(ORDER_HEADER_ID as bigint) as OrderHeaderId,\n        cast(ITEM_ID as bigint) as ItemId,\n        cast(ORDER_PACK_QUANTITY as float) as OrderPackQuantity,\n        cast(ORDER_LINE_STATUS as varchar(50)) as OrderLineStatus,\n        cast(CO_LINE_ID as bigint) as CoLineId,\n        cast(SHIPPED_PACK_QUANTITY as float) as ShippedPackQuantity,\n        cast(UNIT_COST as float) as UnitCost,\n        cast(UPDATED_DATE as datetime) as UpdatedDate,\n        cast(CUSTOMER_LINE_NUMBER as varchar(100)) as CustomerLineNumber,\n        cast(RECEIVED_PACK_QUANTITY as float) as ReceivedPackQuantity\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderLine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.066399Z", "completed_at": "2025-09-07T10:28:15.082023Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.082023Z", "completed_at": "2025-09-07T10:28:15.082023Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01562356948852539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_deposco__Pack", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n        select * from \"KNSDataLake\".\"deposco\".\"pack\"\n\n),\n\ncleaned as (\n\n    select \n        cast(PACK_ID as bigint) as PackId,\n        cast(QUANTITY as int) as Quantity\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__Pack\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.082023Z", "completed_at": "2025-09-07T10:28:15.082023Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.082023Z", "completed_at": "2025-09-07T10:28:15.082023Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_deposco__PriceList", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n        select * from \"KNSDevSandbox\".\"Dev\".\"price_list\"\n\n),\n\ncleaned as (\n\n    select \n        cast(PRICE_LIST_ID as bigint) as PriceListId,\n        cast(TRADING_PARTNER_ID as bigint) as TradingPartnerId\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__PriceList\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.082023Z", "completed_at": "2025-09-07T10:28:15.097647Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.097647Z", "completed_at": "2025-09-07T10:28:15.097647Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624284744262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_deposco__PriceListDetail", "compiled": true, "compiled_code": "\n\n\nwith\n\nsource as (\n    \n        select * from \"KNSDataLake\".\"deposco\".\"price_list_detail\"\n\n),\n\ncleaned as (\n\n    select \n        cast(PRICE_LIST_DETAIL_ID as bigint) as PriceListDetailId,\n        cast(PRICE_LIST_ID as bigint) as PriceListId,\n        cast(ITEM_ID as bigint) as ItemId,\n        cast(SALES_PRICE as float) as SalesPrice,\n        cast(SALES_EFFECTIVE_START as datetime) as SalesEffectiveStart,\n        cast(SALES_EFFECTIVE_END as datetime) as SalesEffectiveEnd\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__PriceListDetail\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.097647Z", "completed_at": "2025-09-07T10:28:15.097647Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.097647Z", "completed_at": "2025-09-07T10:28:15.097647Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_deposco__ReceiptLine", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n        select * from \"KNSDataLake\".\"deposco\".\"receipt_line\"\n\n),\n\ncleaned as (\n\n    select \n        cast(ORDER_LINE_ID as bigint) as OrderLineId,\n        cast(RECEIVED_PACK_QUANTITY as int) as ReceivedPackQuantity\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__ReceiptLine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.113272Z", "completed_at": "2025-09-07T10:28:15.113272Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.113272Z", "completed_at": "2025-09-07T10:28:15.113272Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624523162841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_deposco__Shipment", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n        select * from \"KNSDataLake\".\"deposco\".\"shipment\"\n\n),\n\ncleaned as (\n\n    select \n        cast(SHIPMENT_ID as bigint) as ShipmentId,\n        cast(FREIGHT_TERMS_TYPE as varchar(50)) as FreightTermsType,\n        cast(SHIPPING_COST as float) as ShippingCost\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__Shipment\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.113272Z", "completed_at": "2025-09-07T10:28:15.113272Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.113272Z", "completed_at": "2025-09-07T10:28:15.113272Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_deposco__ShipmentLine", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n        select * from \"KNSDataLake\".\"deposco\".\"shipment_line\"\n\n),\n\ncleaned as (\n\n    select \n        cast(SHIPMENT_ID as bigint) as ShipmentId,\n        cast(SHIPPED_PACK_QUANTITY as float) as ShippedPackQuantity\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__ShipmentLine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.128897Z", "completed_at": "2025-09-07T10:28:15.128897Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.128897Z", "completed_at": "2025-09-07T10:28:15.128897Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_deposco__ShipmentOrderHeader", "compiled": true, "compiled_code": "with\n\nsource as (\n    \n        select * from \"KNSDataLake\".\"deposco\".\"shipment_order_header\"\n\n),\n\ncleaned as (\n\n    select \n        cast(ORDER_HEADER_ID as bigint) as OrderHeaderId,\n        cast(SHIPMENT_ID as bigint) as ShipmentId\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__ShipmentOrderHeader\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.128897Z", "completed_at": "2025-09-07T10:28:15.144522Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.144522Z", "completed_at": "2025-09-07T10:28:15.144522Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624761581420898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_deposco__StockUnit", "compiled": true, "compiled_code": "with \n\nsource as (\n    \n    select * from \"KNSDataLake\".\"deposco\".\"stock_unit\"\n\n),\n\ncleaned as (\n\n    select\n        cast(ITEM_ID as bigint) as ItemId,\n        cast(PACK_ID as bigint) as PackId,\n        cast(QUANTITY as int) as Quantity,\n        cast(PeriodStart as date) as PeriodStart,\n        cast(PeriodEnd as date) as PeriodEnd,\n        cast(LOCATION_ID as bigint) as LocationId\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__StockUnit\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.144522Z", "completed_at": "2025-09-07T10:28:15.144522Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.144522Z", "completed_at": "2025-09-07T10:28:15.144522Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_deposco__StockUnitAuditHistory", "compiled": true, "compiled_code": "with \n\nsource as (\n    \n    select * from \"KNSDataLake\".\"deposco\".\"STOCK_UNIT_AUDIT_HISTORY\"\n\n),\n\ncleaned as (\n\n    select\n        cast(ITEM_ID as bigint) as ItemId,\n        cast(PACK_ID as bigint) as PackId,\n        cast(QUANTITY as int) as Quantity,\n        cast(PeriodStart as date) as PeriodStart,\n        cast(PeriodEnd as date) as PeriodEnd,\n        cast(LOCATION_ID as bigint) as LocationId\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__StockUnitAuditHistory\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.160144Z", "completed_at": "2025-09-07T10:28:15.160144Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.160144Z", "completed_at": "2025-09-07T10:28:15.160144Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015622377395629883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_deposco__TradingPartner", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"deposco\".\"trading_partner\"\n\n),\n\ncleaned as (\n\n    select\n         cast(TRADING_PARTNER_ID as bigint) as TradingPartnerId,\n         cast(CODE as varchar(40)) as Code,\n         cast(NAME as varchar(50)) as Name,\n         cast(BILL_TO_COUNTRY as varchar(100)) as BillToCountry,\n         cast(CONTACT_EMAIL as varchar(50)) as IsReturnsPartner,\n         cast(TAX_RATE as float) as TaxRate,\n         cast(UPS_ACCOUNT_NUMBER as varchar(100)) as UpsAccountNumber\n    from source\n\n)\n\nselect * from cleaned;", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__TradingPartner\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.160144Z", "completed_at": "2025-09-07T10:28:15.160144Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.160144Z", "completed_at": "2025-09-07T10:28:15.160144Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_kns__FreightForwarder_AirAndSea", "compiled": true, "compiled_code": "with \n\nsource as (\n    \n    select * from \"KNSDataLake\".\"kns\".\"FreightForwarder_AirAndSea\"\n\n),\n\ncleaned as (\n\n    select\n\t\tcast(SUBSTRING(trim(c.value),0,CHARINDEX(' ',trim(c.value),0)) as varchar(100)) as Number,\n\t\t'AirAndSea' as FreightForwarder,\n\t\tcast([Load ETD] as date) as VesselLoadedAt,\n        case \n            when [Last Sea Leg ATA] = '' then null\n            else cast([Last Sea Leg ATA] as date)\n        end as EstimatedUSPortAt,\n        case\n            when [First Rail Leg ETD] = '' then null\n            else cast([First Rail Leg ETD] as date)\n\t\tend as EstimatedUSStartShipAt,\n\t\tcast(dateadd(day, iif(s.[Disch.] = 'USSLC', 2, 5), nullif(s.[Disch. ETA], '')) as date) as EstimatedArrivalAt\n\tfrom source s\n\tcross apply STRING_SPLIT([Container #], ',') c\n\twhere trim(c.value) != ''\n\tand trim(c.value) not like '(%'\n    and [Container #] is not null\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_AirAndSea\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.175772Z", "completed_at": "2025-09-07T10:28:15.175772Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.175772Z", "completed_at": "2025-09-07T10:28:15.175772Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_kns__FreightForwarder_DSV", "compiled": true, "compiled_code": "with \n\nsource as (\n    \n        select * from \"KNSDataLake\".\"kns\".\"FreightForwarder_DSV\"\n\n),\n\ncleaned as (\n\n        select\n            cast(ContainerNumber as varchar(100)) as [Number],\n            'DSV' as FreightForwarder,\n            cast(max(iif(EventCode='FLO', EventDate, null)) as date) as VesselLoadedAt,\n            cast(coalesce(\n                max(iif(EventCode='ARV', EventDate, null)),\n                max(iif(EventCode='ETA', EventDate, null))\n            ) as date) as EstimatedUSPortAt,\n            cast(null as date) as EstimatedUSStartShipAt,\n            cast(max(iif(EventCode='ESTIMATED_DELIVERY', EventDate, null)) as date) as EstimatedArrivalAt\n        from source\n        where ContainerNumber is not null\n            and ContainerNumber != ''\n        group by ContainerNumber\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_DSV\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.175772Z", "completed_at": "2025-09-07T10:28:15.191396Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.191396Z", "completed_at": "2025-09-07T10:28:15.191396Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624046325683594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_kns__FreightForwarder_SFI", "compiled": true, "compiled_code": "with \n\nsource as (\n    \n    select * from \"KNSDataLake\".\"kns\".\"FreightForwarder_SFI\"\n\n),\n\ncleaned as (\n\n    select\n        cast([Container No.] as varchar(100)) as [Number],\n        'SFI' as FreightForwarder,\n        cast(null as date) as VesselLoadedAt,\n        cast(coalesce(ATA, ETA) as date) as EstimatedUSPortAt,\n        cast(dateadd(day, -7, [Place of Delivery ETA]) as date) as EstimatedUSStartShipAt,\n        cast(dateadd(day, 4, [Place of Delivery ETA]) as date) as EstimatedArrivalAt\n    from source\n    where [Container No.] is not null\n    and [Container No.] != ''\n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_SFI\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.191396Z", "completed_at": "2025-09-07T10:28:15.191396Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.191396Z", "completed_at": "2025-09-07T10:28:15.191396Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_kns__HistoricalDimItem", "compiled": true, "compiled_code": "with \n\nsource as (\n    \n    select * from \"KNSDevSandbox\".\"Dev\".\"HistoricalDimItem\"\n\n),\n\ncleaned as (\n\n    select\n        cast(ItemId as int) as ItemId,\n        cast(Category as nvarchar(200)) as Category,\n        cast(Subcategory as nvarchar(200)) as Subcategory,\n        cast(FirstReceivedDate as date) as FirstReceivedDate,\n        cast(CloseOut as nvarchar(8)) as CloseOut,\n        cast(CloseOutDate as date) as CloseOutDate,\n        cast(ToeStyle as nvarchar(50)) as ToeStyle,\n        cast(HeelType as nvarchar(50)) as HeelType,\n        cast(LiquidationCloseOut as bit) as LiquidationCloseOut,\n        cast(SoftCloseOut as bit) as SoftCloseOut,\n        cast(MasterCategory as nvarchar(200)) as MasterCategory\n    from source\n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__HistoricalDimItem\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.207021Z", "completed_at": "2025-09-07T10:28:15.207021Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.207021Z", "completed_at": "2025-09-07T10:28:15.207021Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625476837158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_kns__InventoryValuation", "compiled": true, "compiled_code": "with \n\nsource as (\n    \n    select * from \"KNSDataLake\".\"kns\".\"InventoryValuation\"\n\n),\n\ncleaned as (\n\n    select\n        cast(Date as date) as Date,\n        cast(ItemId as int) as ItemId,\n        cast(ItemNumber as nvarchar(128)) as ItemNumber,\n        cast(Valuation as decimal(19,4)) as Valuation,\n        cast(Quantity as int) as Quantity\n    from source\n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__InventoryValuation\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.207021Z", "completed_at": "2025-09-07T10:28:15.222647Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.222647Z", "completed_at": "2025-09-07T10:28:15.222647Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625476837158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_kns__POMasterFile", "compiled": true, "compiled_code": "with \n\nsource as (\n    \n    select * from \"KNSDataLake\".\"kns\".\"POMasterFile\"\n\n),\n\ncleaned as (\n\n    select\n        ContainerNumber as [Number],\n        'UnknownFromMaster' as FreightForwarder,\n        cast(null as date) as VesselLoadedAt,\n        cast(null as date) as EstimatedUSPortAt,\n        cast(null as date) as EstimatedUSStartShipAt,\n        cast(null as date) as EstimatedArrivalAt,\n        cast(PONumber as nvarchar(128)) as PONumber,\n        cast(Color as nvarchar(128)) as Color,\n        cast(Parent as nvarchar(128)) as Parent\n    from source \n    where ContainerNumber is not null\n    and ContainerNumber != ''\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__POMasterFile\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.222647Z", "completed_at": "2025-09-07T10:28:15.222647Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.222647Z", "completed_at": "2025-09-07T10:28:15.222647Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_marketing__CampaignMap", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"marketing\".\"CampaignTradingPartnerMap\"\n\n),\n\ncleaned as (\n\n    select \n        cast(CampaignName as nvarchar(128)) as OldCampaignName,\n        cast(NewCampaignName as nvarchar(128)) as NewCampaignName\n    from source \n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_marketing__CampaignMap\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.238274Z", "completed_at": "2025-09-07T10:28:15.238274Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.238274Z", "completed_at": "2025-09-07T10:28:15.238274Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015627622604370117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_marketing__CoOpCampaign", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"marketing\".\"CoOpCampaign\"\n\n),\n\ncleaned as (\n\n    select \n        cast(FrontCode as nvarchar(50)) as FrontCode,\n        cast(BackCode as nvarchar(50)) as BackCode,\n        cast(Spend as decimal(19, 4)) as Spend,\n        cast(StartAt as date) as StartAt,\n        cast(EndAt as date) as EndAt\n    from source\n\n)\n\nselect * from cleaned;", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_marketing__CoOpCampaign\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.238274Z", "completed_at": "2025-09-07T10:28:15.238274Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.238274Z", "completed_at": "2025-09-07T10:28:15.238274Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_marketing__Criteo", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"marketing\".\"Criteo\"\n\n),\n\ncleaned as (\n\n    select \n        cast(date as date) as date,\n        cast(campaignName as nvarchar(128)) as campaignName,\n        cast(retailerName as nvarchar(128)) as retailerName,\n        cast(spend as decimal(19, 4)) as spend,\n        cast(attributedSales as decimal(19, 4)) as attributedSales,\n        cast(attributedUnits as decimal(19, 4)) as attributedUnits,\n        cast(ctr as decimal(19, 4)) as ctr,\n        cast(impressions as decimal(19, 4)) as impressions\n    from source \n    where \n    date >= dateadd(year, -2, getdate())\n\n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_marketing__Criteo\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.253899Z", "completed_at": "2025-09-07T10:28:15.253899Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.253899Z", "completed_at": "2025-09-07T10:28:15.253899Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_marketing__Northbeam", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"marketing\".\"Northbeam\"\n\n),\n\ncleaned as (\n\n    select \n        cast(date as date) as date,\n        cast(breakdown_platform_northbeam as nvarchar(256)) as breakdown_platform_northbeam,\n        cast(breakdown_category_northbeam as nvarchar(256)) as breakdown_category_northbeam,\n        cast(campaign_name as nvarchar(256)) as campaign_name,\n        cast(adset_name as nvarchar(256)) as adset_name,\n        cast(ad_name as nvarchar(256)) as ad_name,    \n        cast(attribution_model as nvarchar(256)) as attribution_model,\n        cast(attribution_window as nvarchar(256)) as attribution_window,\n        cast(ctr as decimal(19, 4)) as ctr,\n        cast(imprs as decimal(19, 4)) as imprs,\n        cast(attributed_rev as decimal(19, 4)) as attributed_rev,\n        cast(spend as decimal(19, 4)) as spend,\n        cast(visits as decimal(19, 4)) as visits,\n        cast(Instance as varchar(32)) as Instance\n    from source\n    where \n    date >= dateadd(year, -2, getdate())\n\n)\n\nselect * from cleaned;", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_marketing__Northbeam\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.253899Z", "completed_at": "2025-09-07T10:28:15.269522Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.269522Z", "completed_at": "2025-09-07T10:28:15.269522Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015622377395629883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_marketing__PromoteIq", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"marketing\".\"PromoteIQ\"\n\n),\n\ncleaned as (\n\n    select \n        cast(Date as date) as Date,\n        cast([Campaign Name] as nvarchar(128)) as [Campaign Name],\n        cast([Vendor Name] as nvarchar(128)) as [Vendor Name],\n        cast(CTR as decimal(19, 4)) as CTR,\n        cast(Impressions as decimal(19, 4)) as Impressions,\n        cast([Total Sales] as decimal(19, 4)) as [Total Sales],\n        cast([Units Sold] as decimal(19, 4)) as [Units Sold],\n        cast(Spend as decimal(19, 4)) as Spend\n    from source\n    where \n    Date >= dateadd(year, -2, getdate())\n\n\n)\n\nselect * from cleaned;", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_marketing__PromoteIq\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.269522Z", "completed_at": "2025-09-07T10:28:15.269522Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.269522Z", "completed_at": "2025-09-07T10:28:15.269522Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_marketing__Roundel", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"marketing\".\"Roundel\"\n\n),\n\ncleaned as (\n\n    select \n        cast(event_day as date) as date,\n        cast(campaign_name as nvarchar(128)) as campaignName,\n        cast(adjusted_actualized_spend as decimal(19, 4)) as spend,\n        cast(total_sales as decimal(19, 4)) as attributedSales,\n        cast(total_units as decimal(19, 4)) as attributedUnits,\n        cast(clicks as decimal(19, 4)) as clicks,\n        cast(impressions as decimal(19, 4)) as impressions\n    from source \n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_marketing__Roundel\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.269522Z", "completed_at": "2025-09-07T10:28:15.285147Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.285147Z", "completed_at": "2025-09-07T10:28:15.285147Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_marketing__Symbiosys", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"marketing\".\"Symbiosys\"\n\n),\n\ncleaned as (\n\n    select \n        cast(Day as date) as Date,\n        cast(Campaign as nvarchar(256)) as Campaign,\n        cast(Channel as nvarchar(50)) as Channel,\n        cast(Spend as decimal(19, 4)) as Spend,\n        cast([Units Sold] as decimal(19, 4)) as [Units Sold],\n        cast(Sales as decimal(19, 4)) as Sales\n    from source\n\n)\n\nselect * from cleaned;", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_marketing__Symbiosys\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.285147Z", "completed_at": "2025-09-07T10:28:15.285147Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.285147Z", "completed_at": "2025-09-07T10:28:15.285147Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_netsuite__Account", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"Account\"\n\n),\n\ncleaned as (\n\n    select \n        cast(id as bigint) as Id,\n        cast(acctnumber as nvarchar(120)) as AcctNumber\n    from source \n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Account\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.300773Z", "completed_at": "2025-09-07T10:28:15.300773Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.300773Z", "completed_at": "2025-09-07T10:28:15.300773Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_netsuite__AccountingPeriod", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"AccountingPeriod\"\n\n),\n\ncleaned as (\n\n    select \n        cast(alllocked as nvarchar(1)) as AllLocked,\n        cast(isposting as nvarchar(1)) as IsPosting,\n        cast(enddate as date) as EndDate\n    from source \n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__AccountingPeriod\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.300773Z", "completed_at": "2025-09-07T10:28:15.316399Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.316399Z", "completed_at": "2025-09-07T10:28:15.316399Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625715255737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_netsuite__CustomrecordCsegKnsBrand2024", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"CUSTOMRECORD_CSEG_KNS_BRAND_2024\"\n\n),\n\ncleaned as (\n\n    select \n        cast(id as bigint) as Id,\n        cast(name as nvarchar(100)) as Name\n    from source \n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__CustomrecordCsegKnsBrand2024\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.316399Z", "completed_at": "2025-09-07T10:28:15.316399Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.316399Z", "completed_at": "2025-09-07T10:28:15.316399Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_netsuite__CustomrecordCsegKnsProdSubcl", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"CUSTOMRECORD_CSEG_KNS_PROD_SUBCL\"\n\n),\n\ncleaned as (\n\n    select \n        cast(id as bigint) as Id,\n        cast(name as nvarchar(100)) as Name\n    from source \n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__CustomrecordCsegKnsProdSubcl\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.332023Z", "completed_at": "2025-09-07T10:28:15.332023Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.332023Z", "completed_at": "2025-09-07T10:28:15.332023Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624761581420898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_netsuite__CustomrecordCsegKnsProductcat", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"CUSTOMRECORD_CSEG_KNS_PRODUCTCAT\"\n\n),\n\ncleaned as (\n\n    select \n        cast(id as bigint) as Id,\n        cast(name as nvarchar(100)) as Name\n    from source \n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__CustomrecordCsegKnsProductcat\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.332023Z", "completed_at": "2025-09-07T10:28:15.332023Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.332023Z", "completed_at": "2025-09-07T10:28:15.332023Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_netsuite__Entity", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"entity\"\n\n),\n\ncleaned as (\n\n    select \n        cast(id as bigint) as Id,\n        cast(entityid as nvarchar(128)) as EntityId\n    from source \n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Entity\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.347646Z", "completed_at": "2025-09-07T10:28:15.347646Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.347646Z", "completed_at": "2025-09-07T10:28:15.347646Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_netsuite__InboundShipment", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"InboundShipment\"\n\n),\n\ncleaned as (\n\n    select \n        cast(id as bigint) as Id,\n        cast(vesselnumber as nvarchar(400)) as VesselNumber,\n        cast(actualdeliverydate as datetime2(7)) as ActualDeliveryDate,\n        cast(expecteddeliverydate as datetime2(7)) as ExpectedDeliveryDate,\n        cast(actualshippingdate as datetime2(7)) as ActualShippingDate,\n        cast(expectedshippingdate as datetime2(7)) as ExpectedShippingDate\n    from source \n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__InboundShipment\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.347646Z", "completed_at": "2025-09-07T10:28:15.363275Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.363275Z", "completed_at": "2025-09-07T10:28:15.363275Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015629291534423828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_netsuite__InboundShipmentItem", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"InboundShipmentItem\"\n\n),\n\ncleaned as (\n\n    select \n        cast(id as bigint) as Id,\n        cast(inboundshipment as bigint) as InboundShipmentId,\n        cast(purchaseordertransaction as bigint) as PurchaseOrderTransactionId,\n        cast(shipmentitemtransaction as bigint) as ShipmentItemTransactionId,\n        cast(quantityexpected as float) as QuantityExpected,\n        cast(quantityreceived as float) as QuantityReceived,\n        cast(quantityremaining as float) as QuantityRemaining\n    from source \n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__InboundShipmentItem\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.363275Z", "completed_at": "2025-09-07T10:28:15.363275Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.363275Z", "completed_at": "2025-09-07T10:28:15.363275Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_netsuite__Item", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"item\"\n\n),\n\ncleaned as (\n\n    select \n        cast(id as bigint) as Id,\n        cast(externalid as nvarchar(255)) as ExternalId\n    from source \n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Item\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.363275Z", "completed_at": "2025-09-07T10:28:15.379021Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.379021Z", "completed_at": "2025-09-07T10:28:15.379021Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015745878219604492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_netsuite__KnsItemCogs", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"KNS_ItemCogs\"\n\n),\n\ncleaned as (\n\n    select \n        cast(ItemId as bigint) as ItemId,\n        cast(Cost as decimal(19,4)) as Cost\n    from source \n        \n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__KnsItemCogs\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.379021Z", "completed_at": "2025-09-07T10:28:15.394526Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.394526Z", "completed_at": "2025-09-07T10:28:15.394526Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015505075454711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_netsuite__Transaction", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"transaction\"\n\n),\n\ncleaned as (\n\n    select\n        cast(id as bigint) as Id,\n        cast(custbody_kns_po as nvarchar(4000)) as Memo,\n        cast(entity as bigint) as Entity,\n        cast(trandate as date) as TranDate,\n        cast(tranid as nvarchar(90)) as TranId,\n        cast(otherrefnum as nvarchar(90)) as OtherRefNum,\n        cast(cseg_kns_brand_2024 as bigint) as CsegKnsBrand2024,\n        cast(cseg_kns_productcat as bigint) as CsegKnsProductCat,\n        cast(cseg_kns_prod_subcl as bigint) as CsegKnsProdSubcl,\n        cast(duedate as date) as DueDate,\n        cast(custbody_kns_po as nvarchar(4000)) as CustbodyKnsPo,\n        cast(custbody_kns_season_po as nvarchar(4000)) as CustbodyKnsSeasonPo,\n        cast(custbody_kns_x_factory_date as datetime2(7)) as CustbodyKnsXFactoryDate,\n        cast(custbody_knsconfirmxfact as datetime2(7)) as CustbodyKnsConfirmXFact,\n        cast(custbody_knsactualxfact as datetime2(7)) as CustbodyKnsActualXFact,\n        cast(custbody_knsestindcdate as datetime2(7)) as CustbodyKnsEstInDCDate,\n        cast(status as nvarchar(2)) as Status,\n        cast(type as nvarchar(8)) as Type\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Transaction\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.394526Z", "completed_at": "2025-09-07T10:28:15.394526Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.394526Z", "completed_at": "2025-09-07T10:28:15.394526Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_netsuite__TransactionLine", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"transactionLine\"\n\n),\n\ncleaned as (\n\n    select\n        cast(uniquekey as bigint) as UniqueKey,\n        cast([transaction] as bigint) as [Transaction],\n        cast(rate as float) as Rate,\n        cast(expenseaccount as bigint) as ExpenseAccount,\n        cast(debitforeignamount as float) as DebitForeignAmount,\n        cast(creditforeignamount as float) as CreditForeignAmount,\n        cast(memo as nvarchar(4000)) as Memo,\n        cast(entity as bigint) as Entity,\n        cast(cseg_kns_brand_2024 as bigint) as CsegKnsBrand2024,\n        cast(cseg_kns_productcat as bigint) as CsegKnsProductCat,\n        cast(cseg_kns_prod_subcl as bigint) as CsegKnsProdSubcl,\n        cast(quantity as float) as Quantity,\n        cast(item as bigint) as Item,\n        cast(netamount as float) as NetAmount,\n        cast(isclosed as nvarchar(2)) as IsClosed,\n        cast(quantityshiprecv as float) as QuantityShipRecv,\n        cast(createdfrom as bigint) as CreatedFrom,\n        cast(quantityonshipments as float) as QuantityOnShipments\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__TransactionLine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.394526Z", "completed_at": "2025-09-07T10:28:15.410151Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.410151Z", "completed_at": "2025-09-07T10:28:15.410151Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0156252384185791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_netsuite__TransactionStatus", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"netsuite\".\"transactionStatus\"\n\n),\n\ncleaned as (\n\n    select\n        cast(name as nvarchar(128)) as Name,\n        cast(id as nvarchar(1)) as Id,\n        cast(trantype as nvarchar(32)) as TranType\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__TransactionStatus\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.410151Z", "completed_at": "2025-09-07T10:28:15.410151Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.410151Z", "completed_at": "2025-09-07T10:28:15.410151Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_orders__BudgetForecast", "compiled": true, "compiled_code": "select * from \"KNSUnifiedMDM\".\"Orders\".\"BudgetForecast\"", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__BudgetForecast\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.425773Z", "completed_at": "2025-09-07T10:28:15.425773Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.425773Z", "completed_at": "2025-09-07T10:28:15.425773Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_orders__SalesOrder", "compiled": true, "compiled_code": "select * from \"KNSUnifiedMDM\".\"Orders\".\"SalesOrder\"", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__SalesOrder\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.425773Z", "completed_at": "2025-09-07T10:28:15.425773Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.441399Z", "completed_at": "2025-09-07T10:28:15.441399Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015626192092895508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_orders__SalesOrderLine", "compiled": true, "compiled_code": "select * from \"KNSUnifiedMDM\".\"Orders\".\"SalesOrderLine\"", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__SalesOrderLine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.441399Z", "completed_at": "2025-09-07T10:28:15.441399Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.441399Z", "completed_at": "2025-09-07T10:28:15.441399Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_orders__TradingPartner", "compiled": true, "compiled_code": "select * from \"KNSUnifiedMDM\".\"Orders\".\"TradingPartner\"", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__TradingPartner\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.441399Z", "completed_at": "2025-09-07T10:28:15.457027Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.457027Z", "completed_at": "2025-09-07T10:28:15.457027Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015628337860107422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_orders__TradingPartnerHandlingFee", "compiled": true, "compiled_code": "select * from \"KNSUnifiedMDM\".\"Orders\".\"TradingPartnerHandlingFee\"", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__TradingPartnerHandlingFee\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.457027Z", "completed_at": "2025-09-07T10:28:15.457027Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.457027Z", "completed_at": "2025-09-07T10:28:15.457027Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_products__Brand", "compiled": true, "compiled_code": "select * from \"KNSUnifiedMDM\".\"Products\".\"Brand\"", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_products__Brand\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.472652Z", "completed_at": "2025-09-07T10:28:15.472652Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.472652Z", "completed_at": "2025-09-07T10:28:15.472652Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624284744262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_products__Catalog", "compiled": true, "compiled_code": "select * from \"KNSUnifiedMDM\".\"Products\".\"Catalog\"", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_products__Catalog\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.472652Z", "completed_at": "2025-09-07T10:28:15.472652Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.488276Z", "completed_at": "2025-09-07T10:28:15.488276Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624523162841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_products__Size", "compiled": true, "compiled_code": "select * from \"KNSUnifiedMDM\".\"Products\".\"Size\"", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_products__Size\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.488276Z", "completed_at": "2025-09-07T10:28:15.488276Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.488276Z", "completed_at": "2025-09-07T10:28:15.488276Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_products__Style", "compiled": true, "compiled_code": "select * from \"KNSUnifiedMDM\".\"Products\".\"Style\"", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_products__Style\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.488276Z", "completed_at": "2025-09-07T10:28:15.503902Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.503902Z", "completed_at": "2025-09-07T10:28:15.503902Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0156252384185791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_products__Subclass", "compiled": true, "compiled_code": "select * from \"KNSUnifiedMDM\".\"Products\".\"Subclass\"", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_products__Subclass\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.503902Z", "completed_at": "2025-09-07T10:28:15.503902Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.503902Z", "completed_at": "2025-09-07T10:28:15.503902Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_products__Variant", "compiled": true, "compiled_code": "select * from \"KNSUnifiedMDM\".\"Products\".\"Variant\"", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_products__Variant\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.503902Z", "completed_at": "2025-09-07T10:28:15.519526Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.519526Z", "completed_at": "2025-09-07T10:28:15.519526Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.stg_salsify__Product", "compiled": true, "compiled_code": "with\n\nsource as (\n\n    select * from \"KNSDataLake\".\"salsify\".\"Product\"\n\n),\n\ncleaned as (\n\n    select \n        cast([Main SKU] as nvarchar(128)) as MainSku,\n        cast([Sub Category] as nvarchar(128)) as SubCategory,\n        cast([Merchandise Subclass] as nvarchar(128)) as MerchandiseSubclass,\n        cast([Color Class] as nvarchar(128)) as ColorClass,\n        cast(Color as nvarchar(128)) as Color,\n        cast(Brand as nvarchar(128)) as Brand,\n        cast(Gender as nvarchar(128)) as Gender,\n        cast(Size as nvarchar(128)) as Size,\n        cast(Seasonality as nvarchar(128)) as Seasonality,\n        cast([Size Run] as nvarchar(128)) as SizeRun,\n        cast(Vendor as nvarchar(128)) as Vendor,\n        cast([Vendor SKU] as nvarchar(128)) as VendorSku,\n        cast([Sell Out Target Date Month] as nvarchar(128)) as SellOutTargetDateMonth,\n        cast([Sell Out Target Date Year] as nvarchar(128)) as SellOutTargetDateYear,\n        cast([Planned Arrival Date Month] as nvarchar(128)) as PlannedArrivalDateMonth,\n        cast([First Sales Date] as nvarchar(128)) as FirstSalesDate,\n        cast(Status as nvarchar(128)) as Status,\n        cast([Closure Type] as nvarchar(128)) as ClosureType,\n        cast([Style Type] as nvarchar(128)) as StyleType,\n        cast(Style as nvarchar(128)) as Style,\n        cast([Parent SKU] as nvarchar(128)) as ParentSku,\n        cast([Calf Width] as nvarchar(128)) as CalfWidth,\n        cast([Shoe Width] as nvarchar(128)) as ShoeWidth,\n        cast([Anaplan Active] as bit) as AnaplanActive,\n        cast([Case Quantity] as int) as CaseQuantity,\n        cast(MSRP as decimal(19, 4)) as Msrp,\n        cast(Division as nvarchar(32)) as Division,\n        cast([Season Budget] as nvarchar(16)) as SeasonBudget,\n        cast([Selling Status] as nvarchar(32)) as SellingStatus\n    from source\n\n)\n\nselect * from cleaned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_staging\".\"stg_salsify__Product\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.519526Z", "completed_at": "2025-09-07T10:28:15.519526Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.519526Z", "completed_at": "2025-09-07T10:28:15.519526Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.kns_dbt.seed_Brands", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.519526Z", "completed_at": "2025-09-07T10:28:15.519526Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.519526Z", "completed_at": "2025-09-07T10:28:15.519526Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.kns_dbt.seed_SizeRun", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.535151Z", "completed_at": "2025-09-07T10:28:15.550778Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.550778Z", "completed_at": "2025-09-07T10:28:15.550778Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015626907348632812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.source_not_null_marketing_Criteo_date.3ff2cfd089", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date\nfrom \"KNSDataLake\".\"marketing\".\"Criteo\"\nwhere date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.550778Z", "completed_at": "2025-09-07T10:28:15.550778Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.550778Z", "completed_at": "2025-09-07T10:28:15.550778Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.int_sales__CurrentStock", "compiled": true, "compiled_code": "with\n\nday_start as (\n    select \n        convert(datetime, convert(date, sysdatetimeoffset() at time zone 'mountain standard time')) \n        at time zone 'mountain standard time' \n        at time zone 'utc' as day_start\n),\n\norder_header as (\n    select \n        OrderHeaderId,\n        ShippingStatus,\n        CurrentStatus,\n        CreatedDate,\n        Type\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderHeader\"\n),\n\norder_line as (\n    select \n        OrderLineId,\n        OrderHeaderId,\n        ItemId,\n        PackId,\n        OrderPackQuantity\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderLine\"\n),\n\npack as (\n    select \n        PackId,\n        Quantity\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__Pack\"\n),\n\nitem as (\n    select \n        ItemId,\n        IntangibleItemFlag,\n        ClassType\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__Item\"\n),\n\nordered as (\n    select\n        ol.ItemId,\n        coalesce(sum(ol.OrderPackQuantity * p.Quantity), 0) as TotalOrdered\n    from order_line ol\n    join pack p on ol.PackId = p.PackId\n    join order_header oh on ol.OrderHeaderId = oh.OrderHeaderId\n    where oh.ShippingStatus != 20\n        and oh.CurrentStatus not in ('Hold', 'Canceled', 'Voided')\n        and oh.CreatedDate >= dateadd(year, -1, \n        cast(sysdatetimeoffset() at time zone 'mountain standard time' as datetime))\n        and oh.Type = 'Sales Order'\n    group by ol.ItemId\n),\n\nstock_unit_unioned as (\n    select * from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__StockUnit\"\n    union all\n    select * from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__StockUnitAuditHistory\"\n),\n\ncurrent_stock as (\n    select\n        i.ItemId,\n        coalesce(sum(s.Quantity * p.Quantity), 0) as Quantity,\n        case \n            when coalesce(sum(s.Quantity * p.Quantity), 0) - coalesce(o.TotalOrdered, 0) < 0\n                then 0\n            else coalesce(sum(s.Quantity * p.Quantity), 0) - coalesce(o.TotalOrdered, 0)\n        end as AvailableQuantity\n    from item i\n    cross join day_start ds\n    left join stock_unit_unioned s on s.ItemId = i.ItemId\n       and s.PeriodStart <= ds.day_start\n       and s.PeriodEnd   >= ds.day_start\n    left join pack p on s.PackId = p.PackId\n    left join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__Location\" l on s.LocationId = l.LocationId\n    left join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__LocationZones\" lz on l.LocationId = lz.LocationId\n    left join ordered o on o.ItemId = i.ItemId\n    where i.IntangibleItemFlag != 1\n      and coalesce(i.ClassType, '') != 'Supplies'\n    group by i.ItemId, o.TotalOrdered\n)\n\nselect * from current_stock", "relation_name": "\"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__CurrentStock\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.566404Z", "completed_at": "2025-09-07T10:28:15.628905Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.628905Z", "completed_at": "2025-09-07T10:28:15.628905Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06250143051147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_kns__FreightForwarder_AirAndSea_EstimatedArrivalAt__date.0150e15b41", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('NUMBER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('FREIGHTFORWARDER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('VESSELLOADEDAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSPORTAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSSTARTSHIPAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDARRIVALAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'ESTIMATEDARRIVALAT'\n            and\n            relation_column_type not in ('DATE')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.628905Z", "completed_at": "2025-09-07T10:28:15.675777Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.675777Z", "completed_at": "2025-09-07T10:28:15.675777Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.046871185302734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_kns__FreightForwarder_AirAndSea_EstimatedUSPortAt__date.b8bfa69e4d", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('NUMBER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('FREIGHTFORWARDER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('VESSELLOADEDAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSPORTAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSSTARTSHIPAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDARRIVALAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'ESTIMATEDUSPORTAT'\n            and\n            relation_column_type not in ('DATE')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.675777Z", "completed_at": "2025-09-07T10:28:15.722654Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.722654Z", "completed_at": "2025-09-07T10:28:15.722654Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04687786102294922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_kns__FreightForwarder_AirAndSea_EstimatedUSStartShipAt__date.6e7870e9ff", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('NUMBER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('FREIGHTFORWARDER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('VESSELLOADEDAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSPORTAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSSTARTSHIPAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDARRIVALAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'ESTIMATEDUSSTARTSHIPAT'\n            and\n            relation_column_type not in ('DATE')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.722654Z", "completed_at": "2025-09-07T10:28:15.753905Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.769534Z", "completed_at": "2025-09-07T10:28:15.769534Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04687952995300293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_kns__FreightForwarder_AirAndSea_VesselLoadedAt__date.cff0f287eb", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('NUMBER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('FREIGHTFORWARDER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('VESSELLOADEDAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSPORTAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSSTARTSHIPAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDARRIVALAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'VESSELLOADEDAT'\n            and\n            relation_column_type not in ('DATE')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.769534Z", "completed_at": "2025-09-07T10:28:15.769534Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.769534Z", "completed_at": "2025-09-07T10:28:15.769534Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.no_1900_dates_stg_kns__FreightForwarder_AirAndSea_EstimatedArrivalAt.8d0ff813d3", "compiled": true, "compiled_code": "\n    select *\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_AirAndSea\"\n    where EstimatedArrivalAt = '1900-01-01'\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.785155Z", "completed_at": "2025-09-07T10:28:15.785155Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.785155Z", "completed_at": "2025-09-07T10:28:15.785155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.no_1900_dates_stg_kns__FreightForwarder_AirAndSea_EstimatedUSPortAt.97dc63685d", "compiled": true, "compiled_code": "\n    select *\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_AirAndSea\"\n    where EstimatedUSPortAt = '1900-01-01'\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.785155Z", "completed_at": "2025-09-07T10:28:15.800779Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.800779Z", "completed_at": "2025-09-07T10:28:15.800779Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624761581420898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.no_1900_dates_stg_kns__FreightForwarder_AirAndSea_EstimatedUSStartShipAt.0cbd999917", "compiled": true, "compiled_code": "\n    select *\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_AirAndSea\"\n    where EstimatedUSStartShipAt = '1900-01-01'\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.800779Z", "completed_at": "2025-09-07T10:28:15.800779Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.816405Z", "completed_at": "2025-09-07T10:28:15.816405Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625715255737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.no_1900_dates_stg_kns__FreightForwarder_AirAndSea_VesselLoadedAt.aa52fbe071", "compiled": true, "compiled_code": "\n    select *\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_AirAndSea\"\n    where VesselLoadedAt = '1900-01-01'\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.816405Z", "completed_at": "2025-09-07T10:28:15.863287Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.863287Z", "completed_at": "2025-09-07T10:28:15.863287Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04688143730163574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_kns__FreightForwarder_DSV_EstimatedArrivalAt__date.a7dd1a5bbf", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('NUMBER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('FREIGHTFORWARDER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('VESSELLOADEDAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSPORTAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSSTARTSHIPAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDARRIVALAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'ESTIMATEDARRIVALAT'\n            and\n            relation_column_type not in ('DATE')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.863287Z", "completed_at": "2025-09-07T10:28:15.910162Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.910162Z", "completed_at": "2025-09-07T10:28:15.910162Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06252408027648926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_kns__FreightForwarder_DSV_EstimatedUSPortAt__date.b31b0631bd", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('NUMBER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('FREIGHTFORWARDER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('VESSELLOADEDAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSPORTAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSSTARTSHIPAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDARRIVALAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'ESTIMATEDUSPORTAT'\n            and\n            relation_column_type not in ('DATE')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.925811Z", "completed_at": "2025-09-07T10:28:15.972667Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:15.972667Z", "completed_at": "2025-09-07T10:28:15.972667Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.046855926513671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_kns__FreightForwarder_DSV_EstimatedUSStartShipAt__date.e4ec7d834b", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('NUMBER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('FREIGHTFORWARDER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('VESSELLOADEDAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSPORTAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSSTARTSHIPAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDARRIVALAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'ESTIMATEDUSSTARTSHIPAT'\n            and\n            relation_column_type not in ('DATE')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:15.972667Z", "completed_at": "2025-09-07T10:28:16.019595Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.019595Z", "completed_at": "2025-09-07T10:28:16.019595Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04692888259887695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_kns__FreightForwarder_DSV_VesselLoadedAt__date.9583e14d05", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('NUMBER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('FREIGHTFORWARDER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('VESSELLOADEDAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSPORTAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSSTARTSHIPAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDARRIVALAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'VESSELLOADEDAT'\n            and\n            relation_column_type not in ('DATE')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.019595Z", "completed_at": "2025-09-07T10:28:16.035159Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.035159Z", "completed_at": "2025-09-07T10:28:16.035159Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015563488006591797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.no_1900_dates_stg_kns__FreightForwarder_DSV_EstimatedArrivalAt.9f4faeb3fa", "compiled": true, "compiled_code": "\n    select *\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_DSV\"\n    where EstimatedArrivalAt = '1900-01-01'\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.035159Z", "completed_at": "2025-09-07T10:28:16.035159Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.035159Z", "completed_at": "2025-09-07T10:28:16.035159Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.no_1900_dates_stg_kns__FreightForwarder_DSV_EstimatedUSPortAt.e61cc59608", "compiled": true, "compiled_code": "\n    select *\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_DSV\"\n    where EstimatedUSPortAt = '1900-01-01'\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.035159Z", "completed_at": "2025-09-07T10:28:16.050783Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.050783Z", "completed_at": "2025-09-07T10:28:16.050783Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015623807907104492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.no_1900_dates_stg_kns__FreightForwarder_DSV_EstimatedUSStartShipAt.571295a306", "compiled": true, "compiled_code": "\n    select *\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_DSV\"\n    where EstimatedUSStartShipAt = '1900-01-01'\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.050783Z", "completed_at": "2025-09-07T10:28:16.066462Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.066462Z", "completed_at": "2025-09-07T10:28:16.066462Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015679359436035156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.no_1900_dates_stg_kns__FreightForwarder_DSV_VesselLoadedAt.0779769e89", "compiled": true, "compiled_code": "\n    select *\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_DSV\"\n    where VesselLoadedAt = '1900-01-01'\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.066462Z", "completed_at": "2025-09-07T10:28:16.113294Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.113294Z", "completed_at": "2025-09-07T10:28:16.113294Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.046831607818603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_kns__FreightForwarder_SFI_EstimatedArrivalAt__date.cce0b38b3e", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('NUMBER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('FREIGHTFORWARDER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('VESSELLOADEDAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSPORTAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSSTARTSHIPAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDARRIVALAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'ESTIMATEDARRIVALAT'\n            and\n            relation_column_type not in ('DATE')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.113294Z", "completed_at": "2025-09-07T10:28:16.160194Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.160194Z", "completed_at": "2025-09-07T10:28:16.160194Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04690074920654297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_kns__FreightForwarder_SFI_EstimatedUSPortAt__date.e4cb327004", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('NUMBER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('FREIGHTFORWARDER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('VESSELLOADEDAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSPORTAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSSTARTSHIPAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDARRIVALAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'ESTIMATEDUSPORTAT'\n            and\n            relation_column_type not in ('DATE')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.175790Z", "completed_at": "2025-09-07T10:28:16.207042Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.207042Z", "completed_at": "2025-09-07T10:28:16.207042Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0468752384185791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_kns__FreightForwarder_SFI_EstimatedUSStartShipAt__date.96e1bf2941", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('NUMBER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('FREIGHTFORWARDER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('VESSELLOADEDAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSPORTAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSSTARTSHIPAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDARRIVALAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'ESTIMATEDUSSTARTSHIPAT'\n            and\n            relation_column_type not in ('DATE')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.222665Z", "completed_at": "2025-09-07T10:28:16.269538Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.269538Z", "completed_at": "2025-09-07T10:28:16.269538Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.046872615814208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_kns__FreightForwarder_SFI_VesselLoadedAt__date.420ac9db3b", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('NUMBER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('FREIGHTFORWARDER' as VARCHAR(8000)) as relation_column,\n            cast('VARCHAR' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('VESSELLOADEDAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSPORTAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDUSSTARTSHIPAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        union all\n        \n        select\n            cast('ESTIMATEDARRIVALAT' as VARCHAR(8000)) as relation_column,\n            cast('DATE' as VARCHAR(8000)) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'VESSELLOADEDAT'\n            and\n            relation_column_type not in ('DATE')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.269538Z", "completed_at": "2025-09-07T10:28:16.269538Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.269538Z", "completed_at": "2025-09-07T10:28:16.269538Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.no_1900_dates_stg_kns__FreightForwarder_SFI_EstimatedArrivalAt.fcff9b26b5", "compiled": true, "compiled_code": "\n    select *\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_SFI\"\n    where EstimatedArrivalAt = '1900-01-01'\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.285162Z", "completed_at": "2025-09-07T10:28:16.285162Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.285162Z", "completed_at": "2025-09-07T10:28:16.285162Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.no_1900_dates_stg_kns__FreightForwarder_SFI_EstimatedUSPortAt.8ecfb2dd25", "compiled": true, "compiled_code": "\n    select *\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_SFI\"\n    where EstimatedUSPortAt = '1900-01-01'\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.285162Z", "completed_at": "2025-09-07T10:28:16.300787Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.300787Z", "completed_at": "2025-09-07T10:28:16.300787Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624284744262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.no_1900_dates_stg_kns__FreightForwarder_SFI_EstimatedUSStartShipAt.62e86b505a", "compiled": true, "compiled_code": "\n    select *\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_SFI\"\n    where EstimatedUSStartShipAt = '1900-01-01'\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.300787Z", "completed_at": "2025-09-07T10:28:16.300787Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.300787Z", "completed_at": "2025-09-07T10:28:16.300787Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.no_1900_dates_stg_kns__FreightForwarder_SFI_VesselLoadedAt.69753375e9", "compiled": true, "compiled_code": "\n    select *\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_SFI\"\n    where VesselLoadedAt = '1900-01-01'\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.316412Z", "completed_at": "2025-09-07T10:28:16.316412Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.316412Z", "completed_at": "2025-09-07T10:28:16.316412Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625715255737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.FreightForwarders", "compiled": true, "compiled_code": "with\n\nair_and_sea as (\n\n    select \n        Number,\n        FreightForwarder,\n        min([VesselLoadedAt]) as VesselLoadedAt,\n        min([EstimatedUSPortAt]) as EstimatedUSPortAt,\n        min([EstimatedUSStartShipAt]) as EstimatedUSStartShipAt,\n        min([EstimatedArrivalAt]) as EstimatedArrivalAt\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_AirAndSea\"\n    where Number != ''\n        and Number is not null\n    group by Number, FreightForwarder\n),\n\ndsv as (\n\n    select * from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_DSV\"\n\n),\n\nsfi as (\n\n    select * from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__FreightForwarder_SFI\"\n\n),\n\npo_master_file as (\n\n    select \n        [Number],\n        FreightForwarder,\n        VesselLoadedAt,\n        EstimatedUSPortAt,\n        EstimatedUSStartShipAt,\n        EstimatedArrivalAt\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__POMasterFile\"\n    group by [Number], FreightForwarder, VesselLoadedAt, EstimatedUSPortAt, EstimatedUSStartShipAt, EstimatedArrivalAt\n\n),\n\ncombined as (\n\n    select\n        *,\n        1 as priority\n    from air_and_sea\n\n    union all\n\n    select\n        *,\n        2 as priority\n    from dsv\n\n    union all\n\n    select\n        *,\n        3 as priority\n    from sfi\n\n    union all\n\n    select\n        *,\n        4 as priority\n    from po_master_file\n\n),\n\nranked as (\n\n    select \n        *,\n        row_number() over (partition by Number order by priority) as row_num\n    from combined\n\n)\n\nselect \n    Number, FreightForwarder, VesselLoadedAt, EstimatedUSPortAt, EstimatedUSStartShipAt, EstimatedArrivalAt\nfrom ranked\nwhere row_num = 1", "relation_name": "\"KNSDevDbt\".\"dbt_prod_marts\".\"FreightForwarders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.316412Z", "completed_at": "2025-09-07T10:28:16.332038Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.332038Z", "completed_at": "2025-09-07T10:28:16.332038Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625715255737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.not_null_stg_marketing__Criteo_date.861ccae32e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date\nfrom \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_marketing__Criteo\"\nwhere date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.347657Z", "completed_at": "2025-09-07T10:28:16.347657Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.347657Z", "completed_at": "2025-09-07T10:28:16.347657Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01561880111694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.int_marketing__SourcesUnioned", "compiled": true, "compiled_code": "with \n\ncriteo as (\n\n    select \n        Date,\n        'Criteo-Ad' as AdName,\n        'Criteo-Ad-Set' as AdSet,\n        CampaignName as Campaign,\n        tp.TradingPartnerId as TradingPartnerId,\n        'Criteo' as Platform,\n        null as Channel,\n        null as Type,\n        null as Brand,\n        Spend,\n        ctr as ClickThrough,\n        impressions as Impressions,\n        ctr * impressions as Conversions,\n        attributedSales as SalesDollars,\n        attributedUnits as SalesUnits\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_marketing__Criteo\" c\n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__TradingPartner\" tp\n        on c.retailerName = tp.Name\n    where Spend > 0\n\n),\n\nnorthbeam as (\n    select \n        Date,\n        ad_name as AdName,\n        adset_name as AdSet,\n        campaign_name as Campaign,\n        case\n            when Instance = 'Journee' \n                then 35\n            when Instance = 'Taft' \n                then 64\n            when Instance = 'Birdies' \n                then 83\n            else 55\n        end as TradingPartnerId,\n        'Northbeam' as Platform,\n        breakdown_platform_northbeam as Channel,\n        null as Type,\n        null as Brand,\n        Spend,\n        --visits / nullif(imprs, 0) as ClickThrough, CHECK IF CTR MEANS WHAT IT ALSO MEANS IN CRITEO\n        ctr as ClickThrough,\n        imprs as Impressions,\n        --visits * 1 / nullif(imprs, 0) * imprs as Conversions,\n        ctr * imprs as Conversions,\n        attributed_rev as SalesDollars,\n        null as SalesUnits\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_marketing__Northbeam\" \n    where attribution_model in (\n        'Clicks and views',\n        'Clicks + Modeled Views'\n        )\n        and attribution_window = '7'\n),\n\npromoteiq as (\n    select \n        Date,\n        'PromoteIQ-Ad' as AdName,\n        'PromoteIQ-Ad-Set' as AdSet,\n        [Campaign Name] as Campaign,\n        13 as TradingPartnerId,\n        'PromoteIQ' as Platform,\n        null as Channel,\n        null as Type,\n        null as Brand,\n        Spend,\n        CTR as ClickThrough,\n        Impressions,\n        CTR * Impressions as Conversions,\n        [Total Sales] as SalesDollars,\n        [Units Sold] as SalesUnits\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_marketing__PromoteIq\" p\n    where ([Vendor Name] like '%JOURNEE%' or [Vendor Name] like '%VANCE%')\n        and p.[Campaign Name] is not null\n),\n\nsymbiosys as (\n    select \n        Date,\n        'Symbiosys-Ad' as AdName,\n        'Symbiosys-Ad-Set' as AdSet,\n        Campaign as Campaign,\n        3 as TradingPartnerId,\n        'Symbiosys' as Platform,\n        Channel,\n        null as Type,\n        null as Brand,\n        Spend,\n        null as ClickThrough,\n        null as Impressions,\n        null as Conversions,\n        Sales as SalesDollars,\n        [Units Sold] as SalesUnits\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_marketing__Symbiosys\"\n),\n\ncoop_campaign as (\n    select \n        cal.Date,\n        'Co-Op-Campaigns-Ad' as AdName,\n        'Co-Op-Campaigns-Ad-Set' as AdSet,\n        FrontCode as Campaign,\n        cast(substring(substring(trim(BackCode), len(trim(BackCode)) - 20, 21), 1, 3) as int) as TradingPartnerId,\n        'Co-Op Campaigns' as Platform,\n        null as Channel,\n        null as Type,\n        null as Brand,\n        Spend / (\n            select count(*) \n            from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_dbo__Calendar\" cal2 \n            where cal2.Date >= co.StartAt and cal2.Date <= co.EndAt\n        ) as Spend,\n        null as ClickThrough,\n        null as Impressions,\n        null as Conversions,\n        null as SalesDollars,\n        null as SalesUnits\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_marketing__CoOpCampaign\" co\n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_dbo__Calendar\" cal\n        on cal.Date >= co.StartAt and cal.Date <= co.EndAt\n),\n\nroundel as (\n\n    select \n        Date,\n        'Roundel-Ad' as AdName, --Media Name\n        'Roundel-Ad-Set' as AdSet,\n        campaignName as Campaign,\n        62 as TradingPartnerId,\n        'Roundel' as Platform,\n        null as Channel,\n        null as Type,\n        null as Brand,\n        Spend,\n        clicks / NULLIF(Impressions, 0) as ClickThrough, --CHECK THIS LOGIC\n        Impressions,\n        clicks as Conversions,\n        attributedSales as SalesDollars,\n        attributedUnits as SalesUnits\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_marketing__Roundel\"\n\n),\n\nsources_unioned as (\n    select * from northbeam\n    union all\n    select * from northbeam\n    union all\n    select * from promoteiq\n    union all\n    select * from symbiosys\n    union all\n    select * from coop_campaign\n    union all\n    select * from roundel\n)\n\nselect * from sources_unioned;", "relation_name": "\"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_marketing__SourcesUnioned\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.363288Z", "completed_at": "2025-09-07T10:28:16.363288Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.363288Z", "completed_at": "2025-09-07T10:28:16.363288Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01563119888305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.int_sales__BudgetForecast", "compiled": true, "compiled_code": "with \n\nfilters as (\n    select\n        Identifier,\n        AccountNumber,\n        AccountName,\n        BrandId,\n        Class,\n        Subclass,\n        TradingPartnerId,\n        MonthEndDate,\n        Amount\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__BudgetForecast\"\n    where AccountNumber in ('4000', '4050', '4100', '4101', '4102', \n                            '4103', '4104', '4105', '4106', '5000', \n                            '5100', '5200', '6070', '6067', '6035',\n                            '6021', '6045', '6056')\n    or AccountName = 'Units'\n),\n\nnew_columns as (\n    select\n        Identifier,\n        AccountNumber,\n        AccountName,\n        BrandId,\n        Class,\n        Subclass,\n        TradingPartnerId,\n        MonthEndDate,\n        Amount,\n        iif(AccountNumber in ('4000', '4050'), 1, 0) as IsGrossSales,\n        iif(AccountNumber in ('4100', '4101', '4102', '4103', '4104', '4105', '4106'), 1, 0) as IsNetAdj,\n        iif(AccountNumber = '5000', 1, 0) as IsProductCogs,\n        iif(AccountNumber = '5100', 1, 0) as IsFreightOut,\n        iif(AccountNumber = '5200', 1, 0) as IsFreightIn\n    from filters\n    where Amount != 0\n),\n\nnumbers as (\n    select TOP (31) ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) - 1 as n\n    from master..spt_values\n),\n\nexpanded as (\n    select\n        nc.Identifier,\n        nc.AccountNumber,\n        nc.AccountName,\n        nc.BrandId,\n        nc.Class,\n        nc.Subclass,\n        nc.TradingPartnerId,\n        nc.MonthEndDate,\n        DATEADD(day, n.n, DATEFROMPARTS(YEAR(nc.MonthEndDate), MONTH(nc.MonthEndDate), 1)) as DailyDate,\n        nc.Amount,\n        round(nc.Amount / (DAY(EOMONTH(nc.MonthEndDate))), 4) as DailyAmount,\n        nc.IsGrossSales,\n        nc.IsNetAdj,\n        nc.IsProductCogs,\n        nc.IsFreightOut,\n        nc.IsFreightIn\n    from new_columns nc\n    join numbers n\n        on n.n < DAY(EOMONTH(nc.MonthEndDate))\n)\n\nselect * from expanded", "relation_name": "\"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__BudgetForecast\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.363288Z", "completed_at": "2025-09-07T10:28:16.378915Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.378915Z", "completed_at": "2025-09-07T10:28:16.378915Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01562666893005371, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.DimTradingPartner", "compiled": true, "compiled_code": "\n  \n\n\nwith \n\ntrading_partners as (\n\n    select\n        TradingPartnerId,\n        Name,\n        Code,\n        FinancialChannelType as ChannelType\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__TradingPartner\"\n\n),\n\nfinal as (\n\n    select\n        *,\n        iif (Name in ('DSW', 'MACYS', 'KOHLS', 'TARGET PLUS', 'NORDSTROM RACK', 'JCPENNEY', 'AMAZON', 'WALMART MARKETPLACE', 'KOHLS - WS'), 1, 0) as IsTopPartner\n    from trading_partners\n\n)\n\nselect * from final;", "relation_name": "\"KNSDataWarehouse\".\"Deposco\".\"DimTradingPartner\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.378915Z", "completed_at": "2025-09-07T10:28:16.394660Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.394660Z", "completed_at": "2025-09-07T10:28:16.394660Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015745162963867188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.FactOTIF", "compiled": true, "compiled_code": "\n  \n\n\nwith \n\nline_disposition as (\n    select\n        oh.OrderHeaderId as OrderHeaderId,\n        case\n            when ol.OrderLineStatus = 'Canceled' or oh.CurrentStatus = 'Canceled' then 'Canceled'\n            when (oh.KnsMtActualReleaseDate is not null \n                    and tp.FulfillmentChannelType = 'Wholesale')\n                or (oh.ShippingStatus = 20 \n                    and oh.KnsMtActualShipDate is not null \n                    and  tp.FulfillmentChannelType != 'Wholesale') \n                then 'Complete'\n            when oh.CurrentStatus in ('New', 'Back Ordered', 'Released', 'Complete', 'Picking', 'Hold', 'Waiting For Rollback') then 'Open'\n            else 'Unknown'\n        end as LineDisposition,\n        tp.TradingPartnerId as TradingPartnerId\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderHeader\" oh\n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__TradingPartner\" tp on tp.TradingPartnerId = oh.ConsigneePartnerId\n    left join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__CoHeader\" ch on ch.CoHeaderId = oh.CoHeaderId\n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderLine\" ol on ol.OrderHeaderId = oh.OrderHeaderId\n    left join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__CoLine\" cl on cl.CoLineId = ol.CoLineId\n    where oh.CreatedDate >= dateadd(day, -365, getdate())\n        and oh.Type = 'Sales Order'\n        and (oh.OrderSource is null or oh.OrderSource not in ('Shipped Sales', 'Potential Sales', 'Forecast Sales', \n        'Montly Net Revenue Percent', 'Net Margin', 'Net Revenue Forecast', 'Historical NetSuite', 'InvalidSource'))\n        and tp.Name not in ('Walmart WFS', 'MARKETING', '- No Customer/Project -')\n        and (oh.CustomerOrderNumber is null or oh.CustomerOrderNumber not like 'FBA%')\n        and oh.CurrentStatus not in ('Voided')\n        and ol.OrderLineStatus not in ('Voided')\n        and not(ol.OrderLineStatus = 'Canceled' and cl.Status not in ('Canceled', 'Review'))\n        and not(oh.CurrentStatus = 'Canceled' and ch.Status not in ('Canceled', 'Review'))\n),\n\ngrouped as (\n    select\n\t\tld.OrderHeaderId,\n        case\n            when sum(iif(ld.LineDisposition = 'Canceled', 1, 0)) = count(*) then 'FullyCanceled'\n            when sum(iif(ld.LineDisposition = 'Canceled', 1, 0)) > 0 \n                and sum(iif(ld.LineDisposition = 'Canceled', 1, 0)) < count(*) then 'PartiallyCanceled'\n            when sum(iif(ld.LineDisposition = 'Complete', 1, 0)) = count(*) then 'CompleteInFull'\n            when sum(iif(ld.LineDisposition = 'Unknown', 1, 0)) > 0 then null\n            else 'Open'\n        end as OrderDisposition\n\tfrom line_disposition ld\n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__TradingPartner\" tp on tp.TradingPartnerId = ld.TradingPartnerId\n    group by ld.OrderHeaderId\n),\n\nfinal as (\n    select\n        g.OrderHeaderId as OrderHeaderId,\n        g.OrderDisposition,\n        case\n            when tp.FulfillmentChannelType != 'Wholesale' then\n                dateadd(minute,\n                    case\n                        when oh.IsExpress = 1 then 14*60\n                        else 17*60\n                    end,\n                    cast(cast(oh.KnsMtPlannedReleaseDate as date) as datetime)\n                ) \n            else \n                dateadd(minute,\n                    (23 * 60) + 59,\n                    cast(cast(oh.KnsMtPlannedShipDate as date) as datetime)\n                ) \n        end as TargetCompletionAt,\n        case\n            when tp.FulfillmentChannelType != 'Wholesale' then oh.KnsMtActualShipDate\n            else oh.KnsMtActualReleaseDate\n        end as ActualCompletionAt,\n        case\n            when tp.FulfillmentChannelType != 'Wholesale' then\n                datediff(minute,\n                    dateadd(minute,\n                        case\n                            when oh.IsExpress = 1 then 14*60\n                            else 17*60\n                        end,\n                        cast(cast(oh.KnsMtPlannedReleaseDate as date) as datetime)\n                    ),\n                    oh.KnsMtActualShipDate) / 1440.0\n            else\n                datediff(minute,\n                    dateadd(minute,\n                        (23 * 60) + 59,\n                        cast(cast(oh.KnsMtPlannedShipDate as date) as datetime)\n                    ),\n                    oh.KnsMtActualReleaseDate\n                ) / 1440.0\n        end as CompletionOffset,\n        tp.TradingPartnerId\n    from grouped g \n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderHeader\" oh \n    on oh.OrderHeaderId = g.OrderHeaderId\n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__TradingPartner\" tp\n    on tp.TradingPartnerId = oh.ConsigneePartnerId\n)\n\nselect * from final", "relation_name": "\"KNSDataWarehouse\".\"KNS\".\"FactOTIF\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.394660Z", "completed_at": "2025-09-07T10:28:16.394660Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.394660Z", "completed_at": "2025-09-07T10:28:16.394660Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.int_sales__FactSalesLine_ReturnsAccruals", "compiled": true, "compiled_code": "with \n\nsource as (\n\n    select \n        cast(concat('Returns Accrual/', tl.UniqueKey) as nvarchar(255)) as Number,\n        171516 as ItemId,\n        tp.TradingPartnerId,\n        'Discontinued' as Brand,\n        null as LastUpdatedAt,\n        0 as Amount,\n        0 as Quantity,\n        null as PONumber,\n        convert(date, t.TranDate) as PlacedDate,\n        convert(date, t.TranDate) as CreatedDate,\n        convert(date, t.TranDate) as ContractualShipDate,\n        convert(date, t.TranDate) as PlannedShipDate,\n        convert(date, t.TranDate) as ActualShipDate,\n        'Complete' as HeaderCurrentStatus,\n        'Shipped' as HeaderShippingStatus,\n        'Complete' as LineStatus,\n        0 as FreightOutCOGS,\n        coalesce(tl.CreditForeignAmount, 0) - coalesce(tl.DebitForeignAmount, 0) as ItemCOGS,\n        0 as HandlingFee,\n        0 as DiscountAmount,\n        getdate() as RecordUpdatedAt,\n        null as Season\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__TransactionLine\" tl\n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Transaction\" t\n        on tl.[Transaction] = t.Id\n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Entity\" e\n        on t.Entity = e.Id\n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__TradingPartner\" tp\n        on e.EntityId = tp.Name\n    where tl.Memo = 'Returns Accrual'\n        and tl.ExpenseAccount=214\n        and (convert(date, eomonth(t.TranDate)) <  dateadd(day, -15, convert(date, SYSDATETIMEOFFSET() at time zone 'mountain standard time')))\n\n)\n\nselect * from source", "relation_name": "\"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__FactSalesLine_ReturnsAccruals\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.410166Z", "completed_at": "2025-09-07T10:28:16.410166Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.410166Z", "completed_at": "2025-09-07T10:28:16.410166Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01550602912902832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.int_sales__ReturnRatePrep", "compiled": true, "compiled_code": "with\n\nparams as (\n    select \n        dateadd(year, -1, getdate()) as returns_after\n),\n\naccepted_tp as (\n\n    select\n        Code,\n        TradingPartnerId,\n        Name\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__TradingPartner\"\n    where IsReturnsPartner = 1\n        and Name != 'MARKETING'\n\n),\n\ncustomer_blind_returns as (\n\n    select\n        case \n            when oh.ConsigneePartnerId is not null\n                then (select name from accepted_tp tp where oh.ConsigneePartnerId = tp.TradingPartnerId)\n            else\n                (select name from accepted_tp tp where oh.Seller = tp.Code)\n        end as TradingPartner,\n        i.StyleNumber as Parent,\n        concat(i.StyleNumber, '-', i.ColorName) as Item,\n        null as PurchasedQuantity,\n        rl.ReceivedPackQuantity as ReturnQuantity,\n        datediff(day,\n                cast((select poh.CreatedDate\n                    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderHeader\" poh\n                    where oh.ParentOrderId = poh.OrderHeaderId) as date),\n                cast(oh.CreatedDate as date)\n        ) as ReturnDays\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__ReceiptLine\" rl\n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderLine\" ol \n        on rl.OrderLineId = ol.OrderLineId\n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderHeader\" oh\n        on ol.OrderHeaderId = oh.OrderHeaderId\n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__Item\" i\n        on ol.ItemId = i.ItemId\n    cross join params\n    where oh.Type in ('Blind RMA', 'Customer Return')\n        and (oh.Seller in (select Code from accepted_tp) \n            or oh.ConsigneePartnerId in (select TradingPartnerId from accepted_tp))\n        and oh.CreatedDate > params.returns_after\n        and i.StyleNumber is not null\n        and i.ColorName is not null\n\n),\n\nsales_order_returns as (\n\n    select\n        case \n            when oh.ConsigneePartnerId is not null\n                then (select name from accepted_tp tp where oh.ConsigneePartnerId = tp.TradingPartnerId)\n            else\n                (select name from accepted_tp tp where oh.Seller = tp.Code)\n        end as TradingPartner,\n        i.StyleNumber as Parent,\n        concat(i.StyleNumber, '-', i.ColorName) as Item,\n        OrderPackQuantity as PurchasedQuantity,\n        null as ReturnedQuantity,\n        null as ReturnDays\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderHeader\" oh\n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderLine\" ol \n        on oh.OrderHeaderId = ol.OrderHeaderId\n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__Item\" i\n        on ol.ItemId = i.ItemId\n    cross join params\n    where oh.Type = 'Sales Order'\n        and (oh.OrderSource is null or oh.OrderSource not in \n            ('Shipped Sales', 'Forecast Sales', 'Montly Net Revenue Percent', 'Net Margin', 'Net Revenue Forecast', 'InvalidSource', 'Potential Sales', 'Amazon FBA', 'Walmart WFS')\n            )\n        and oh.CurrentStatus != 'Voided'\n        and (oh.CustomerOrderNumber is null or oh.CustomerOrderNumber not like 'FBA%')\n        and (ol.OrderLineStatus != 'Canceled')\n        and (oh.Seller in (select Code from accepted_tp) \n            or oh.ConsigneePartnerId in (select TradingPartnerId from accepted_tp))\n        and oh.CreatedDate > dateadd(month, -1, params.returns_after)\n        and oh.CreatedDate < dateadd(month, -1, getdate())\n        and i.StyleNumber is not null\n        and i.ColorName is not null\n\n),\n\nreturns_unioned as (\n\n    select * from customer_blind_returns\n    union all\n    select * from sales_order_returns\n\n)\n\nselect * from returns_unioned", "relation_name": "\"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__ReturnRatePrep\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.410166Z", "completed_at": "2025-09-07T10:28:16.425791Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.425791Z", "completed_at": "2025-09-07T10:28:16.425791Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.DimBrand", "compiled": true, "compiled_code": "\n  \n\n\nwith\n\nbrands as (\n    select\n        BrandId,\n        Name as Brand,\n        case\n            when Name = 'Discontinued' then 4 \n            when Name = 'Journee' then 0 \n            when Name = 'Vance' then 2 \n            when Name = 'Taft' then 1 \n            when Name = 'Birdies' then 3 \n        end as OrderIndex\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_products__Brand\"\n)\n\nselect * from brands", "relation_name": "\"KNSDataWarehouse\".\"KNS\".\"DimBrand\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.425791Z", "completed_at": "2025-09-07T10:28:16.441416Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.441416Z", "completed_at": "2025-09-07T10:28:16.441416Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0156252384185791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.int_sales__DimItemPrep", "compiled": true, "compiled_code": "with \n\nhistorical as (\n    select \n        ItemId,\n        Category,\n        Subcategory,\n        FirstReceivedDate,\n        CloseOut,\n        CloseOutDate,\n        ToeStyle,\n        HeelType,\n        LiquidationCloseOut,\n        SoftCloseOut,\n        MasterCategory\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__HistoricalDimItem\"\n),\n\nitem as (\n    select \n        ItemId,\n        [Number],\n        ClassType,\n        UpdatedDate \n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__Item\"\n),\n\nitem_cogs as (\n    select \n        ItemId,\n        Cost\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__KnsItemCogs\"\n),\n\nvariants as (\n    select \n        VariantId,\n        Number,\n        Status,\n        ShoeWidth,\n        CalfWidth,\n        Parent,\n        ClosureType,\n        HeelType,\n        StyleType,\n        SizeRun,\n        ColorName,\n        ColorClass,\n        IsAnaplanActive,\n        SellOutTargetAt,\n        PlannedArrivalAt,\n        FirstSalesDateAt,\n        MSRP,\n        IsSupplies,\n        IsIntangible,\n        DirectSourcingModel,\n        SellingStatus,\n        StyleId,\n        SizeId,\n        Subclass,\n        VendorSku\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_products__Variant\"\n),\n\nstyles as (\n    select \n        StyleId,\n        CatalogId,\n        Name,\n        Class,\n        Vendor,\n        Gender,\n        Season,\n        CaseQuantity,\n        SeasonBudget\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_products__Style\"\n),\n\nbrands as (\n    select \n        BrandId,\n        Name,\n        Division\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_products__Brand\"\n),\n\ncatalog as (\n    select \n        CatalogId,\n        Name,\n        BrandId\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_products__Catalog\"\n),\n\nsize as (\n    select \n        SizeId,\n        Name\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_products__Size\"\n),\n\nproduct as (\n    select\n        v.Number,\n        v.Status,\n        v.ShoeWidth,\n        v.CalfWidth,\n        v.Parent,\n        v.ClosureType,\n        v.HeelType,\n        v.StyleType,\n        v.SizeRun,\n        v.ColorName as Color,\n        v.ColorClass,\n        v.IsAnaplanActive as Anaplan,\n        month(v.SellOutTargetAt) as SellOutTargetDateMonth,\n        year(v.SellOutTargetAt) as SellOutTargetDateYear,\n        v.PlannedArrivalAt as PlannedArrivalDateMonth,\n        v.FirstSalesDateAt as FirstSalesDate,\n        v.MSRP,\n        v.IsSupplies,\n        v.IsIntangible,\n        v.DirectSourcingModel,\n        v.SellingStatus,\n        s.Name as Style,\n        c.Name as Catalog,\n        c.BrandId,\n        v.Subclass,\n        s.Class,\n        s.Vendor,\n        v.VendorSku,\n        s.Gender,\n        s.Season,\n        s.CaseQuantity,\n        s.SeasonBudget,\n        sz.Name as Size,\n        b.Name as Brand,\n        b.Division\n    from variants v\n    left join styles s on v.StyleId = s.StyleId\n    left join catalog c on s.CatalogId = c.CatalogId\n    left join brands b on c.BrandId = b.BrandId\n    left join size sz on v.SizeId = sz.SizeId\n),\n\nfinal as (\n\n    select\n        i.ItemId,\n        p.[Number],\n        h.Category,\n        h.Subcategory,\n        coalesce(nullif(p.Catalog, ''), '*No Catalog*') as Catalog,\n        coalesce(nullif(p.Vendor, ''), '*No Vendor*') as Vendor,\n        coalesce(nullif(p.Gender, ''), '*No Gender*') as Gender,\n        case\n            when i.[Number] in ('Order Protection', 'Navidium Shipping Protection') then 'Shipping Protection'\n            else coalesce(nullif(p.Parent , ''), '*No Parent*')\n        end as Parent,\n        coalesce(nullif(p.Color, ''), '*No Color*') as Color,\n        coalesce(nullif(p.Season, ''), '*No Season*') as Season,\n        coalesce(nullif(p.Size, ''), '*No Size*') as Size,\n        i.UpdatedDate as UpdatedAt,\n        h.FirstReceivedDate,\n        year(p.FirstSalesDate) as IntroductionYear,\n        h.CloseOut,\n        h.CloseOutDate,\n        h.ToeStyle,\n        p.ClosureType,\n        h.HeelType,\n        p.StyleType,\n        p.SizeRun,\n        h.LiquidationCloseOut,\n        p.CaseQuantity,\n        p.Anaplan,\n        h.SoftCloseOut,\n        ic.cost as Cost,\n        coalesce(nullif(p.Style, ''), '*No Style*') as Style,\n        h.MasterCategory,\n        p.Class,\n        p.Subclass,\n        p.VendorSKU,\n        p.SellOutTargetDateMonth,\n        p.SellOutTargetDateYear,\n        p.PlannedArrivalDateMonth,\n        p.FirstSalesDate,\n        case \n            when p.Number is null and p.Status = 'Active' then 'Terminated'\n            else p.Status\n        end as Status,\n        p.CalfWidth,\n        '' as BrandFinancialEntity, -- WHY DO WE HAVE THIS?\n        p.ShoeWidth,\n        p.ColorClass,\n        p.IsIntangible,\n        p.MSRP,\n        p.Division,\n        p.IsSupplies,\n        case\n            when i.ItemId = 153085 then 1\n            when i.ItemId = 170695 then 1\n            when i.ItemId = 204260 then 1 \n            when i.ItemId = 204262 then 2\n            when i.ItemId = 204261 then 3\n            when i.ItemId = 212170 then 4\n            else coalesce(p.BrandId, 0)\n        end as BrandId,\n        p.SeasonBudget,\n        p.SellingStatus,\n        p.DirectSourcingModel\n    from product p \n    left join item i on p.Number = i.[Number]\n    left join historical h on h.ItemId = i.ItemId\n    left join item_cogs ic on ic.ItemId=i.ItemId\n    where i.[Number] is not null\n    and (i.ClassType not in ('Girls''', 'Boys''', 'Gloves', 'Inventory', '') or i.ClassType is null)\n\n)\n\nselect * from final", "relation_name": "\"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__DimItemPrep\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.441416Z", "completed_at": "2025-09-07T10:28:16.457043Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.457043Z", "completed_at": "2025-09-07T10:28:16.457043Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015627145767211914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.int_marketing__SourcesMapped", "compiled": true, "compiled_code": "with\n\nsources as (\n    select * from \"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_marketing__SourcesUnioned\"\n),\n\nold_names as (\n  select \n    OldCampaignName,\n    NewCampaignName \n  from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_marketing__CampaignMap\"\n),\n\nnew_names as (\n  select \n    Date,\n    AdName,\n    AdSet,\n    case\n      when o.NewCampaignName is not null then o.NewCampaignName\n      else s.Campaign\n    end as Campaign,\n    TradingPartnerId,\n    Platform,\n    Channel,\n    Type,\n    Brand,\n    Spend,\n    ClickThrough,\n    Impressions,\n    Conversions,\n    SalesDollars,\n    SalesUnits\n  from sources s\n  left join old_names o\n    on s.Campaign = o.OldCampaignName\n),\n\n-- Step 1: Extract the first token from Campaign (up to the first space, or the whole Campaign)\nbase_campaign as (\n  select \n    *,\n    ltrim(rtrim(Campaign)) as FirstSegment  -- keep the whole thing, just trim whitespace\n  from new_names\n),\n\n\n-- Step 2: Count the number of periods in FirstSegment\ncampaign_with_count as (\n\n    select *,\n           len(FirstSegment) - len(replace(FirstSegment, '.', '')) as PeriodCount\n    from base_campaign\n\n),\n\n-- Step 3: Convert FirstSegment into XML to enable splitting\ncampaign_xml as (\n\n    select *,\n           cast('<i>' + \n\t\t\t replace(\n\t\t\t\t replace(\n\t\t\t\t\t replace(\n\t\t\t\t\t\t replace(FirstSegment, '&', '&amp;'), \n\t\t\t\t\t '<', '&lt;'), \n\t\t\t\t '>', '&gt;'), \n\t\t\t '.', '</i><i>') \n\t\t\t + '</i>' as xml) as XMLParts\n    from campaign_with_count\n\n),\n\n-- Step 4: Parse out each dot-delimited part from the XML\nparsed_campaign as (\n\n    select \n      Date, AdName, AdSet, Campaign, Brand, TradingPartnerId, Platform, Channel, Type,\n      Spend, ClickThrough, Impressions, Conversions, SalesDollars, SalesUnits,\n      XMLParts, PeriodCount, FirstSegment,\n      XMLParts.value('(/i)[1]', 'varchar(100)') as Part1,  -- Expecting the brand letter (J, T, V)\n      XMLParts.value('(/i)[2]', 'varchar(100)') as Part2,\n      XMLParts.value('(/i)[3]', 'varchar(100)') as Part3,  -- Code for Objective mapping\n      XMLParts.value('(/i)[4]', 'varchar(100)') as Part4,  -- Code for LandingPage mapping\n      XMLParts.value('(/i)[5]', 'varchar(100)') as Part5,  -- (Optional) Channel from parsed string if needed\n      XMLParts.value('(/i)[6]', 'varchar(100)') as Part6,  -- Class1\n      XMLParts.value('(/i)[7]', 'varchar(100)') as Part7,  -- Class2\n      XMLParts.value('(/i)[8]', 'varchar(100)') as Part8,  -- Class3\n      XMLParts.value('(/i)[9]', 'varchar(100)') as Part9   -- Extra (not used)\n    from campaign_xml\n\n),\n\n-- Step 5: Apply your mapping rules if PeriodCount = 8 (i.e. 9 parts)\ncomplete_parse as (\n\n    select\n      p.*,\n      iif(PeriodCount = 8, Part2, null) as TradingPartnerCode,\n      -- Map the brand letter from Part1 to the full brand name; this will be used to join to dim_brand for BrandId\n      case \n        when PeriodCount = 8 then \n          case p.Part1\n              when 'J' then 'Journee'\n              when 'T' then 'Taft'\n              when 'V' then 'Vance'\n              when 'B' then 'Birdies'\n              else null\n          end\n        else null\n      end as BrandMapping,\n      -- Map Part3 to Objective using your defined codes\n      case \n        when PeriodCount = 8 then\n          case p.Part3\n              when 'TOP' then 'Top Funnel / Awareness'\n              when 'MID' then 'Mid Funnel'\n              when 'BOT' then 'Bottom Funnel / Conversions'\n              when 'RTA' then 'Retargeting'\n              when 'PRO' then 'Prospecting'\n              when 'RET' then 'Retention'\n              when 'NSE' then 'NBSearch'\n              when 'BSE' then 'BrandSearch'\n              when 'PMA' then 'PMax'\n              when 'BSH' then 'BrandShopping'\n              when 'NSH' then 'NBShopping'\n              else null\n          end\n        else null\n      end as ObjectiveMapped,\n      -- Map Part4 to LandingPage using your provided options\n      case \n        when PeriodCount = 8 then \n          case p.Part4\n              when 'Brand'   then 'Brand Page'\n              when 'Product' then 'Product Page'\n              when 'DPA'     then 'Dynamic Product'\n              when 'SPA'     then 'Sponsored Product'\n              when 'CAT'     then 'Category/Collection'\n              else null\n          end\n        else null\n      end as LandingPageMapped,\n      -- Directly assign Class1, Class2, Class3 from parts 6, 7, and 8 respectively (if PeriodCount = 8)\n      case when PeriodCount = 8 then p.Part6 else null end as ParsedClass1,\n      case when PeriodCount = 8 then p.Part7 else null end as ParsedClass2,\n      case when PeriodCount = 8 then p.Part8 else null end as ParsedClass3\n    from parsed_campaign p\n\n)\n\nselect * from complete_parse;", "relation_name": "\"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_marketing__SourcesMapped\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.457043Z", "completed_at": "2025-09-07T10:28:16.457043Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.457043Z", "completed_at": "2025-09-07T10:28:16.457043Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.FactBudgetForecast", "compiled": true, "compiled_code": "\n  \n\n\nselect * from \"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__BudgetForecast\"", "relation_name": "\"KNSDataWarehouse\".\"KNS\".\"FactBudgetForecast\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.457043Z", "completed_at": "2025-09-07T10:28:16.472667Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.472667Z", "completed_at": "2025-09-07T10:28:16.472667Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01562356948852539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.int_sales__FinancialActuals", "compiled": true, "compiled_code": "with\n\nnetsuite as (\n    \tselect\n\t\tap.enddate as MonthEndAt,\n\t\tnsBrand.name as Catalog,\n\t\tnsClass.name Class,\n\t\tnsSubClass.name Subclass,\n\t\te.entityid as Partner,\n        e.id as PartnerId,\n\t\tiif(a.acctnumber in ('4000', '4050'), -coalesce(tl.rate * tl.Quantity, tl.NetAmount), 0) as Gross,\n\t\tiif(a.acctnumber in ('4100', '4101', '4102', '4103', '4104', '4105', '4106'), coalesce(tl.rate * tl.Quantity, tl.NetAmount), 0) as NetDeductions,\n\t\tcase\n\t\t\twhen t.TranDate < '2025-07-01' \n\t\t\t\tthen iif(a.acctnumber in ('5000'), coalesce(tl.rate * tl.Quantity, tl.NetAmount), 0)\n\t\t\telse iif(a.acctnumber = '5000', coalesce(tl.rate * tl.Quantity, tl.NetAmount), 0)\n\t\tend as ProductCogs\n\tfrom \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Transaction\" t\n\tjoin \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__TransactionLine\" tl on tl.[transaction] = t.id\n\tleft join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__CustomrecordCsegKnsBrand2024\" nsBrand on nsBrand.id = coalesce(tl.CsegKnsBrand2024, t.CsegKnsBrand2024)\n\tleft join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__CustomrecordCsegKnsProductcat\" nsClass on nsClass.id = coalesce(tl.CsegKnsProductCat, t.CsegKnsProductCat)\n\tleft join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__CustomrecordCsegKnsProdSubcl\" nsSubClass on nsSubClass.id = coalesce(tl.CsegKnsProdSubcl, t.CsegKnsProdSubcl)\n\tjoin \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Entity\" e on e.id = coalesce(tl.Entity, t.Entity)\n\tjoin \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Account\" a on a.id = tl.expenseaccount\n\tjoin \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__AccountingPeriod\" ap on ap.enddate = EOMONTH(t.trandate)\n\twhere ap.alllocked = 'T'\n\tand ap.isposting = 'T'\n\tand a.acctnumber in ('4000', '4050', '4100', '4101', '4102', '4103', '4104', '4105', '4106', '5000', '5200')\n\tgroup by \n\t\tap.enddate,\n\t\tnsBrand.name,\n\t\tnsClass.name,\n\t\tnsSubClass.name,\n\t\te.entityid,\n        e.id,\n\t\tiif(a.acctnumber in ('4000', '4050'), -coalesce(tl.rate * tl.Quantity, tl.NetAmount), 0),\n\t\tiif(a.acctnumber in ('4100', '4101', '4102', '4103', '4104', '4105', '4106'), coalesce(tl.rate * tl.Quantity, tl.NetAmount), 0),\n\t\tcase\n\t\t\twhen t.TranDate < '2025-07-01' \n\t\t\t\tthen iif(a.acctnumber in ('5000'), coalesce(tl.rate * tl.Quantity, tl.NetAmount), 0)\n\t\t\telse iif(a.acctnumber = '5000', coalesce(tl.rate * tl.Quantity, tl.NetAmount), 0)\n\t\tend,\n\t\tt.id,\n\t\tt.tranid,\n\t\ttl.uniquekey,\n\t\ta.acctnumber\n),\n\nfinal as (\n    select \n        n.MonthEndAt,\n        tp.TradingPartnerId,\n        c.BrandId,\n        n.Class,\n        n.Subclass,\n\t\tsum(n.Gross) as GrossSales,\n\t\tsum(n.NetDeductions) as NetComponents,\n\t\tsum(n.ProductCogs) as ProductCogs,\n        round((sum(n.Gross) - sum(n.NetDeductions)) / \n        nullif(sum(n.Gross), 0), 2) as GrossToNetPercentage\n    from netsuite n\n    left join \"KNSDataWarehouse\".\"Deposco\".\"DimTradingPartner\" tp\n    on n.Partner = tp.Name\n        or (tp.Code = 'FV' and n.PartnerId = 755) \n\t    or (tp.Code = 'FT' and n.PartnerId = 1497) \n\tleft join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_products__Catalog\" c \n\ton n.Catalog = c.Name\n    where Catalog is not null\n    and Class is not null\n    and Subclass is not null\n    and tp.TradingPartnerId is not null\n    group by \n        n.MonthEndAt,\n        tp.TradingPartnerId,\n        c.BrandId,\n        n.Class,\n        n.Subclass\n)\n\nselect * from final", "relation_name": "\"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__FinancialActuals\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.472667Z", "completed_at": "2025-09-07T10:28:16.488292Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.488292Z", "completed_at": "2025-09-07T10:28:16.488292Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624761581420898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.not_null_DimTradingPartner_TradingPartnerId.1681276484", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect TradingPartnerId\nfrom \"KNSDataWarehouse\".\"Deposco\".\"DimTradingPartner\"\nwhere TradingPartnerId is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.488292Z", "completed_at": "2025-09-07T10:28:16.503917Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.503917Z", "completed_at": "2025-09-07T10:28:16.503917Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625476837158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.unique_DimTradingPartner_TradingPartnerId.3848ac0272", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    TradingPartnerId as unique_field,\n    count(*) as n_records\n\nfrom \"KNSDataWarehouse\".\"Deposco\".\"DimTradingPartner\"\nwhere TradingPartnerId is not null\ngroup by TradingPartnerId\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.503917Z", "completed_at": "2025-09-07T10:28:16.503917Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.503917Z", "completed_at": "2025-09-07T10:28:16.503917Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.not_null_FactOTIF_OrderDisposition.84b3c078cc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect OrderDisposition\nfrom \"KNSDataWarehouse\".\"KNS\".\"FactOTIF\"\nwhere OrderDisposition is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.519542Z", "completed_at": "2025-09-07T10:28:16.519542Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.519542Z", "completed_at": "2025-09-07T10:28:16.519542Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.FactReturnRate", "compiled": true, "compiled_code": "with\n\nparams as (\n    select \n        70 as stat_threshold,\n        1 as return_processing_day\n),\n\nreturns_temp as (\n\n    select * from \"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__ReturnRatePrep\"\n\n),\n\nmedian as (\n\n    select distinct\n        TradingPartner,\n        case\n            when (select count(*)\n                from returns_temp temp\n                where ReturnDays is not null and main.TradingPartner = temp.TradingPartner) > params.stat_threshold\n            then\n                ((select max(num) \n                from (select top 50 percent ReturnDays AS num \n                        from returns_temp temp \n                        where ReturnDays is not null and main.TradingPartner = temp.TradingPartner \n                        order by ReturnDays) onehalf)\n                +\n                (select min(num) \n                from (select top 50 percent ReturnDays AS num \n                        from returns_temp temp \n                        where ReturnDays is not null and main.TradingPartner = temp.TradingPartner \n                        order by ReturnDays desc) otherhalf)\n                ) / 2 + params.return_processing_day\n            else null\n        end as MedianDays\n    from returns_temp main\n    cross join params\n\n),\n\naggregated_data as (\n\n    select \n        TradingPartner,\n        Parent,\n        Item,\n        sum(coalesce(ReturnQuantity, 0)) as TotalReturnQuantity,\n        sum(coalesce(PurchasedQuantity, 0)) as TotalPurchasedQuantity\n    from returns_temp\n    group by TradingPartner, Parent, Item\n\n),\n\nfinal as (\n\n    select \n        a.TradingPartner,\n        a.Item as ParentColor,\n        case \n        when a.TotalPurchasedQuantity > params.stat_threshold \n                and a.TotalReturnQuantity < a.TotalPurchasedQuantity\n        then cast(a.TotalReturnQuantity as float) / a.TotalPurchasedQuantity\n        else NULL\n        end as PercentReturnRate,\n        ISNULL(m.MedianDays, 60) as ReturnLagDays\n    from aggregated_data a\n    left join median m on m.TradingPartner = a.TradingPartner\n    cross join params\n    where a.TotalPurchasedQuantity > params.stat_threshold \n    and a.TotalReturnQuantity < a.TotalPurchasedQuantity \n    and a.TotalPurchasedQuantity > 0\n\n)\n\nselect * from final", "relation_name": "\"KNSDevDbt\".\"dbt_prod_marts\".\"FactReturnRate\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.519542Z", "completed_at": "2025-09-07T10:28:16.535167Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.535167Z", "completed_at": "2025-09-07T10:28:16.535167Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624761581420898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.DimItem", "compiled": true, "compiled_code": "\n  \n\n\nwith\n\ndim_item as (\n    select * from \"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__DimItemPrep\"\n),\n\nsize_run as (\n    select \n        * \n    from \"KNSDevDbt\".\"prod\".\"seed_SizeRun\"\n    where Code in ('M-Standard-1','F-Standard-1','U-Generic-1')\n),\n\ncurrent_stock as (\n    select \n        ItemId,\n        AvailableQuantity\n    from \"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__CurrentStock\"\n),\n\ntemp_line as (\n    select \n        i.ItemId,\n        isnull(cs.AvailableQuantity,0) as AvailableQuantity,\n        case when isnull(cs.AvailableQuantity,0) > 4 then 1 else 0 end as InStock,\n        concat(i.Parent, '-', i.Color) as Item,\n        isnull(sr.IsCore, 0) as Core \n    from dim_item i\n    left join size_run sr on sr.Gender = i.Gender and sr.Size = i.Size\n    left join current_stock cs on i.ItemId = cs.ItemId\n\n),\n\ntemp_agg as (\n    select \n        Item,\n        case \n            when SUM(AvailableQuantity) = 0  then 'No Stock'\n            when SUM(Instock) = COUNT(Instock) then 'Complete Run'\n            when SUM(Instock*cast(Core as int)) = SUM(cast(Core as int)) and SUM(cast(Core as int))!= 0 then 'Core Run'\n            when SUM(cast(Core as int)) > 0 and 1.0*SUM(Instock*cast(Core as int))/SUM(cast(Core as int)) < .3  then 'Hash'\n            else 'Broken Core'\n        end as BrokenStatus\n    from temp_line\n    group by Item\n),\n\nbroken as (\n\n    select \n        ItemId,\n        BrokenStatus\n    from temp_line tl\n    join temp_agg ta on tl.Item = ta.Item\n\n),\n\nfinal as (\n    select\n        i.*,\n        b.BrokenStatus\n    from dim_item i\n    left join broken b on i.ItemId = b.ItemId\n)\n\nselect * from final", "relation_name": "\"KNSDataWarehouse\".\"Deposco\".\"DimItem\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.535167Z", "completed_at": "2025-09-07T10:28:16.535167Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.535167Z", "completed_at": "2025-09-07T10:28:16.535167Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.FactMarketingAd", "compiled": true, "compiled_code": "\n  \n\n\nwith \n\nbrands as (\n    select * from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_products__Brand\"\n),\n\ntrading_partners as (\n    select * from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__TradingPartner\"\n),\n\nmarketing_data as (\n\n    select * from \"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_marketing__SourcesMapped\"\n\n),\n\nfinal as (\n    select \n        m.[Date],\n        m.[AdName],\n        m.[AdSet],\n        m.[Campaign],\n        coalesce(tp.TradingPartnerId, m.TradingPartnerId) as TradingPartnerId,\n        m.[Platform],\n        m.Channel,\n        m.Type,\n        b.BrandId,\n        m.ObjectiveMapped as Objective,\n        m.LandingPageMapped as LandingPage,\n        m.ParsedClass1 as Class1,\n        m.ParsedClass2 as Class2,\n        m.ParsedClass3 as Class3,\n        cast(Spend as decimal(19, 4)) as Spend,\n        cast(ClickThrough as decimal(19, 4)) as ClickThrough,\n        cast(Impressions as decimal(19, 4)) as Impressions,\n        cast(Conversions as decimal(19, 4)) as Conversions,\n        cast(SalesDollars as decimal(19, 4)) as AttributedRevenue,\n        cast(SalesUnits as decimal(19, 4)) as SalesUnits\n\n    from marketing_data m\n    left join brands b \n        on b.Name = m.BrandMapping\n    left join trading_partners tp\n        on tp.Code = m.TradingPartnerCode\n)\n\nselect * from final\n    where TradingPartnerId is not null\n    and Date >= dateadd(year, -1, getdate())\n    and (Spend > 0 or AttributedRevenue > 0);", "relation_name": "\"KNSDataWarehouse\".\"KNS\".\"FactMarketingAd\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.550791Z", "completed_at": "2025-09-07T10:28:16.550791Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.550791Z", "completed_at": "2025-09-07T10:28:16.550791Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624761581420898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.FactFinancialActuals", "compiled": true, "compiled_code": "\n  \n\n\nselect * from \"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__FinancialActuals\"", "relation_name": "\"KNSDataWarehouse\".\"KNS\".\"FactFinancialActuals\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.550791Z", "completed_at": "2025-09-07T10:28:16.566417Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.566417Z", "completed_at": "2025-09-07T10:28:16.566417Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625953674316406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.FactCurrentStock", "compiled": true, "compiled_code": "\n  \n\n\nwith\n\ncurrent_stock as (\n    select cs.* \n    from \"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__CurrentStock\" cs\n    join \"KNSDataWarehouse\".\"Deposco\".\"DimItem\" i on cs.ItemId = i.ItemId\n)\n\nselect * from current_stock", "relation_name": "\"KNSDataWarehouse\".\"KNS\".\"FactCurrentStock\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.566417Z", "completed_at": "2025-09-07T10:28:16.566417Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.566417Z", "completed_at": "2025-09-07T10:28:16.566417Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.FactReturnLine", "compiled": true, "compiled_code": "\n  \n\n\nwith\n\norder_line as (\n    select\n        OrderLineId,\n        OrderHeaderId,\n        OrderPackQuantity,\n        ItemId\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderLine\" \n),\n\norder_header as (\n    select\n        OrderHeaderId,\n        ConsigneePartnerId as TradingPartner,\n        Type,\n        KnsMtCreatedDate\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderHeader\"\n),\n\nitem as (\n    select\n        ItemId,\n        BrandId,\n        Parent,\n        Color\n    from \"KNSDataWarehouse\".\"Deposco\".\"DimItem\"\n),\n\ntrading_partner as (\n    select\n        TradingPartnerId,\n        IsReturnsPartner\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__TradingPartner\"\n),\n\nfinal as (\n    select\n        ol.OrderLineId,\n        i.BrandId,\n        tp.TradingPartnerId,\n        oh.KnsMtCreatedDate as ReturnDate,\n        ol.OrderPackQuantity as ReturnQuantity,\n        i.ItemId,\n        i.Parent,\n        i.Color\n    from order_line ol\n    join order_header oh on ol.OrderHeaderId = oh.OrderHeaderId\n    join item i on ol.ItemId = i.ItemId\n    join trading_partner tp on oh.TradingPartner = tp.TradingPartnerId\n    where oh.TYPE in ('Blind RMA', 'Customer Return')\n    and oh.KnsMtCreatedDate > '2023-01-01'\n    and tp.IsReturnsPartner = 1\n)\n\nselect * from final", "relation_name": "\"KNSDataWarehouse\".\"KNS\".\"FactReturnLine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.582043Z", "completed_at": "2025-09-07T10:28:16.582043Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.582043Z", "completed_at": "2025-09-07T10:28:16.582043Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625476837158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.POLines", "compiled": true, "compiled_code": "with \n\nreceipt_dates as (\n\tselect\n\t\tId,\n\t\t(\n\t\t\tselect\n\t\t\t\tmax(t2.TranDate)\n\t\t\tfrom \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__TransactionLine\" tl2\n\t\t\tjoin \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Transaction\" t2 on t2.Id = tl2.[Transaction]\n\t\t\twhere tl2.CreatedFrom = t.Id\n\t\t\tand t2.Type = 'ItemRcpt'\n\t\t) as ReceiptDate\n\tfrom \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Transaction\" t\n\twhere (\n\t\t\tselect\n\t\t\t\tmax(t2.TranDate)\n\t\t\tfrom \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__TransactionLine\" tl2\n\t\t\tjoin \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Transaction\" t2 on t2.Id = tl2.[Transaction]\n\t\t\twhere tl2.CreatedFrom = t.Id\n\t\t\tand t2.Type = 'ItemRcpt'\n\t\t) is not null\n),\n\nnetsuite as (\n    \tselect\n\t\ttl.UniqueKey as TransactionLineId,\n\t\tt.Id as TransactionId,\n\t\tt.DueDate as ReceiveByDate,\n\t\trd.ReceiptDate as ReceiptDate,\n\t\ttl.Quantity as Quantity,\n\t\tcase\n\t\t\twhen tl.IsClosed = 'T' or ts.Name = 'Closed'\n\t\t\t then 0 \n\t\t\telse tl.Quantity - tl.QuantityShipRecv\n\t\tend as QuantityRemaining,\n\t\ttl.QuantityShipRecv as QuantityReceived,\n\t\tt.CustbodyKnsPo as TranId,\n\t\tcast(tl.Rate as decimal(19,2)) as Rate,\n\t\ti.ExternalId as Item,\n\t\tt.CustbodyKnsSeasonPo as Season,\n\t\tcast(t.CustbodyKnsXFactoryDate as date) as RequestedXF,\n\t\tcast(t.CustbodyKnsConfirmXFact as date) as ConfirmedXF,\n\t\tcast(t.CustbodyKnsActualXFact as date) as ActualXF,\n\t\tt.DueDate as RequestedInDC,\n\t\tcast(t.CustbodyKnsEstInDCDate as date) as EstimatedInDC\n\tfrom \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Transaction\" t\n\tjoin \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__TransactionLine\" tl \n\t\ton tl.[Transaction] = t.Id\n\tjoin \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__TransactionStatus\" ts \n\t\ton ts.Id = t.Status and ts.TranType = t.Type\n\tjoin \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Item\" i \n\t\ton i.Id = tl.Item\n\tleft join receipt_dates rd \n\t\ton rd.Id = t.Id\n\twhere t.Type='PurchOrd'\n\tand t.DueDate is not null\n),\n\ncutoff as (\n  select dateadd(month, -1, dateadd(month, datediff(month, 0, min(ReceiveByDate)), 0)) as cutoff_date\n  from netsuite\n  where QuantityRemaining > 0\n),\n\npo_lines as (\n\tselect\n\t\tn.TransactionLineId,\n\t\tn.TransactionId, -- t.id\n\t\tn.ReceiveByDate,\n\t\tn.ReceiptDate,\n\t\tn.RequestedXF,\n\t\tn.ConfirmedXF,\n\t\tn.ActualXF,\n\t\tn.RequestedInDC,\n\t\tn.EstimatedInDC,\n\t\ti.ItemId as ItemId,\n\t\tn.Quantity,\n\t\tn.QuantityRemaining,\n\t\tn.QuantityReceived,\n\t\tn.TranId,\n\t\tn.Rate,\n\t\t0 as IsClosed,\n\t\tn.Season,\n\t\tcase\n\t\t\twhen n.ReceiveByDate < c.cutoff_date then 0\n\t\t\telse 1\n\t\tend as IsTracking,\n\t\tcoalesce(ish.VesselNumber, null) as FreightForwarderContainer\n\tfrom netsuite n\n\tjoin \"KNSDataWarehouse\".\"Deposco\".\"DimItem\" i \n\t\ton i.Number = n.Item\n\tleft join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__InboundShipmentItem\" ishi \n\t\ton ishi.ShipmentItemTransactionId = n.TransactionLineId\n\tleft join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__InboundShipment\" ish\n\t\ton ish.Id = ishi.InboundShipmentId\n\tcross join cutoff c\n)\n\nselect * from po_lines", "relation_name": "\"KNSDevDbt\".\"dbt_prod_marts\".\"POLines\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.582043Z", "completed_at": "2025-09-07T10:28:16.597667Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.597667Z", "completed_at": "2025-09-07T10:28:16.597667Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015624046325683594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.int_sales__FactSalesLine_MDM", "compiled": true, "compiled_code": "\n\nwith \n\nupdate_order_protection as (\n    select\n        ol.OrderLineId as Number,\n        oh.CoHeaderId as ChId\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderLine\" ol\n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__Item\" i \n        on i.ItemId = ol.ItemId\n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderHeader\" oh \n        on oh.OrderHeaderId = ol.OrderHeaderId\n    where i.Name = 'Order Protection'\n        and coalesce(i.ClassType, '') = ''\n),\n\nch_ids as (\n    select\n        ol.OrderLineId as Number,\n        oh.CoHeaderId as ChId,\n        di.BrandId\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderLine\" ol \n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderHeader\" oh \n        on oh.OrderHeaderId = ol.OrderHeaderId\n    join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__Item\" i \n        on i.ItemId = ol.ItemId\n    join \"KNSDataWarehouse\".\"Deposco\".\"DimItem\" di \n        on di.ItemId = i.ItemId\n    where coalesce(i.Name, '') != 'Order Protection'\n),\n\norder_protection_mapping as (\n    select \n        o.Number,\n        max(c.BrandId) as BrandId\n    from update_order_protection o\n    join ch_ids c \n        on c.ChId = o.ChId\n    group by o.Number\n),\n\norder_protection_item as (\n    select \n        i.ItemId,\n        i.BrandId\n    from \"KNSDataWarehouse\".\"Deposco\".\"DimItem\" i\n    where i.ItemId in (\n        204260\n        ,204261\n        ,204262\n        ,212170\n        ,216852\n    )\n),\n\nsales_order as (\n    select\n        SalesOrderId,\n        SourceSystem,\n        PONumber,\n        TradingPartnerId,\n        PlacedAt,\n        ContractualShipAt,\n        PlannedShipAt,\n        Status,\n        ShippedAt,\n        FreightOutCOGSAmount,\n        DiscountAmount\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__SalesOrder\"\n),\n\nsales_order_line as (\n    select\n        sol.SalesOrderLineId,\n        sol.SalesOrderId,\n        sol.SourceId,\n        sol.ItemId,\n        sol.ProductVariantId,\n        case\n            when so.Status = 'closed' then sol.QuantityShipped\n            else sol.QuantityOrdered\n        end as Quantity,\n        sol.UnitCostAmount,\n        sol.UnitItemCOGSAmount,\n        sol.QuantityShipped\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__SalesOrderLine\" sol\n    left join sales_order so\n    on sol.SalesOrderId = so.SalesOrderId\n),\n\ntrading_partner as (\n    select\n        TradingPartnerId,\n        Name\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__TradingPartner\"\n),\n\ntrading_partner_handling_fee as (\n    select\n        TradingPartnerId,\n        StartDate,\n        EndDate,\n        HandlingFeeType,\n        HandlingFee\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__TradingPartnerHandlingFee\"\n),\n\njoined as (\n    select\n        cast(concat(so.SourceSystem, '/', sol.SourceId) as nvarchar(255)) as Number,\n        case \n            when opi.ItemId is not null and sol.ItemId != opi.ItemId then opi.ItemId\n            else sol.ItemId\n        end as ItemId,\n        tp.TradingPartnerId,\n        b.Name as Brand,\n        null as LastUpdatedAt,\n        sol.Quantity*sol.UnitCostAmount as Amount,\n        sol.Quantity,\n        so.PONumber,\n        so.PlacedAt as PlacedDate,\n        so.PlacedAt as CreatedDate,\n        so.ContractualShipAt as ContractualShipDate,\n        so.PlannedShipAt as PlannedShipDate,\n        so.ShippedAt as ActualShipDate,\n        case\n            when so.Status = 'open' then 'New'\n            when so.Status = 'closed' then 'Complete'\n            else null\n        end as HeaderCurrentStatus,\n        case\n            when so.Status = 'open' then 'Not Shipped'\n            when so.Status = 'closed' then 'Shipped'\n            else null\n        end as HeaderShippingStatus,\n        case\n            when so.Status = 'open' then 'New'\n            when so.Status = 'closed' then 'Complete'\n            else null\n        end as LineStatus,\n        convert(decimal(19,4),\n            (cast(sol.Quantity as decimal(19,4)) / \n            nullif(sum(coalesce(sol.Quantity, 0)) over (partition by sol.SalesOrderId), 0)) \n            * so.FreightOutCOGSAmount\n        ) as FreightOutCOGS,\n        sol.UnitItemCOGSAmount*sol.Quantity as ItemCOGS,\n        case\n            when tphf.HandlingFeeType = 'Order' \n                then tphf.HandlingFee\n            when tphf.HandlingFeeType = 'Unit' \n                then tphf.HandlingFee*sol.Quantity\n            else null\n        end as HandlingFee,\n        convert(decimal(19,4),\n            (cast(sol.Quantity as decimal(19,4)) / \n            nullif(sum(coalesce(sol.Quantity, 0)) over (partition by sol.SalesOrderId), 0)) \n            * so.DiscountAmount\n        ) as DiscountAmount,\n        null as RecordUpdatedAt,\n        null as season\n    from sales_order_line sol\n    left join sales_order so\n    on sol.SalesOrderId = so.SalesOrderId\n    left join trading_partner tp\n    on so.TradingPartnerId = tp.TradingPartnerId\n    left join trading_partner_handling_fee tphf\n    on so.TradingPartnerId = tphf.TradingPartnerId\n        and so.PlacedAt >= tphf.StartDate\n        and (so.PlacedAt <= tphf.EndDate or tphf.EndDate is null)\n    left join order_protection_mapping opm\n    on cast(sol.SourceId as nvarchar(200)) = cast(opm.Number as nvarchar(200))\n    left join order_protection_item opi\n    on opm.BrandId = opi.BrandId\n    left join \"KNSDataWarehouse\".\"Deposco\".\"DimItem\" di \n    on sol.ItemId = di.ItemId\n    left join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_products__Brand\" b\n    on di.BrandId = b.BrandId\n    where tp.Name not in (\n        'Marketing',\n        '- No Customer/Project -'\n    )\n),\n\ndepsco_filters as (\n    select\n        j.*\n    from joined j\n    where (j.PONumber is null \n            or j.PONumber not like 'FBA%')\n        and not (j.HeaderShippingStatus = 'Shipped' \n            and j.ItemId = 153085\n            and j.LineStatus != 'Complete')\n),\n\nfinal as (\n    select\n        Number,\n        ItemId,\n        TradingPartnerId,\n        Brand,\n        LastUpdatedAt,\n        Amount,\n        Quantity,\n        PONumber,\n        PlacedDate,\n        CreatedDate,\n        ContractualShipDate,\n        PlannedShipDate,\n        ActualShipDate,\n        HeaderCurrentStatus,\n        HeaderShippingStatus,\n        LineStatus,\n        FreightOutCOGS,\n        ItemCOGS,\n        coalesce(HandlingFee, 0) as HandlingFee,\n        DiscountAmount,\n        RecordUpdatedAt,\n        Season\n    from depsco_filters\n)\n\nselect * from final", "relation_name": "\"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__FactSalesLine_MDM\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.597667Z", "completed_at": "2025-09-07T10:28:16.613292Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.613292Z", "completed_at": "2025-09-07T10:28:16.613292Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625476837158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.int_sales__FreightContainerLine", "compiled": true, "compiled_code": "with\n\nshipments as (\n    select\n        si.Id as FreightContainerLineId,\n        t.CustBodyKnsPo as PONumber,\n        s.ActualShippingDate as DepartureAt,\n        cast(t.CustBodyKnsActualXFact as date) as ActualXFAt,\n        s.ActualDeliveryDate as ActualInDCAt,\n        coalesce(s.ExpectedDeliveryDate, t.DueDate) as ExpectedInDcAt,\n        si.QuantityExpected as ExpectedQuantity,\n        --si.QuantityReceived as ReceivedQuantity,\n        i.ExternalId as Item,\n        s.VesselNumber as Container,\n        si.ShipmentItemTransactionId as TransactionLineId\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__InboundShipment\" s \n    left join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__InboundShipmentItem\" si \n        on s.Id = si.InboundShipmentId\n    left join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__TransactionLine\" tl\n        on si.ShipmentItemTransactionId = tl.UniqueKey\n    left join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Transaction\" t\n        on tl.[Transaction] = t.Id\n    left join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Item\" i\n        on tl.Item = i.Id\n),\n\nreceived as (\n    select \n        s.FreightContainerLineId,\n        sum(ol.ReceivedPackQuantity*p.Quantity) as ReceivedQuantity\n    from shipments s\n    left join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderLine\" ol \n        on s.FreightContainerLineId = ol.CustomerLineNumber\n    left join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__OrderHeader\" oh \n        on ol.OrderHeaderId = oh.OrderHeaderId\n    left join \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__Pack\" p \n        on ol.PackId = p.PackId\n    where oh.ShipVendor = 'InboundShipment'\n        and oh.CurrentStatus <> 'Voided'\n    group by s.FreightContainerLineId\n),\n\nfinal as (\n    select \n        s.FreightContainerLineId,\n        s.Container,\n        s.PONumber,\n        s.TransactionLineId,\n        s.ActualXFAt,\n        s.DepartureAt,\n        s.ExpectedInDCAt,\n        s.ActualInDCAt,\n        s.ExpectedQuantity,\n        s.ExpectedQuantity - coalesce(r.ReceivedQuantity, 0) as RemainingQuantity,\n        coalesce(r.ReceivedQuantity, 0) as ReceivedQuantity,\n        i.ItemId\n    from shipments s\n    left join \"KNSDataWarehouse\".\"Deposco\".\"DimItem\" i\n        on s.Item = i.Number\n    left join received r\n        on s.FreightContainerLineId = r.FreightContainerLineId\n)\n\nselect * from final", "relation_name": "\"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__FreightContainerLine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.613292Z", "completed_at": "2025-09-07T10:28:16.613292Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.613292Z", "completed_at": "2025-09-07T10:28:16.613292Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.int_sales__PurchaseOrderLine", "compiled": true, "compiled_code": "with \n\nnetsuite as (\n    \tselect\n\t\ttl.UniqueKey as TransactionLineId,\n\t\tt.Id as TransactionId,\n\t\tt.CustbodyKnsPo as PONumber,\n\t\ttl.Quantity as Quantity,\n\t\ti.ExternalId as Item,\n        cast(tl.Rate as decimal(19,2)) as Rate,\n\t\tt.CustbodyKnsSeasonPo as Season,\n        cast(t.CustbodyKnsXFactoryDate as date) as RequestedXFAt,\n\t\tcast(t.CustbodyKnsConfirmXFact as date) as ConfirmedXFAt,\n\t\tcast(t.CustbodyKnsActualXFact as date) as ActualXFAt,\n\t\tt.DueDate as RequestedInDCAt,\n\t\tcast(t.CustbodyKnsEstInDCDate as date) as EstimatedInDCAt,\n        tl.QuantityOnShipments as QuantityOnShipments,\n        case\n            when tl.Quantity - tl.QuantityShipRecv = 0 \n                or tl.IsClosed = 'T'\n                or ts.Name = 'Closed'\n\t\t\t\tor ts.Name = 'Fully Billed'\n                then 0\n            else 1\n        end as IsOpen,\n\t\tt.TranDate as TransactionDate\n\tfrom \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Transaction\" t\n\tjoin \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__TransactionLine\" tl \n\t\ton tl.[Transaction] = t.Id\n\tjoin \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__TransactionStatus\" ts \n\t\ton ts.Id = t.Status and ts.TranType = t.Type\n\tjoin \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_netsuite__Item\" i \n\t\ton i.Id = tl.Item\n\twhere t.Type='PurchOrd'\n\tand t.DueDate is not null\n\tand t.DueDate >= datefromparts(year(getdate()) - 1, 1, 1)\n),\n\npo_lines as (\n\tselect\n\t\tn.PONumber,\n        n.RequestedXFAt,\n\t\tn.ConfirmedXFAt,\n\t\tn.EstimatedInDCAt,\n\t\tn.RequestedInDCAt,\n\t\tn.ActualXFAt,\n\t\tn.Quantity,\n        n.QuantityOnShipments,\n\t\tn.Quantity - n.QuantityOnShipments as RemainingQuantityNotOnShipments,\n\t\ti.ItemId as ItemId,\n\t\tn.TransactionId,\n\t\tn.TransactionLineId,\n        n.Rate,\n        n.Season,\n        IsOpen,\n\t\tn.TransactionDate\n\tfrom netsuite n\n\tjoin \"KNSDataWarehouse\".\"Deposco\".\"DimItem\" i \n\t\ton i.Number = n.Item\n)\n\nselect * from po_lines", "relation_name": "\"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__PurchaseOrderLine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.628919Z", "completed_at": "2025-09-07T10:28:16.628919Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.628919Z", "completed_at": "2025-09-07T10:28:16.628919Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.not_null_DimItem_Number.00943a1f3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Number\nfrom \"KNSDataWarehouse\".\"Deposco\".\"DimItem\"\nwhere Number is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.628919Z", "completed_at": "2025-09-07T10:28:16.644550Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.644550Z", "completed_at": "2025-09-07T10:28:16.644550Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015631675720214844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.unique_DimItem_Number.a6723ba397", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    Number as unique_field,\n    count(*) as n_records\n\nfrom \"KNSDataWarehouse\".\"Deposco\".\"DimItem\"\nwhere Number is not null\ngroup by Number\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.644550Z", "completed_at": "2025-09-07T10:28:16.660171Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.660171Z", "completed_at": "2025-09-07T10:28:16.660171Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015620708465576172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.accepted_values_FactMarketingAd_Objective__Top_Funnel_Awareness__Mid_Funnel__Bottom_Funnel_Conversions__Retargeting__Prospecting__Retention__NBSearch__BrandSearch__PMax__BrandShopping__NBShopping__Null.96cf12787a", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        Objective as value_field,\n        count(*) as n_records\n\n    from \"KNSDataWarehouse\".\"KNS\".\"FactMarketingAd\"\n    group by Objective\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Top Funnel / Awareness','Mid Funnel','Bottom Funnel / Conversions','Retargeting','Prospecting','Retention','NBSearch','BrandSearch','PMax','BrandShopping','NBShopping','Null'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.660171Z", "completed_at": "2025-09-07T10:28:16.660171Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.660171Z", "completed_at": "2025-09-07T10:28:16.660171Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.not_null_FactMarketingAd_TradingPartnerId.54a6c4f487", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect TradingPartnerId\nfrom \"KNSDataWarehouse\".\"KNS\".\"FactMarketingAd\"\nwhere TradingPartnerId is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.675795Z", "completed_at": "2025-09-07T10:28:16.675795Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.675795Z", "completed_at": "2025-09-07T10:28:16.675795Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.CompletePLD", "compiled": true, "compiled_code": "\n  \n\n\nwith\n\nitem as (\n    select\n        ItemId,\n        Number \n    from \"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__DimItemPrep\"\n),\n\ntrading_partner as (\n    select\n        TradingPartnerId,\n        Name\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__TradingPartner\"\n),\n\nprice_list as (\n    select\n        PriceListId,\n        TradingPartnerId\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__PriceList\"\n),\n\nprice_list_detail as (\n    select\n        PriceListDetailId,\n        PriceListId,\n        ItemId,\n        SalesPrice,\n        SalesEffectiveStart,\n        SalesEffectiveEnd\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__PriceListDetail\"\n),\n\npld_grouped as (\n    select\n        i.ItemId,\n        i.Number as SKU,\n        pl.TradingPartnerId,\n        pld.SalesPrice as CurrentPLDPrice,\n        pld.SalesEffectiveStart as PriceStartAt,\n        pld.PriceListDetailId\n    from item i\n    left join price_list_detail pld\n        on i.ItemId = pld.ItemId\n    left join price_list pl \n        on pld.PriceListId = pl.PriceListId\n    left join trading_partner tp \n        on pl.TradingPartnerId = tp.TradingPartnerId\n    where pld.SalesEffectiveEnd is null\n),\n\nsales as (\n    select\n        Number,\n        ItemId,\n        TradingPartnerId,\n        PlacedDate,\n        Amount,\n        Quantity,\n        row_number() over (\n            partition by ItemId, TradingPartnerId \n            order by PlacedDate desc\n        ) as rn\n    from \"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__FactSalesLine_MDM\"\n    where Quantity is not null \n        and Quantity > 0\n),\n\nlatest_sales as (\n    select\n        Number,\n        ItemId,\n        TradingPartnerId,\n        PlacedDate,\n        Amount,\n        Quantity\n    from sales\n    where rn = 1\n),\n\npld_sales_joined as (\n    select \n        s.Number as FactSalesLineNumber,\n        pld.ItemId,\n        pld.SKU,\n        pld.TradingPartnerId,\n        pld.CurrentPLDPrice,\n        pld.PriceStartAt,\n        pld.PriceListDetailId,\n        s.PlacedDate,\n        (s.Amount / nullif(s.Quantity, 0)) - pld.CurrentPLDPrice as PriceDifference,\n        (s.Amount / nullif(s.Quantity, 0)) as SOPrice\n    from pld_grouped pld\n    left join latest_sales s \n        on pld.ItemId = s.ItemId\n        and pld.TradingPartnerId = s.TradingPartnerId\n),\n\nfinal as (\n    select\n        pld.FactSalesLineNumber,\n        pld.ItemId,\n        pld.SKU,\n        pld.TradingPartnerId,\n        pld.CurrentPLDPrice,\n        pld.SOPrice,\n        pld.PriceDifference,\n        pld.PriceStartAt,\n        pld.PlacedDate as SOPlacedAt,\n        case\n            when pld.PlacedDate < pld.PriceStartAt or pld.FactSalesLineNumber is null\n                then 'No'\n            else 'Yes'\n        end as SOIsCurrent,\n        pld.PriceListDetailId\n    from pld_sales_joined pld\n)\n\nselect * from final", "relation_name": "\"KNSDataWarehouse\".\"KNS\".\"CompletePLD\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.675795Z", "completed_at": "2025-09-07T10:28:16.691420Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.691420Z", "completed_at": "2025-09-07T10:28:16.691420Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.DimPLD", "compiled": true, "compiled_code": "\n  \n\n\nwith\n\ndate_variable as (\n    select \n        dateadd(year, -1, cast(getdate() as date)) as one_year_ago,\n        dateadd(month, -2, cast(getdate() as date)) as two_months_ago\n),\n\nitem as (\n    select\n        ItemId,\n        Number \n    from \"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__DimItemPrep\"\n),\n\ntrading_partner as (\n    select\n        TradingPartnerId,\n        Name\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_orders__TradingPartner\"\n),\n\nprice_list as (\n    select\n        PriceListId,\n        TradingPartnerId\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__PriceList\"\n),\n\nprice_list_detail as (\n    select\n        PriceListId,\n        ItemId,\n        SalesPrice,\n        SalesEffectiveStart,\n        SalesEffectiveEnd\n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_deposco__PriceListDetail\"\n),\n\npld_combined as (\n    select\n        pld.ItemId,\n        pld.SalesPrice,\n        pld.SalesEffectiveStart,\n        pld.SalesEffectiveEnd,\n        pl.TradingPartnerId\n    from price_list_detail pld\n    join price_list pl on pld.PriceListId = pl.PriceListId\n),\n\nsales as (\n    select\n        Number,\n        PONumber,\n        ItemId,\n        TradingPartnerId,\n        cast(Amount as decimal(18,2)) / nullif(Quantity,0) as SalesPrice,\n        Quantity,\n        PlacedDate\n    from \"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__FactSalesLine_MDM\"\n),\n\nfinal as (\n    select\n        s.Number as FactSalesLineNumber,\n        s.PONumber,\n        i.Number as SKU,\n        tp.Name as TradingPartnerName,\n        pld.SalesPrice as ActivePLD,\n        s.SalesPrice as SalesPrice,\n        s.Quantity,\n        s.PlacedDate as PlacedAt,\n        pld.SalesEffectiveStart as PLDEffectiveStart,\n        pld.SalesEffectiveEnd as PLDEffectiveEnd\n    from sales s \n    join item i on s.ItemId = i.ItemId\n    join pld_combined pld on i.ItemId = pld.ItemId\n        and s.TradingPartnerId = pld.TradingPartnerId\n        and pld.SalesEffectiveStart <= s.PlacedDate\n        and iif(pld.SalesEffectiveEnd is not null, \n                pld.SalesEffectiveEnd, \n                '3025-01-01') \n            >= s.PlacedDate\n    join trading_partner tp on s.TradingPartnerId = tp.TradingPartnerId\n\n)\n\nselect * from final", "relation_name": "\"KNSDataWarehouse\".\"Deposco\".\"DimPLD\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.691420Z", "completed_at": "2025-09-07T10:28:16.707042Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.707042Z", "completed_at": "2025-09-07T10:28:16.707042Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015622377395629883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.FactSalesLine", "compiled": true, "compiled_code": "\n  \n\n\nwith\n\nreturns_accruals as (\n  select * from \"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__FactSalesLine_ReturnsAccruals\"\n),\n\nmdm as (\n    select * from \"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__FactSalesLine_MDM\" \n),\n\nunioned as (\n    select \n        cast(Number as nvarchar(200)) as Number,\n        cast(ItemId as int) as ItemId,\n        cast(TradingPartnerId as int) as TradingPartnerId,\n        cast(Brand as nvarchar(200)) as Brand,\n        cast(LastUpdatedAt as datetime) as LastUpdatedAt,\n        cast(Amount as decimal(19, 4)) as Amount,\n        cast(Quantity as int) as Quantity,\n        cast(PONumber as nvarchar(64)) as PONumber,\n        cast(PlacedDate as datetime) as PlacedDate,\n        cast(CreatedDate as datetime) as CreatedDate,\n        cast(ContractualShipDate as datetime) as ContractualShipDate,\n        cast(PlannedShipDate as datetime) as PlannedShipDate,\n        cast(ActualShipDate as datetime) as ActualShipDate,\n        cast(HeaderCurrentStatus as nvarchar(48)) as HeaderCurrentStatus,\n        cast(HeaderShippingStatus as nvarchar(48)) as HeaderShippingStatus,\n        cast(LineStatus as nvarchar(48)) as LineStatus,\n        cast(FreightOutCOGS as decimal(19, 4)) as FreightOutCOGS,\n        cast(ItemCOGS as decimal(19, 4)) as ItemCOGS,\n        cast(HandlingFee as decimal(19, 4)) as HandlingFee,\n        cast(DiscountAmount as decimal(19, 4)) as DiscountAmount,\n        cast(RecordUpdatedAt as datetime) as RecordUpdatedAt,\n        cast(Season as nvarchar(32)) as Season \n    from mdm\n    union all\n    select \n        cast(Number as nvarchar(200)) as Number,\n        cast(ItemId as int) as ItemId,\n        cast(TradingPartnerId as int) as TradingPartnerId,\n        cast(Brand as nvarchar(200)) as Brand,\n        cast(LastUpdatedAt as datetime) as LastUpdatedAt,\n        cast(Amount as decimal(19, 4)) as Amount,\n        cast(Quantity as int) as Quantity,\n        cast(PONumber as nvarchar(64)) as PONumber,\n        cast(PlacedDate as datetime) as PlacedDate,\n        cast(CreatedDate as datetime) as CreatedDate,\n        cast(ContractualShipDate as datetime) as ContractualShipDate,\n        cast(PlannedShipDate as datetime) as PlannedShipDate,\n        cast(ActualShipDate as datetime) as ActualShipDate,\n        cast(HeaderCurrentStatus as nvarchar(48)) as HeaderCurrentStatus,\n        cast(HeaderShippingStatus as nvarchar(48)) as HeaderShippingStatus,\n        cast(LineStatus as nvarchar(48)) as LineStatus,\n        cast(FreightOutCOGS as decimal(19, 4)) as FreightOutCOGS,\n        cast(ItemCOGS as decimal(19, 4)) as ItemCOGS,\n        cast(HandlingFee as decimal(19, 4)) as HandlingFee,\n        cast(DiscountAmount as decimal(19, 4)) as DiscountAmount,\n        cast(RecordUpdatedAt as datetime) as RecordUpdatedAt,\n        cast(Season as nvarchar(32)) as Season \n    from returns_accruals\n),\n\nfinal as (\n    select\n        *\n    from unioned\n    where PlacedDate >= datefromparts(year(getdate()) - 3, 1, 1)\n)\n\nselect * from final", "relation_name": "\"KNSDataWarehouse\".\"KNS\".\"FactSalesLine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.707042Z", "completed_at": "2025-09-07T10:28:16.707042Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.707042Z", "completed_at": "2025-09-07T10:28:16.707042Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.FactPOShippingLine", "compiled": true, "compiled_code": "\n  \n\n\nwith \n\npo_lines as (\n    select\n        PONumber,\n        ItemId,\n        TransactionId,\n        TransactionLineId,\n        RequestedXFAt,\n        ConfirmedXFAt,\n        ActualXFAt,\n        RequestedInDCAt,\n        EstimatedInDCAt,\n        Quantity as POQuantity,\n        QuantityOnShipments as POQuantityOnShipments,\n        RemainingQuantityNotOnShipments,\n        Rate,\n        Season,\n        IsOpen,\n        TransactionDate\n    from \"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__PurchaseOrderLine\"\n),\n\nfreight_container_lines as (\n    select\n        TransactionLineId,\n        FreightContainerLineId,\n        Container,\n        DepartureAt,\n        ExpectedInDCAt,\n        ActualInDCAt,\n        ExpectedQuantity,\n        ReceivedQuantity,\n        RemainingQuantity\n    from \"KNSDevDbt\".\"dbt_prod_intermediate\".\"int_sales__FreightContainerLine\"\n),\n\njoined as (\n    select \n        concat(p.TransactionLineId, '-', f.FreightContainerLineId) as POShippingLineId,\n        p.PONumber,\n        p.ItemId,\n        p.TransactionId,\n        p.TransactionLineId,\n        p.RequestedXFAt,\n        p.ConfirmedXFAt,\n        p.ActualXFAt,\n        p.RequestedInDCAt,\n        p.POQuantity,\n        p.POQuantityOnShipments,\n        f.FreightContainerLineId,\n        f.Container,\n        f.DepartureAt,\n        coalesce(f.ExpectedInDCAt, p.EstimatedInDCAt) as ExpectedInDCAt,\n        f.ActualInDCAt,\n        f.ExpectedQuantity,\n        f.ReceivedQuantity,\n        coalesce(f.RemainingQuantity, p.POQuantity) as RemainingQuantity,\n        case \n            when f.ActualInDCAt is not null or f.ReceivedQuantity > 0\n                then cast(1 as bit)\n            else cast(0 as bit)\n        end as IsArrived,\n        p.Rate,\n        p.Season,\n        p.IsOpen\n    from po_lines p\n    left join freight_container_lines f\n        on p.TransactionLineId = f.TransactionLineId\n    where p.TransactionDate >= datefromparts(year(getdate()) - 1, 1, 1)\n),\n\nunassigned as (\n    select\n        concat(p.TransactionLineId, '-', cast(null as varchar(50))) as POShippingLineId,\n        p.PONumber,\n        p.ItemId,\n        p.TransactionId,\n        p.TransactionLineId,\n        p.RequestedXFAt,\n        p.ConfirmedXFAt,\n        p.ActualXFAt,\n        p.RequestedInDCAt,\n        p.POQuantity,\n        p.POQuantityOnShipments,\n        cast(null as bigint) as FreightContainerLineId,\n        cast(null as varchar(50)) as Container,\n        cast(null as datetime) as DepartureAt,\n        p.EstimatedInDCAt as ExpectedInDCAt,\n        cast(null as datetime) as ActualInDCAt,\n        cast(null as decimal(18,4)) as ExpectedQuantity,\n        cast(0 as decimal(18,4)) as ReceivedQuantity,\n        cast(p.RemainingQuantityNotOnShipments as decimal(18,4)) as RemainingQuantity,\n        cast(0 as bit) as IsArrived,\n        p.Rate,\n        p.Season,\n        p.IsOpen\n    from po_lines p\n    where p.TransactionDate >= datefromparts(year(getdate()) - 1, 1, 1)\n      and p.RemainingQuantityNotOnShipments > 0\n      and exists (\n            select 1\n            from freight_container_lines f\n            where f.TransactionLineId = p.TransactionLineId\n      )\n),\n\nunioned as (\n    select * from joined\n    union all\n    select * from unassigned\n),\n\nfinal as (\n    select\n        POShippingLineId,\n        PONumber,\n        ItemId,\n        TransactionId,\n        TransactionLineId,\n        RequestedXFAt,\n        ConfirmedXFAt,\n        ActualXFAt,\n        RequestedInDCAt,\n        coalesce(ExpectedQuantity, POQuantity-ISNULL(POQuantityOnShipments, 0)) as Quantity,\n        FreightContainerLineId,\n        Container,\n        DepartureAt,\n        ExpectedInDCAt,\n        ActualInDCAt,\n        ReceivedQuantity,\n        RemainingQuantity,\n        case \n            when datediff(day, getdate(), coalesce(ExpectedInDCAt, RequestedInDCAt)) >= 61 \n                then '61+ Days'\n            when datediff(day, getdate(), coalesce(ExpectedInDCAt, RequestedInDCAt)) >= 31 \n                then '31-60 Days'\n            when datediff(day, getdate(), coalesce(ExpectedInDCAt, RequestedInDCAt)) > 0\n                then '<30 Days'\n            when ActualInDCAt is not null and ReceivedQuantity <> ExpectedQuantity\n                then 'At Warehouse Not Received'\n            when RemainingQuantity = 0\n                then 'Received'\n            else 'Past Receive Date'\n        end as ReceiveByDateGrouping,\n        IsArrived,\n        Rate,\n        Season,\n        IsOpen\n    from unioned\n)\n\nselect * from final", "relation_name": "\"KNSDataWarehouse\".\"KNS\".\"FactPOShippingLine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.722668Z", "completed_at": "2025-09-07T10:28:16.722668Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.722668Z", "completed_at": "2025-09-07T10:28:16.722668Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.unique_CompletePLD_FactSalesLineNumber.238ebdb35a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    FactSalesLineNumber as unique_field,\n    count(*) as n_records\n\nfrom \"KNSDataWarehouse\".\"KNS\".\"CompletePLD\"\nwhere FactSalesLineNumber is not null\ngroup by FactSalesLineNumber\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.722668Z", "completed_at": "2025-09-07T10:28:16.738294Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.738294Z", "completed_at": "2025-09-07T10:28:16.738294Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01562666893005371, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.not_null_DimPLD_FactSalesLineNumber.07f42595e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect FactSalesLineNumber\nfrom \"KNSDataWarehouse\".\"Deposco\".\"DimPLD\"\nwhere FactSalesLineNumber is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.738294Z", "completed_at": "2025-09-07T10:28:16.738294Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.753920Z", "completed_at": "2025-09-07T10:28:16.753920Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015625953674316406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.unique_DimPLD_FactSalesLineNumber.7db458b102", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    FactSalesLineNumber as unique_field,\n    count(*) as n_records\n\nfrom \"KNSDataWarehouse\".\"Deposco\".\"DimPLD\"\nwhere FactSalesLineNumber is not null\ngroup by FactSalesLineNumber\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.753920Z", "completed_at": "2025-09-07T10:28:16.769549Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.769549Z", "completed_at": "2025-09-07T10:28:16.769549Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015629291534423828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.not_null_FactSalesLine_Number.2ff9978fed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Number\nfrom \"KNSDataWarehouse\".\"KNS\".\"FactSalesLine\"\nwhere Number is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.769549Z", "completed_at": "2025-09-07T10:28:16.878923Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.878923Z", "completed_at": "2025-09-07T10:28:16.878923Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10937356948852539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.kns_dbt.unique_FactSalesLine_Number.eeb1dbfa46", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    Number as unique_field,\n    count(*) as n_records\n\nfrom \"KNSDataWarehouse\".\"KNS\".\"FactSalesLine\"\nwhere Number is not null\ngroup by Number\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T10:28:16.878923Z", "completed_at": "2025-09-07T10:28:16.878923Z"}, {"name": "execute", "started_at": "2025-09-07T10:28:16.894540Z", "completed_at": "2025-09-07T10:28:16.894540Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015616893768310547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.kns_dbt.POAggregate", "compiled": true, "compiled_code": "\n  \n\n\nwith\n\ninventory_valuation as (\n    select \n        Date,\n        ItemId,\n        Quantity,\n        Valuation \n    from \"KNSDevDbt\".\"dbt_prod_staging\".\"stg_kns__InventoryValuation\"\n),\n\nlatest_inventory_date as (\n    select\n        ItemId,\n        max(Date) as LatestInventoryDate\n    from inventory_valuation\n    group by ItemId\n),\n\nlatest_inventory as (\n    select\n        iv.ItemId,\n        iv.Date as LatestInventoryDate,\n        iv.Quantity as LatestInventoryQuantity\n    from inventory_valuation iv\n    join latest_inventory_date lid\n        on iv.ItemId = lid.ItemId\n       and iv.Date = lid.LatestInventoryDate\n),\n\ninventory_12mo_prior_date as (\n    select\n        iv.ItemId,\n        max(iv.Date) as MaxInventoryDate12MoPrior\n    from inventory_valuation iv\n    join latest_inventory li on iv.ItemId = li.ItemId\n    where iv.Date <= dateadd(month, -12, li.LatestInventoryDate)\n    group by iv.ItemId\n),\n\ninventory_12mo_prior as (\n    select\n        iv.ItemId,\n        iv.Date as MaxInventoryDate12MoPrior,\n        iv.Quantity as Quantity12MoPrior\n    from inventory_valuation iv\n    join inventory_12mo_prior_date prior\n        on iv.ItemId = prior.ItemId\n       and iv.Date = prior.MaxInventoryDate12MoPrior\n),\n\nall_inventory_dates as (\n    select\n        ItemId,\n        LatestInventoryDate as InventoryDate,\n        'Latest' as DateType\n    from latest_inventory\n\n    union all\n\n    select\n        ItemId,\n        MaxInventoryDate12MoPrior as InventoryDate,\n        '12MoPrior' as DateType\n    from inventory_12mo_prior\n),\n\npo_lines as (\n    select \n        ItemId,\n        ActualInDCAt as ReceiptDate,\n        ReceivedQuantity as Quantity \n    from \"KNSDataWarehouse\".\"KNS\".\"FactPOShippingLine\"\n),\n\ninventory_receipts as (\n    select\n        p.ItemId,\n        a.DateType,\n        case\n            when datediff(month, p.ReceiptDate, a.InventoryDate) between 0 and 6 then '0-6 months'\n            when datediff(month, p.ReceiptDate, a.InventoryDate) between 7 and 12 then '7-12 months'\n            when datediff(month, p.ReceiptDate, a.InventoryDate) between 13 and 24 then '13-24 months'\n            when datediff(month, p.ReceiptDate, a.InventoryDate) between 25 and 36 then '25-36 months'\n            when datediff(month, p.ReceiptDate, a.InventoryDate) > 36 then '36+ months'\n            else 'Unknown'\n        end as AgeBucket,\n        sum(p.Quantity) as ReceiptsQuantity\n    from po_lines p\n    join all_inventory_dates a on p.ItemId = a.ItemId\n    group by\n        p.ItemId,\n        a.DateType,\n        case\n            when datediff(month, p.ReceiptDate, a.InventoryDate) between 0 and 6 then '0-6 months'\n            when datediff(month, p.ReceiptDate, a.InventoryDate) between 7 and 12 then '7-12 months'\n            when datediff(month, p.ReceiptDate, a.InventoryDate) between 13 and 24 then '13-24 months'\n            when datediff(month, p.ReceiptDate, a.InventoryDate) between 25 and 36 then '25-36 months'\n            when datediff(month, p.ReceiptDate, a.InventoryDate) > 36 then '36+ months'\n            else 'Unknown'\n        end\n),\n\npivoted_receipts as (\n    select\n        ItemId,\n        DateType,\n        sum(case when AgeBucket = '0-6 months' then ReceiptsQuantity else 0 end) as '0-6 months',\n        sum(case when AgeBucket = '7-12 months' then ReceiptsQuantity else 0 end) as '7-12 months',\n        sum(case when AgeBucket = '13-24 months' then ReceiptsQuantity else 0 end) as '13-24 months',\n        sum(case when AgeBucket = '25-36 months' then ReceiptsQuantity else 0 end) as '25-36 months',\n        sum(case when AgeBucket = '36+ months' then ReceiptsQuantity else 0 end) as '36+ months'\n    from inventory_receipts\n    group by ItemId, DateType\n),\n\nfinal_with_dates as(\n    select\n        pr.*,\n        aid.InventoryDate\n    from pivoted_receipts pr\n    join all_inventory_dates aid\n        on pr.ItemId = aid.ItemId\n       and pr.DateType = aid.DateType\n),\n\nfinal as (\n    select\n        f.ItemId,\n        f.DateType,\n        f.[0-6 months],\n        f.[7-12 months],\n        f.[13-24 months],\n        f.[25-36 months],\n        f.[36+ months],\n        iv.Valuation,\n        iv.Quantity,\n        case\n            when iv.Quantity = 0 then 0\n            else cast(iv.Valuation / cast(iv.Quantity as decimal(18, 2)) as decimal(18, 2))\n        end as [Unit Value]\n    from final_with_dates f\n    join inventory_valuation iv\n        on iv.ItemId = f.ItemId\n       and iv.Date = f.InventoryDate\n)\n\nselect * from final", "relation_name": "\"KNSDataWarehouse\".\"KNS\".\"POAggregate\""}], "elapsed_time": 2.5468740463256836, "args": {"print": true, "log_path": "C:\\actions-runner\\_work\\DataTransform\\DataTransform\\Datawarehouse\\logs", "static_parser": true, "indirect_selection": "eager", "favor_state": false, "printer_width": 80, "vars": {}, "send_anonymous_usage_stats": true, "strict_mode": false, "version_check": true, "select": [], "compile": true, "macro_debugging": false, "log_file_max_bytes": 10485760, "quiet": false, "require_resource_names_without_spaces": false, "empty_catalog": false, "cache_selected_only": false, "enable_legacy_logger": false, "static": false, "log_level_file": "debug", "log_format": "default", "warn_error_options": {"include": [], "exclude": []}, "use_colors": true, "profiles_dir": "C:/dbt", "log_level": "info", "populate_cache": true, "invocation_command": "dbt docs generate --profiles-dir C:/dbt", "exclude": [], "defer": false, "show_resource_report": false, "introspect": true, "require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse": true, "which": "generate", "use_colors_file": true, "source_freshness_run_project_hooks": false, "log_format_file": "debug", "partial_parse_file_diff": true, "project_dir": "C:\\actions-runner\\_work\\DataTransform\\DataTransform\\Datawarehouse", "write_json": true}}